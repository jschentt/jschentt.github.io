<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="It&#39;s better to burn out than to fade away.">
<meta property="og:type" content="website">
<meta property="og:title" content="Bruce Chen&#39;s Blog">
<meta property="og:url" content="http://example.com/page/4/index.html">
<meta property="og:site_name" content="Bruce Chen&#39;s Blog">
<meta property="og:description" content="It&#39;s better to burn out than to fade away.">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Bruce Chen">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Bruce Chen's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband">
    <a target="_blank" rel="noopener" href="https://github.com/jschentt" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    </div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Bruce Chen's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">quick notes</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">3</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">7</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">83</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/16/react-native%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/portal.jpg">
      <meta itemprop="name" content="Bruce Chen">
      <meta itemprop="description" content="It's better to burn out than to fade away.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Chen's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/16/react-native%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93/" class="post-title-link" itemprop="url">react-native开发总结</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-12-16 14:44:45 / 修改时间：14:51:20" itemprop="dateCreated datePublished" datetime="2022-12-16T14:44:45+08:00">2022-12-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AFUI%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">前端UI框架</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><ul>
<li><a target="_blank" rel="noopener" href="https://gitee.com/liu12fei08fei/rn_test">项目总结代码地址</a></li>
<li>记录开发 react-native 中各种有意思的事情</li>
<li>最新探索，用来进行各种尝试的空间</li>
<li>完成的探索，记录所有已经完成的模块、功能和效果</li>
<li>中转站，暂时无用</li>
</ul>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="全局脚手架"><a href="#全局脚手架" class="headerlink" title="全局脚手架"></a>全局脚手架</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g react-native-cli</span><br></pre></td></tr></table></figure>

<h3 id="安装基础项目"><a href="#安装基础项目" class="headerlink" title="安装基础项目"></a>安装基础项目</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native init &lt;项目名称&gt;</span><br></pre></td></tr></table></figure>

<h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><h3 id="优化后的运行"><a href="#优化后的运行" class="headerlink" title="优化后的运行"></a>优化后的运行</h3><ul>
<li>ios：npm run ios</li>
<li>android：npm run android</li>
<li>ios and android：npm run s</li>
</ul>
<h3 id="原始启动"><a href="#原始启动" class="headerlink" title="原始启动"></a>原始启动</h3><ul>
<li>ios：react-native run-ios</li>
<li>android：react-native run-android</li>
</ul>
<h2 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/react-navigation/react-navigation">navigation 集成</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/oblador/react-native-vector-icons">集成 icons</a> -<a target="_blank" rel="noopener" href="https://github.com/crazycodeboy/react-native-easy-toast"> react-native-easy-toast</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/jondot/awesome-react-native">rn 资源列表</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/dancormier/react-native-swipeout">横向滑动展示按钮效果</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/valerybugakov/react-native-custom-actionsheet">自定义行动列表</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/danchokobo/react-native-code-verification">密码输入效果</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/skv-headless/react-native-scrollable-tab-view">选项卡导航之间滑动</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/cssivision/react-native-qrcode">二维码生成</a></li>
</ul>
<h2 id="未探索的资源"><a href="#未探索的资源" class="headerlink" title="未探索的资源"></a>未探索的资源</h2><blockquote>
<p>365 个库中寻找 77 个</p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/beefe/react-native-picker">select 选择控件</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/App2Sales/react-native-switch-selector">开关式选择列表</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/yonahforst/react-native-emoji-picker">表情选择器</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Tinysymphony/react-native-drawer-menu">左右滑动层</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Spikef/react-native-phone-picker">手机号选择控件</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/zecaptus/react-native-md-motion-buttons">登录动画</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/merryjs/photo-viewer">图片查看器</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/SoftZen/react-native-bouncy-drawer">菜单操作动画</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/charlot567/react-native-comparison-slider">滑动操作图片展示样式</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/moschan/react-native-newsticker">操作打字效果</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/prscX/react-native-siri-wave-view">声音可视化</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/mfrachet/rn-placeholder">占位符</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/oblador/react-native-lightbox">图片查看器</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/react-native-community/react-native-blur">模糊背景效果</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/ivpusic/react-native-image-crop-picker">本地图片超级操作</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/meteor-factory/react-native-tinder-swipe-cards">四面八方拖动效果</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/sbycrosz/react-native-credit-card-input">信用卡输入效果</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/jmurzy/react-native-foldview">展开动画效果</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/tomauty/react-native-chart">chart</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/crazycodeboy/react-native-splash-screen">初始化启动页</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/wix/react-native-calendars">日期</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/archriss/react-native-snap-carousel">左右滑动操作卡片效果</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/gitim/react-native-sortable-list">列表拖拽</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/JesperLekland/react-native-svg-charts">chart</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/spikef/react-native-gesture-password">密码锁效果</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/djchie/react-native-star-rating">星级评价</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/jgrancher/react-native-sketch">手动签字</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/24ark/react-native-step-indicator">滑动时间轴效果</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/xcarpentier/react-native-country-picker-modal">国家 26 字母选择</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/cnjon/react-native-pdf-view">PDF 查看</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/i6mi6/react-native-alphabetlistview">26 字母选择</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/naoufal/react-native-activity-view">分享</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/jeanregisser/react-native-popover">对话框</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/taskrabbit/react-native-parsed-text">电话、地址等操作</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/kayla-tech/react-native-privacy-snapshot">后台信息保护</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/anvilabs/react-native-image-carousel">图片查看器</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/chitezh/react-native-swiper-animated">左右滑动动画</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/rauchy/react-native-offline-mode">无网络操作</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/instea/react-native-color-picker">颜色选择器</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/wix/react-native-custom-segmented-control">左右滑动 tab 动效</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/mastermoo/react-native-pulse-loader">加载中效果</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/machadogj/react-native-carousel-control">左右滑动效果，类似酷划锁屏</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/awesomejerry/react-native-qrcode-svg">二维码生成器</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/zachgibson/react-native-parallax-swiper">图片查看器</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/bamlab/react-native-image-header-scroll-view">视差效果</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Tinysymphony/react-native-calendar-select">日期</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/prscX/react-native-shine-button">点击效果</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/geremih/react-native-circular-action-menu">扇形菜单</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/johanneslumpe/react-native-gesture-recognizers/">手势识别</a></li>
</ul>
<h2 id="新增页面需要在三个地方进行操作"><a href="#新增页面需要在三个地方进行操作" class="headerlink" title="新增页面需要在三个地方进行操作"></a>新增页面需要在三个地方进行操作</h2><ol>
<li>data 里面的 complete.js 中添加数据，方便在完成的探索中出现</li>
<li>navigators 中的 AppStackNavigators.js 里面进行引入&#x3D;&gt;注册，使得路由正常</li>
<li>pages 里面添加页面</li>
</ol>
<h2 id="优化-package-json-使开发更加方便"><a href="#优化-package-json-使开发更加方便" class="headerlink" title="优化 package.json 使开发更加方便"></a>优化 package.json 使开发更加方便</h2><ul>
<li>在 scripts 中添加，如下内容：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;ios&quot;:&quot;react-native run-ios&quot;,</span><br><span class="line">&quot;android&quot;:&quot;react-native run-android&quot;,</span><br><span class="line">&quot;s&quot;:&quot;npm run ios &amp;&amp; npm run android&quot;,</span><br></pre></td></tr></table></figure>

<h2 id="flex-布局常用属性"><a href="#flex-布局常用属性" class="headerlink" title="flex 布局常用属性"></a>flex 布局常用属性</h2><ul>
<li>防止在 flex 中出现，固定元素被挤压的问题，使用 flex:1 进行优化</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">display: &#x27;flex&#x27;;</span><br><span class="line">flexDirection: row | row-reverse | column | column-reverse;</span><br><span class="line">flexWrap: nowrap | wrap | wrap-reverse;</span><br><span class="line">flexFlow: &lt;flex-direction&gt; | &lt;flex-wrap&gt;;</span><br><span class="line">justifyContent: flex-start | flex-end | center | space-between | space-around;</span><br><span class="line">alignItems: flex-start | flex-end | center | baseline | stretch;</span><br><span class="line">alignContent: flex-start | flex-end | center | space-between | space-around | stretch;</span><br><span class="line"></span><br><span class="line">order: &lt;integer&gt;;</span><br><span class="line">flexGrow: &lt;number&gt;; /* default 0 */</span><br><span class="line">flexShrink: &lt;number&gt;; /* default 1 */</span><br><span class="line">flexBasis: &lt;length&gt; | auto; /* default auto */</span><br><span class="line">flex: none | [ &lt;&#x27;flex-grow&#x27;&gt; &lt;&#x27;flex-shrink&#x27;&gt;? || &lt;&#x27;flex-basis&#x27;&gt; ]</span><br><span class="line">alignSelf: auto | flex-start | flex-end | center | baseline | stretch;</span><br></pre></td></tr></table></figure>

<h2 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h2><h3 id="图片使用"><a href="#图片使用" class="headerlink" title="图片使用"></a>图片使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Image source=&#123;require(&#x27;./my-icon.png&#x27;)&#125; /&gt;</span><br></pre></td></tr></table></figure>

<h3 id="命名规则"><a href="#命名规则" class="headerlink" title="命名规则"></a>命名规则</h3><ul>
<li>icon_test.png</li>
<li><a href="mailto:&#x69;&#99;&#111;&#110;&#95;&#x74;&#x65;&#115;&#x74;&#64;&#x32;&#x78;&#x2e;&#x70;&#x6e;&#x67;">&#x69;&#99;&#111;&#110;&#95;&#x74;&#x65;&#115;&#x74;&#64;&#x32;&#x78;&#x2e;&#x70;&#x6e;&#x67;</a></li>
<li><a href="mailto:&#x69;&#99;&#x6f;&#110;&#95;&#116;&#101;&#115;&#x74;&#x40;&#51;&#x78;&#46;&#112;&#x6e;&#103;">&#x69;&#99;&#x6f;&#110;&#95;&#116;&#101;&#115;&#x74;&#x40;&#51;&#x78;&#46;&#112;&#x6e;&#103;</a></li>
</ul>
<h2 id="链接原生库"><a href="#链接原生库" class="headerlink" title="链接原生库"></a>链接原生库</h2><p><strong>第一步</strong></p>
<blockquote>
<p>安装带原生依赖的库</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install &lt;某个带有原生依赖的库&gt; --save</span><br></pre></td></tr></table></figure>

<p><strong>第二步</strong></p>
<blockquote>
<p>运行以下命令，它会根据 package.json 文件中的 dependencies 和 devDependencies 记录来链接所有需要链接的库</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native link</span><br></pre></td></tr></table></figure>

<h2 id="开发技巧"><a href="#开发技巧" class="headerlink" title="开发技巧"></a>开发技巧</h2><ul>
<li>启动 hot 或者 debug 的时候，切记不要同时启动 ios and android，两者会发生冲突，导致出现程序崩溃，从而影响开发</li>
<li>最好的方式是，启动一个 hot 或 debug，这样可以良好的进行开发；另一个手动足够了</li>
</ul>
<h2 id="处理触摸事件"><a href="#处理触摸事件" class="headerlink" title="处理触摸事件"></a>处理触摸事件</h2><blockquote>
<p>使用”Touchable”开头的一系列组件<br>通过 onPress 属性接受一个点击事件的处理函数</p>
</blockquote>
<ul>
<li>两种方式绑定事件，并处理点击范围</li>
<li>推荐第二种，方便传递数据</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">_onPressButton=((item)=&gt;&#123;</span><br><span class="line">  alert(1)</span><br><span class="line">  console.log(item);</span><br><span class="line">&#125;)</span><br><span class="line">render() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;View&gt;</span><br><span class="line">      &lt;TouchableHighlight onPress=&#123;this._onPressButton&#125;&gt;</span><br><span class="line">        &lt;View style=&#123;[S.btn,&#123;backgroundColor:`$&#123;this.state.bg&#125;`&#125;]&#125;&gt;</span><br><span class="line">          &lt;Text style=&#123;S.btnText&#125;&gt;&#123;this.state.bg&#125;&lt;/Text&gt;</span><br><span class="line">        &lt;/View&gt;</span><br><span class="line">      &lt;/TouchableHighlight&gt;</span><br><span class="line">      &lt;TouchableHighlight onPress=&#123;()=&gt;&#123;</span><br><span class="line">        this._onPressButton(this.state.bg)</span><br><span class="line">      &#125;&#125;&gt;</span><br><span class="line">        &lt;View style=&#123;[S.btn,&#123;backgroundColor:`$&#123;this.state.bg&#125;`&#125;]&#125;&gt;</span><br><span class="line">          &lt;Text style=&#123;S.btnText&#125;&gt;&#123;this.state.bg&#125;&lt;/Text&gt;</span><br><span class="line">        &lt;/View&gt;</span><br><span class="line">      &lt;/TouchableHighlight&gt;</span><br><span class="line">    &lt;/View&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="解决版本冲突问题"><a href="#解决版本冲突问题" class="headerlink" title="解决版本冲突问题"></a>解决版本冲突问题</h2><p><strong>js 版本和 rn 版本出现冲突</strong></p>
<ul>
<li>Watchman 是由 Facebook 提供的监视文件系统变更的工具。安装此工具可以提高开发时的性能（packager 可以快速捕捉文件的变化从而实现实时刷新）。</li>
<li>清除 Watchman：watchman watch-del-all</li>
<li>清除 rn 缓存：react-native start –reset-cache</li>
</ul>
<h2 id="解决路由失效问题"><a href="#解决路由失效问题" class="headerlink" title="解决路由失效问题"></a>解决路由失效问题</h2><ul>
<li><p>createTabNavigator 要在 createStackNavigator 里面进行注册，才能够使用 createStackNavigator 具有的方法，这个是我第二次配置的时候掉进的一个坑<br><strong>this.props.navigation 属性详细说明</strong></p>
</li>
<li><p>在 createTabNavigator 里面没有 push、replace 等方法</p>
</li>
<li><p>在 createStackNavigator 中存在 push、replace 等方法</p>
</li>
</ul>
<h2 id="AsyncStorage-保存报错"><a href="#AsyncStorage-保存报错" class="headerlink" title="AsyncStorage 保存报错"></a>AsyncStorage 保存报错</h2><blockquote>
<p>JSON value ‘<null>‘ of type NSNull</p>
</blockquote>
<ul>
<li>当保存值为 undefined 的时候，报错</li>
<li>防止这种问题发生最好在 this.state 中保存初始值为空，必要时可以提醒用户</li>
</ul>
<h2 id="react-native-支持的-style-props"><a href="#react-native-支持的-style-props" class="headerlink" title="react-native 支持的 style props"></a>react-native 支持的 style props</h2><ul>
<li>查看最新版属性支持情况，最简单的直接在页面使用错误的属性，然后查看报错信息 😂</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">Valid style props: [</span><br><span class="line">  &quot;alignContent&quot;,</span><br><span class="line">  &quot;alignItems&quot;,</span><br><span class="line">  &quot;alignSelf&quot;,</span><br><span class="line">  &quot;aspectRatio&quot;,</span><br><span class="line">  &quot;backfaceVisibility&quot;,</span><br><span class="line">  &quot;backgroundColor&quot;,</span><br><span class="line">  &quot;borderBottomColor&quot;,</span><br><span class="line">  &quot;borderBottomEndRadius&quot;,</span><br><span class="line">  &quot;borderBottomLeftRadius&quot;,</span><br><span class="line">  &quot;borderBottomRightRadius&quot;,</span><br><span class="line">  &quot;borderBottomStartRadius&quot;,</span><br><span class="line">  &quot;borderBottomWidth&quot;,</span><br><span class="line">  &quot;borderColor&quot;,</span><br><span class="line">  &quot;borderEndColor&quot;,</span><br><span class="line">  &quot;borderEndWidth&quot;,</span><br><span class="line">  &quot;borderLeftColor&quot;,</span><br><span class="line">  &quot;borderLeftWidth&quot;,</span><br><span class="line">  &quot;borderRadius&quot;,</span><br><span class="line">  &quot;borderRightColor&quot;,</span><br><span class="line">  &quot;borderRightWidth&quot;,</span><br><span class="line">  &quot;borderStartColor&quot;,</span><br><span class="line">  &quot;borderStartWidth&quot;,</span><br><span class="line">  &quot;borderStyle&quot;,</span><br><span class="line">  &quot;borderTopColor&quot;,</span><br><span class="line">  &quot;borderTopEndRadius&quot;,</span><br><span class="line">  &quot;borderTopLeftRadius&quot;,</span><br><span class="line">  &quot;borderTopRightRadius&quot;,</span><br><span class="line">  &quot;borderTopStartRadius&quot;,</span><br><span class="line">  &quot;borderTopWidth&quot;,</span><br><span class="line">  &quot;borderWidth&quot;,</span><br><span class="line">  &quot;bottom&quot;,</span><br><span class="line">  &quot;color&quot;,</span><br><span class="line">  &quot;decomposedMatrix&quot;,</span><br><span class="line">  &quot;direction&quot;,</span><br><span class="line">  &quot;display&quot;,</span><br><span class="line">  &quot;elevation&quot;,</span><br><span class="line">  &quot;end&quot;,</span><br><span class="line">  &quot;flex&quot;,</span><br><span class="line">  &quot;flexBasis&quot;,</span><br><span class="line">  &quot;flexDirection&quot;,</span><br><span class="line">  &quot;flexGrow&quot;,</span><br><span class="line">  &quot;flexShrink&quot;,</span><br><span class="line">  &quot;flexWrap&quot;,</span><br><span class="line">  &quot;fontFamily&quot;,</span><br><span class="line">  &quot;fontSize&quot;,</span><br><span class="line">  &quot;fontStyle&quot;,</span><br><span class="line">  &quot;fontVariant&quot;,</span><br><span class="line">  &quot;fontWeight&quot;,</span><br><span class="line">  &quot;height&quot;,</span><br><span class="line">  &quot;includeFontPadding&quot;,</span><br><span class="line">  &quot;justifyContent&quot;,</span><br><span class="line">  &quot;left&quot;,</span><br><span class="line">  &quot;letterSpacing&quot;,</span><br><span class="line">  &quot;lineHeight&quot;,</span><br><span class="line">  &quot;margin&quot;,</span><br><span class="line">  &quot;marginBottom&quot;,</span><br><span class="line">  &quot;marginEnd&quot;,</span><br><span class="line">  &quot;marginHorizontal&quot;,</span><br><span class="line">  &quot;marginLeft&quot;,</span><br><span class="line">  &quot;marginRight&quot;,</span><br><span class="line">  &quot;marginStart&quot;,</span><br><span class="line">  &quot;marginTop&quot;,</span><br><span class="line">  &quot;marginVertical&quot;,</span><br><span class="line">  &quot;maxHeight&quot;,</span><br><span class="line">  &quot;maxWidth&quot;,</span><br><span class="line">  &quot;minHeight&quot;,</span><br><span class="line">  &quot;minWidth&quot;,</span><br><span class="line">  &quot;opacity&quot;,</span><br><span class="line">  &quot;overflow&quot;,</span><br><span class="line">  &quot;overlayColor&quot;,</span><br><span class="line">  &quot;padding&quot;,</span><br><span class="line">  &quot;paddingBottom&quot;,</span><br><span class="line">  &quot;paddingEnd&quot;,</span><br><span class="line">  &quot;paddingHorizontal&quot;,</span><br><span class="line">  &quot;paddingLeft&quot;,</span><br><span class="line">  &quot;paddingRight&quot;,</span><br><span class="line">  &quot;paddingStart&quot;,</span><br><span class="line">  &quot;paddingTop&quot;,</span><br><span class="line">  &quot;paddingVertical&quot;,</span><br><span class="line">  &quot;position&quot;,</span><br><span class="line">  &quot;resizeMode&quot;,</span><br><span class="line">  &quot;right&quot;,</span><br><span class="line">  &quot;rotation&quot;,</span><br><span class="line">  &quot;scaleX&quot;,</span><br><span class="line">  &quot;scaleY&quot;,</span><br><span class="line">  &quot;shadowColor&quot;,</span><br><span class="line">  &quot;shadowOffset&quot;,</span><br><span class="line">  &quot;shadowOpacity&quot;,</span><br><span class="line">  &quot;shadowRadius&quot;,</span><br><span class="line">  &quot;start&quot;,</span><br><span class="line">  &quot;textAlign&quot;,</span><br><span class="line">  &quot;textAlignVertical&quot;,</span><br><span class="line">  &quot;textDecorationColor&quot;,</span><br><span class="line">  &quot;textDecorationLine&quot;,</span><br><span class="line">  &quot;textDecorationStyle&quot;,</span><br><span class="line">  &quot;textShadowColor&quot;,</span><br><span class="line">  &quot;textShadowOffset&quot;,</span><br><span class="line">  &quot;textShadowRadius&quot;,</span><br><span class="line">  &quot;textTransform&quot;,</span><br><span class="line">  &quot;tintColor&quot;,</span><br><span class="line">  &quot;top&quot;,</span><br><span class="line">  &quot;transform&quot;,</span><br><span class="line">  &quot;transformMatrix&quot;,</span><br><span class="line">  &quot;translateX&quot;,</span><br><span class="line">  &quot;translateY&quot;,</span><br><span class="line">  &quot;width&quot;,</span><br><span class="line">  &quot;writingDirection&quot;,</span><br><span class="line">  &quot;zIndex&quot;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h2 id="StatusBar-解决-android-状态栏问题"><a href="#StatusBar-解决-android-状态栏问题" class="headerlink" title="StatusBar 解决 android 状态栏问题"></a>StatusBar 解决 android 状态栏问题</h2><p>设置 StatusBar</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;StatusBar</span><br><span class="line">     backgroundColor=&quot;transparent&quot;</span><br><span class="line">     translucent</span><br><span class="line">   /&gt;</span><br></pre></td></tr></table></figure>

<p>设置顶部模块的样式</p>
<ul>
<li>注：padding 值需要+高度值&#x3D;&gt;height 最终值</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">height: 50,</span><br><span class="line">paddingTop: 10,</span><br></pre></td></tr></table></figure>

<h2 id="Platform-区分-ios-and-android-平台"><a href="#Platform-区分-ios-and-android-平台" class="headerlink" title="Platform 区分 ios and android 平台"></a>Platform 区分 ios and android 平台</h2><blockquote>
<p>三种方法实现跨平台：</p>
</blockquote>
<ol>
<li>Platform.OS</li>
<li>使用 Platform 的 select 方法</li>
<li>使用不能组件名：ios 使用 header.ios.js；android 使用 header.android.js</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const instructions = Platform.select(&#123;</span><br><span class="line">  ios: &#x27;ios&#x27;,</span><br><span class="line">  android: &#x27;android&#x27;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="请求-fetch-封装"><a href="#请求-fetch-封装" class="headerlink" title="请求 fetch 封装"></a>请求 fetch 封装</h2><ul>
<li>HttpUtils.js<br><strong>引入</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import HttpUtils from &#x27;../../HttpUtils&#x27;;</span><br></pre></td></tr></table></figure>

<p><strong>使用</strong></p>
<ul>
<li>在全局 global.data.domain 保存请求域名</li>
<li>请求需要 header 传递 token 的使用,global.data.token</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">HttpUtils.post(`$&#123;apiConfig&#125;`, &#123;</span><br><span class="line">    platform: &#x27;ios&#x27;</span><br><span class="line">&#125;,global.data.token)</span><br><span class="line">.then(rtn =&gt; &#123;</span><br><span class="line">    global.data.config = rtn;</span><br><span class="line">    // console.log(`配置=&gt;( $&#123;JSON.stringify(rtn)&#125; )`);</span><br><span class="line">&#125;)</span><br><span class="line">.catch(err =&gt; &#123;</span><br><span class="line">    console.log(&#x27;error&#x27;, err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="请求环境-请求地址定义"><a href="#请求环境-请求地址定义" class="headerlink" title="请求环境+请求地址定义"></a>请求环境+请求地址定义</h2><h3 id="请求环境"><a href="#请求环境" class="headerlink" title="请求环境"></a>请求环境</h3><ul>
<li>在 addr.js 中 env 变量定义</li>
</ul>
<h3 id="请求地址"><a href="#请求地址" class="headerlink" title="请求地址"></a>请求地址</h3><ul>
<li>在 addr.js 中 addrList 统一管理所有请求地址</li>
</ul>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import addrList from &#x27;../../addr&#x27;;</span><br><span class="line">const &#123;apiConfig&#125;=addrList;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>react-native-scrollable-tab-view</p>
</blockquote>
<ul>
<li>解决逗号影响的报错问题：在路径~&#x2F;node_modules&#x2F;react-native-scrollable-tab-viewSceneComponent.js 下删除即可</li>
</ul>
<h2 id="react-native-初始化报错，导致无法初始化"><a href="#react-native-初始化报错，导致无法初始化" class="headerlink" title="react-native 初始化报错，导致无法初始化"></a>react-native 初始化报错，导致无法初始化</h2><ul>
<li>重新设置一下地址</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry https://registry.npm.taobao.org</span><br><span class="line">npm config set disturl https://npm.taobao.org/dist</span><br></pre></td></tr></table></figure>

<h2 id="动态切换状态"><a href="#动态切换状态" class="headerlink" title="动态切换状态"></a>动态切换状态</h2><ul>
<li>采用对象的形式来操作，这样可以使用 state 里面的参数，来动态切换</li>
<li>解决了直接应用的报错问题，以后遇到同样的问题要及时想到对象方式</li>
</ul>
<h2 id="声明周期-初始渲染-and-检测-goBack"><a href="#声明周期-初始渲染-and-检测-goBack" class="headerlink" title="声明周期-初始渲染 and 检测 goBack()"></a>声明周期-初始渲染 and 检测 goBack()</h2><ul>
<li>为了保证页面的数据实时性，最好在初始的时候进行请求</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">componentDidMount()&#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="检测-goBack"><a href="#检测-goBack" class="headerlink" title="检测 goBack()"></a>检测 goBack()</h3><blockquote>
<p>需要重新加载 app</p>
</blockquote>
<p><strong>第一步</strong></p>
<ul>
<li>在删除组件的时候，定义 goBack 事件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">componentWillUnmount()&#123;</span><br><span class="line">  DeviceEventEmitter.emit(&#x27;goBack&#x27;, &#x27;goBack刷新返回页面数据&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>第二步</strong></p>
<ul>
<li>在初始渲染中监听，goBack 自定义事件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">componentDidMount()&#123;</span><br><span class="line">  // 接收</span><br><span class="line">  this.deEmitter = DeviceEventEmitter.addListener(&#x27;goBack&#x27;, (a) =&gt; &#123;</span><br><span class="line">    this.loadData();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="安卓打包"><a href="#安卓打包" class="headerlink" title="安卓打包"></a>安卓打包</h2><h3 id="第一步：生成-Android-签名证书"><a href="#第一步：生成-Android-签名证书" class="headerlink" title="第一步：生成 Android 签名证书"></a>第一步：<a target="_blank" rel="noopener" href="https://developer.android.com/studio/publish/app-signing">生成 Android 签名证书</a></h3><h3 id="第二步：设置-gradle-变量"><a href="#第二步：设置-gradle-变量" class="headerlink" title="第二步：设置 gradle 变量"></a>第二步：设置 gradle 变量</h3><ul>
<li>将你的签名证书 copy 到 android&#x2F;app 目录下</li>
<li>编辑<code>~/.gradle/gradle.properties</code>或<code>../android/gradle.properties</code>(一个是全局 gradle.properties，一个是项目中的 gradle.properties，大家可以根据需要进行修改) ，加入如下代码：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MYAPP_RELEASE_STORE_FILE=ch09-keystore.jks</span><br><span class="line">MYAPP_RELEASE_KEY_ALIAS=ch09-keystore</span><br><span class="line">MYAPP_RELEASE_STORE_PASSWORD=123456</span><br><span class="line">MYAPP_RELEASE_KEY_PASSWORD=123456</span><br></pre></td></tr></table></figure>

<h3 id="第三步：在-gradle-配置文件中添加签名配置"><a href="#第三步：在-gradle-配置文件中添加签名配置" class="headerlink" title="第三步：在 gradle 配置文件中添加签名配置"></a>第三步：在 gradle 配置文件中添加签名配置</h3><ul>
<li>编辑<code>android/app/build.gradle</code>文件添加如下代码：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">android &#123;</span><br><span class="line">    ...</span><br><span class="line">    defaultConfig &#123; ... &#125;</span><br><span class="line">    signingConfigs &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            storeFile file(MYAPP_RELEASE_STORE_FILE)</span><br><span class="line">            storePassword MYAPP_RELEASE_STORE_PASSWORD</span><br><span class="line">            keyAlias MYAPP_RELEASE_KEY_ALIAS</span><br><span class="line">            keyPassword MYAPP_RELEASE_KEY_PASSWORD</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            ...</span><br><span class="line">            signingConfig signingConfigs.release</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h3 id="第四步：签名打包-APK"><a href="#第四步：签名打包-APK" class="headerlink" title="第四步：签名打包 APK"></a>第四步：签名打包 APK</h3><ul>
<li>terminal 进入项目下的 android 目录，运行如下代码：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew assembleRelease</span><br></pre></td></tr></table></figure>

<ul>
<li>签名打包成功后你会在 android&#x2F;app&#x2F;build&#x2F;outputs&#x2F;apk&#x2F;目录下看到签名成功后的 app-release.apk 文件。</li>
<li>提示：如果你需要对 apk 进行混淆打包 编辑 android&#x2F;app&#x2F;build.gradle：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Run Proguard to shrink the Java bytecode in release builds.</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">def enableProguardInReleaseBuilds = true</span><br></pre></td></tr></table></figure>

<h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">fetch(apiLogin, &#123;</span><br><span class="line">    method: &#x27;POST&#x27;,</span><br><span class="line">    headers: &#123;</span><br><span class="line">      &#x27;Accept&#x27;: &#x27;application/json&#x27;,//通过头指定，获取的数据类型是JSON</span><br><span class="line">      &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,</span><br><span class="line">      &#x27;Authorization&#x27;:global.data.token,</span><br><span class="line">    &#125;,</span><br><span class="line">    body: JSON.stringify(&#123;</span><br><span class="line">      // 请求参数</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(result =&gt; &#123;</span><br><span class="line">    const &#123;status,statusText&#125; = result;</span><br><span class="line">    if(status&gt;=200 &amp;&amp; status&lt;300 || status==304)&#123;</span><br><span class="line">      // 成功</span><br><span class="line">      const promise = result.json()</span><br><span class="line">      promise.then(rtn=&gt;&#123;</span><br><span class="line">        // 成功</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;else if(status==403)&#123;</span><br><span class="line">      // 跳转登录</span><br><span class="line">      this.props.navigation.replace(&#x27;login&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      // 提醒 statusText</span><br><span class="line">      this.refs.toast.show(statusText);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(error =&gt; &#123;</span><br><span class="line">    if(Object.prototype.toString.call(error) === &#x27;[object Object]&#x27;)&#123;</span><br><span class="line">        this.refs.toast.show(JSON.stringify(error))</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        this.refs.toast.show(error)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<h2 id="app-的-logo-and-name"><a href="#app-的-logo-and-name" class="headerlink" title="app 的 logo and name"></a>app 的 logo and name</h2><h3 id="android"><a href="#android" class="headerlink" title="android"></a>android</h3><p><strong>LOGO</strong></p>
<ul>
<li>将 logo 分别放到 android&#x2F;app&#x2F;src&#x2F;main&#x2F;res 下的四个文件夹中,命名为 ic_launcher.png</li>
<li>没有对应上的文件夹放一张<code>1024*1024</code>或者<code>512*512</code>的即可</li>
</ul>
<p><strong>app 名称</strong></p>
<ul>
<li>在<code>android/app/src/main/res/values/strings.xml</code>中更改</li>
</ul>
<h3 id="IOS"><a href="#IOS" class="headerlink" title="IOS"></a>IOS</h3><p><strong>LOGO</strong></p>
<ul>
<li>xcode&gt; 根目录 &gt;Images.xcassets 将生成的图标拖入对应的位置</li>
</ul>
<p><strong>app 名称</strong></p>
<ul>
<li>xcode&gt; 根目录 &gt;Info.plist 中修改 Bundlename 和 General&gt; Display Name</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/16/webpack%E7%94%A8%E6%B3%95%E5%B0%8F%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/portal.jpg">
      <meta itemprop="name" content="Bruce Chen">
      <meta itemprop="description" content="It's better to burn out than to fade away.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Chen's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/16/webpack%E7%94%A8%E6%B3%95%E5%B0%8F%E7%BB%93/" class="post-title-link" itemprop="url">webpack用法小结</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-12-16 14:18:29 / 修改时间：14:25:06" itemprop="dateCreated datePublished" datetime="2022-12-16T14:18:29+08:00">2022-12-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E6%80%BB%E7%BB%93/" itemprop="url" rel="index"><span itemprop="name">前端框架总结</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1、webpack-是什么"><a href="#1、webpack-是什么" class="headerlink" title="1、webpack 是什么"></a>1、webpack 是什么</h2><p>根据文档的定义：本质上，webpack 是一个现代 JavaScript 应用程序的静态模块打包器(module bundler)。当 webpack 处理应用程序时，它会递归地构建一个依赖关系图(dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle。</p>
<h2 id="2、webpack-四个核心概念"><a href="#2、webpack-四个核心概念" class="headerlink" title="2、webpack 四个核心概念"></a>2、webpack 四个核心概念</h2><ul>
<li>入口(entry) 入口，webpack 执行构建的第一步将从 Entry 开始，可抽象成输入</li>
<li>输出(output) 输出结果，在 Webpack 经过一系列处理并得出最终想要的代码后输出结果</li>
<li>加载器(loader) 模块转换器，用于把模块原内容按照需求转换成新内容。</li>
<li>插件(plugins) 扩展插件，在 Webpack 构建流程中的特定时机会广播出对应的事件，插件可以监听这些事件的发生，在特定时机做对应的事情。</li>
</ul>
<h3 id="2-1entry"><a href="#2-1entry" class="headerlink" title="2.1entry"></a>2.1entry</h3><ul>
<li>定义的三种方法</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">第一种用法</span><br><span class="line">    module.exports = &#123;</span><br><span class="line">        entry:&#x27;index.js&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">第二种用法</span><br><span class="line">    module.exports = &#123;</span><br><span class="line">        entry:[&#x27;index.js&#x27;,&#x27;b.js&#x27;]</span><br><span class="line">    &#125;</span><br><span class="line">第三种用法</span><br><span class="line">    module.exports = &#123;</span><br><span class="line">        entry:&#123;</span><br><span class="line">          index:&#x27;index.js&#x27;,</span><br><span class="line">          b:&#x27;b.js&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>推荐使用使用第三种方法，方便分清各个入口的定义</p>
<h3 id="2-2output"><a href="#2-2output" class="headerlink" title="2.2output"></a>2.2output</h3><ul>
<li>打包成的文件</li>
<li>一个或多个</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line"> entry:&#123;</span><br><span class="line"> index:&#x27;index.js&#x27;,</span><br><span class="line"> b:&#x27;b.js&#x27;</span><br><span class="line"> &#125;,</span><br><span class="line"> output:&#123;</span><br><span class="line">     path:path.resolve(__dirname,&#x27;dist&#x27;),</span><br><span class="line">     filename:&#x27;[name].min.[hash:5].js&#x27;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，</p>
<ul>
<li>output 中的 name 和 entry 中的 key 相对应</li>
<li>output 的 filename 可以指定 hash。有两个值可以选择：<ul>
<li>[hash]：hash 值是特定于整个构建过程的。</li>
<li>[chunkhash]：hash 值是特定于每一个文件的内容的。<br>我们理想的缓存设计是，在一次版本更新(重新构建)后，只有当一个文件的内容确实发生了变化，它才需要被重新下载，否则应使用缓存。<br>因此，以上两个值中更推荐的是[chunkhash]。你也可以阅读这篇官方的缓存指南了解更多细节。</li>
</ul>
</li>
</ul>
<h3 id="2-3loader"><a href="#2-3loader" class="headerlink" title="2.3loader"></a>2.3loader</h3><ul>
<li>作用： 通过使用不同的 Loader，Webpack 可以要把不同的文件都转成 JS 文件,比如 CSS、ES6&#x2F;7、JSX 等</li>
<li>参数<ul>
<li>test：匹配处理文件的扩展名的正则表达式</li>
<li>use：loader 名称，就是你要使用模块的名称</li>
<li>include&#x2F;exclude:手动指定必须处理的文件夹或屏蔽不需要处理的文件夹</li>
<li>query：为 loaders 提供额外的设置选项<br>下面以 css-loader 为例</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">    module: &#123;</span><br><span class="line">+        rules:[</span><br><span class="line">+            &#123;</span><br><span class="line">+                test:/\.css$/,</span><br><span class="line">+                use:[&#x27;style-loader&#x27;,&#x27;css-loader&#x27;],</span><br><span class="line">+                include:path.join(__dirname,&#x27;./src&#x27;),</span><br><span class="line">+                exclude:/node_modules/</span><br><span class="line">+            &#125;</span><br><span class="line">+        ]</span><br><span class="line">   &#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>常用的 loader<ul>
<li>编译相关 babel-loader ts-loader</li>
<li>样式相关 style-loader css-loader less-loader postcss-loader</li>
<li>文件相关 file-loader url-loader</li>
</ul>
</li>
</ul>
<h3 id="2-4plugins"><a href="#2-4plugins" class="headerlink" title="2.4plugins"></a>2.4plugins</h3><ul>
<li>参与打包的整个过程</li>
<li>打包优化和压缩</li>
<li>配置编译时的变量</li>
<li>用法(以压缩 js 插件为例)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        new UglifyjsWebpackPlugin()</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>常用的 plugin<ul>
<li>优化相关<ul>
<li>CommonsChunkPlugin</li>
<li>UglifyjsWebpackPlugin</li>
</ul>
</li>
<li>功能相关<ul>
<li>ExtractTextWebpackPlugin</li>
<li>HtmlWebpackPlugin</li>
<li>HotModuleReplacementPlugin</li>
<li>CopyWebpackPlugin</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="3、webpack-的常用配置"><a href="#3、webpack-的常用配置" class="headerlink" title="3、webpack 的常用配置"></a>3、webpack 的常用配置</h2><h3 id="3-1-配置开发服务器"><a href="#3-1-配置开发服务器" class="headerlink" title="3.1 配置开发服务器"></a>3.1 配置开发服务器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i webpack-dev-server -D</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+ devServer:&#123;</span><br><span class="line">+        contentBase:path.resolve(__dirname,&#x27;dist&#x27;),</span><br><span class="line">+        host:&#x27;localhost&#x27;,</span><br><span class="line">+        compress:true,</span><br><span class="line">+        port:8080</span><br><span class="line">+ &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>contentBase 配置开发服务运行时的文件根目录</li>
<li>host：开发服务器监听的主机地址</li>
<li>compress 开发服务器是否启动 gzip 等压缩</li>
<li>port：开发服务器监听的端口</li>
</ul>
<h3 id="3-2-自动产出-html"><a href="#3-2-自动产出-html" class="headerlink" title="3.2 自动产出 html"></a>3.2 自动产出 html</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i html-webpack-plugin -D</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">   plugins: [</span><br><span class="line">+        new HtmlWebpackPlugin(&#123;</span><br><span class="line">+       minify: &#123;</span><br><span class="line">+            removeAttributeQuotes:true</span><br><span class="line">+        &#125;,</span><br><span class="line">+        hash: true,</span><br><span class="line">+        template: &#x27;./src/index.html&#x27;,</span><br><span class="line">+        filename:&#x27;index.html&#x27;</span><br><span class="line">    &#125;)]</span><br></pre></td></tr></table></figure>

<ul>
<li>minify 是对 html 文件进行压缩，removeAttrubuteQuotes 是去掉属性的双引号</li>
<li>hash 引入产出资源的时候加上哈希避免缓存</li>
<li>template 模版路径</li>
</ul>
<h3 id="3-3-分离-css"><a href="#3-3-分离-css" class="headerlink" title="3.3 分离 css"></a>3.3 分离 css</h3><p>因为 CSS 的下载和 JS 可以并行，当一个 html 文件很大的时候，我们可以把 css 单独提取出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev extract-text-webpack-plugin</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">   module: &#123;</span><br><span class="line">+        rules:[</span><br><span class="line">+            &#123;</span><br><span class="line">+               test:/\.css$/,</span><br><span class="line">+                use: ExtractTextWebpackPlugin.extract(&#123;</span><br><span class="line">+                    use:&#x27;css-loader&#x27;</span><br><span class="line">+                &#125;),</span><br><span class="line">                include:path.join(__dirname,&#x27;./src&#x27;),</span><br><span class="line">                exclude:/node_modules/</span><br><span class="line">+            &#125;</span><br><span class="line">+        ]</span><br><span class="line">    &#125;,</span><br><span class="line">     plugins: [</span><br><span class="line">+        new ExtractTextWebpackPlugin(&#x27;css/index.css&#x27;)]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-4-编译-less-和-sass"><a href="#3-4-编译-less-和-sass" class="headerlink" title="3.4 编译 less 和 sass"></a>3.4 编译 less 和 sass</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i less less-loader -D</span><br><span class="line">npm i node-saas sass-loader -D</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">const cssExtract=new ExtractTextWebpackPlugin(&#x27;css.css&#x27;);</span><br><span class="line">const lessExtract=new ExtractTextWebpackPlugin(&#x27;less.css&#x27;);</span><br><span class="line">const sassExtract=new ExtractTextWebpackPlugin(&#x27;sass.css&#x27;);</span><br><span class="line"></span><br><span class="line"> &#123;</span><br><span class="line">                test:/\.less$/,</span><br><span class="line">                use: lessExtract.extract(&#123;</span><br><span class="line">                    use:[&#x27;css-loader&#x27;,&#x27;less-loader&#x27;]</span><br><span class="line">                &#125;),</span><br><span class="line">                include:path.join(__dirname,&#x27;./src&#x27;),</span><br><span class="line">                exclude:/node_modules/</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.scss$/,</span><br><span class="line">                use: sassExtract.extract(&#123;</span><br><span class="line">                    use:[&#x27;css-loader&#x27;,&#x27;sass-loader&#x27;]</span><br><span class="line">                &#125;),</span><br><span class="line">                include:path.join(__dirname,&#x27;./src&#x27;),</span><br><span class="line">                exclude:/node_modules/</span><br><span class="line">            &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="3-5-处理-CSS3-属性前缀"><a href="#3-5-处理-CSS3-属性前缀" class="headerlink" title="3.5 处理 CSS3 属性前缀"></a>3.5 处理 CSS3 属性前缀</h3><p>为了浏览器的兼容性，有时候我们必须加入-webkit,-ms,-o,-moz 这些前缀</p>
<ul>
<li>Trident 内核：主要代表为 IE 浏览器, 前缀为-ms</li>
<li>Gecko 内核：主要代表为 Firefox, 前缀为-moz</li>
<li>Presto 内核：主要代表为 Opera, 前缀为-o</li>
<li>Webkit 内核：产要代表为 Chrome 和 Safari, 前缀为-webkit</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i postcss-loader autoprefixer -D</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">module.exports=&#123;</span><br><span class="line">    plugins:[require(&#x27;autoprefixer&#x27;)]</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">                test:/\.css$/,</span><br><span class="line">                use: cssExtract.extract(&#123;</span><br><span class="line">+                   use:[&#x27;css-loader&#x27;,&#x27;postcss-loader&#x27;]</span><br><span class="line">                &#125;),</span><br><span class="line">                include:path.join(__dirname,&#x27;./src&#x27;),</span><br><span class="line">                exclude:/node_modules/</span><br><span class="line">            &#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/postcss/postcss-loader">postcss-loader</a>其它用法可以参考文档</p>
<h3 id="3-6-转义-ES6-x2F-ES7"><a href="#3-6-转义-ES6-x2F-ES7" class="headerlink" title="3.6 转义 ES6&#x2F;ES7"></a>3.6 转义 ES6&#x2F;ES7</h3><p>Babel 其实是一个编译 JavaScript 的平台,可以把 ES6&#x2F;ES7,React 的 JSX 转义为 ES5</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i babel-core babel-loader babel-preset-env babel-preset-stage-0 babel-preset-react -D</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test:/\.jsx?$/,</span><br><span class="line">    use: &#123;</span><br><span class="line">        loader: &#x27;babel-loader&#x27;,</span><br><span class="line">        options: &#123;</span><br><span class="line">            presets: [&quot;env&quot;,&quot;stage-0&quot;,&quot;react&quot;]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    include:path.join(__dirname,&#x27;./src&#x27;),</span><br><span class="line">    exclude:/node_modules/</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="3-7-调试打包后的代码"><a href="#3-7-调试打包后的代码" class="headerlink" title="3.7 调试打包后的代码"></a>3.7 调试打包后的代码</h3><p>webapck 通过配置可以自动给我们 sourcemaps 文件，map 文件是一种对应编译文件和源文件的方法</p>
<ul>
<li>source-map 把映射文件生成到单独的文件，最完整最慢</li>
<li>cheap-module-source-map 在一个单独的文件中产生一个不带列映射的 Map</li>
<li>eval-source-map 使用 eval 打包源文件模块,在同一个文件中生成完整 sourcemap</li>
<li>cheap-module-eval-source-map sourcemap 和打包后的 JS 同行显示，没有映射列</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    devtool:&#x27;eval-source-map&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-8watch"><a href="#3-8watch" class="headerlink" title="3.8watch"></a>3.8watch</h3><p>当代码发生修改后可以自动重新编译</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">new webpack.BannerPlugin(&#x27;&#x27;),</span><br><span class="line"></span><br><span class="line">watch: true,</span><br><span class="line">watchOptions: &#123;</span><br><span class="line">    ignored: /node_modules/, //忽略不用监听变更的目录</span><br><span class="line">    aggregateTimeout: 500, //防止重复保存频繁重新编译,500毫秒内重复保存不打包</span><br><span class="line">    poll:1000 //每秒询问的文件变更的次数</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="3-9-拷贝静态文件"><a href="#3-9-拷贝静态文件" class="headerlink" title="3.9 拷贝静态文件"></a>3.9 拷贝静态文件</h3><p>有时项目中没有引用的文件也需要打包到目标目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i copy-webpack-plugin -D</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">new CopyWebpackPlugin([&#123;</span><br><span class="line">    from: path.join(__dirname,&#x27;public&#x27;),//静态资源目录源地址</span><br><span class="line">    to:&#x27;./public&#x27; //目标地址，相对于output的path目录</span><br><span class="line">&#125;]),</span><br></pre></td></tr></table></figure>

<h3 id="3-10-打包先清空"><a href="#3-10-打包先清空" class="headerlink" title="3.10 打包先清空"></a>3.10 打包先清空</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i  clean-webpack-plugin -D</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new cleanWebpackPlugin(path.join(__dirname,&#x27;dist&#x27;))</span><br></pre></td></tr></table></figure>

<h3 id="3-11-压缩-js-x2F-css"><a href="#3-11-压缩-js-x2F-css" class="headerlink" title="3.11 压缩 js &#x2F;css"></a>3.11 压缩 js &#x2F;css</h3><ul>
<li><p>压缩 JS 可以让输出的 JS 文件体积更小、加载更快、流量更省，还有混淆代码的加密功能<br><code>npm i uglifyjs-webpack-plugin -D</code><br><code>plugins: [ new UglifyjsWebpackPlugin()]</code></p>
</li>
<li><p>webpack 可以消除未使用的 CSS，比如 bootstrap 中那些未使用的样式</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i -D purifycss-webpack purify-css</span><br><span class="line">npm i bootstrap -S</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test:/\.css$/,</span><br><span class="line">    use: cssExtract.extract(&#123;</span><br><span class="line">        use: [&#123;</span><br><span class="line">             loader: &#x27;css-loader&#x27;,</span><br><span class="line">             options:&#123;minimize:true&#125;</span><br><span class="line">        &#125;,&#x27;postcss-loader&#x27;]</span><br><span class="line">    &#125;),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+ new PurifyCSSPlugin(&#123;</span><br><span class="line">+             //purifycss根据这个路径配置遍历你的HTML文件，查找你使用的CSS</span><br><span class="line">+            paths:glob.sync(path.join(__dirname,&#x27;src/*.html&#x27;))</span><br><span class="line">+ &#125;),</span><br></pre></td></tr></table></figure>

<h2 id="4、总结"><a href="#4、总结" class="headerlink" title="4、总结"></a>4、总结</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">以上是webpack核心概念总结，对概念的理解，有助于总体了解下webpack不同的作用，遇到相关问题，找对应的模块。</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/16/NodeJs%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/portal.jpg">
      <meta itemprop="name" content="Bruce Chen">
      <meta itemprop="description" content="It's better to burn out than to fade away.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Chen's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/16/NodeJs%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/" class="post-title-link" itemprop="url">NodeJs基础知识点</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-12-16 14:18:15 / 修改时间：14:20:49" itemprop="dateCreated datePublished" datetime="2022-12-16T14:18:15+08:00">2022-12-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E6%80%BB%E7%BB%93/" itemprop="url" rel="index"><span itemprop="name">前端框架总结</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-nodejs-的特点"><a href="#1-nodejs-的特点" class="headerlink" title="1.nodejs 的特点"></a>1.nodejs 的特点</h2><h3 id="1-单线程"><a href="#1-单线程" class="headerlink" title="1)单线程"></a>1)单线程</h3><p>在 Java、PHP 等服务器语言中，会为每一个客户端创建一个新的线程，而每个线程需要消耗大约 2MB 的内存。也就是说，一个 8GB 的内存可以满足 4000 人</p>
<p>的访问连接，这样就增加了服务器的硬件成本。Nodejs 不需要为每个用户的连接创建一个新的线程，而仅仅使用一个线程，一个 8GB 的内存可以满足<br>40000 人的连接。</p>
<ul>
<li>好处：操作系统不会再有创建线程、销毁线程的开销。</li>
<li>坏处：如果一个用户导致了线程的奔溃，那么整个服务就奔溃了。</li>
</ul>
<h3 id="2-非阻塞-I-x2F-O"><a href="#2-非阻塞-I-x2F-O" class="headerlink" title="2)非阻塞 I&#x2F;O"></a>2)非阻塞 I&#x2F;O</h3><p>由于 Nodejs 采用了非阻塞 I&#x2F;O 机制，因此在执行访问数据库的代码后，立即转而执行其后的代码，把数据库返回结果的代码处理放在了回调函数中，从而提高了<br>程序的执行效率。</p>
<p>当某个 I&#x2F;O 执行完毕时，将以事件的形式通知执行 I&#x2F;O 的线程，线程执行这个事件的回调函数，为了处理这个异步 I&#x2F;O，线程必须有事件循环，不断的检查有没有未处理的事件，依次予以处理。</p>
<h3 id="3-事件驱动"><a href="#3-事件驱动" class="headerlink" title="3)事件驱动"></a>3)事件驱动</h3><p>在 nodejs 中，客户端请求建立连接，数据提交等行为，会触发相应的事件。在 nodejs 中，在一个时刻只能执行一个事件的回调函数，但是在执行一个事件回调函数<br>的中途，可以转而处理其他事件，然后返回继续执行原事件的回调函数，这种处理机制，称为‘事件环’机制。</p>
<h2 id="2-nodejs-适合开发什么样的业务？"><a href="#2-nodejs-适合开发什么样的业务？" class="headerlink" title="2.nodejs 适合开发什么样的业务？"></a>2.nodejs 适合开发什么样的业务？</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">当应用程序需要处理大量并发的I/O，而在向客户端响应之前，应用程序内部不需要进行非常复杂处理的时候，nodejs非常合适。nodejs也非常适合与websocket</span><br><span class="line">配合，开发长连接的实时交互应用程序。</span><br><span class="line">总之，nodejs擅长任务的调度，善于I/O，不善于计算。</span><br><span class="line">比如：1)用户表单收集  2)考试系统 3)聊天室 4)图文直播 5)提供JSON的api</span><br></pre></td></tr></table></figure>

<h2 id="3-第一个简单的-node-程序"><a href="#3-第一个简单的-node-程序" class="headerlink" title="3.第一个简单的 node 程序"></a>3.第一个简单的 node 程序</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">let http = require(&#x27;http&#x27;);</span><br><span class="line">// 创建服务器，参数是一个回调函数，表示如果有请求进来要做什么</span><br><span class="line"> let server = http.createServer((req,res)=&gt;&#123;</span><br><span class="line">     // 设置http头部，状态码是200，文件类型是html，字符集是utf8</span><br><span class="line">     res.writeHead(200,&#123;&quot;Content-type&quot;:&quot;text/html;charset=UTF-8&quot;&#125;);</span><br><span class="line">     res.end(&#x27;这是我的第一个Node页面&#x27;);</span><br><span class="line"> &#125;)</span><br><span class="line"></span><br><span class="line"> // 运行服务器</span><br><span class="line"> server.listen(3000,&#x27;192.168.124.15&#x27;)</span><br></pre></td></tr></table></figure>

<p><strong>问：如何将 html 页面展示到浏览器中呢</strong>？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">利用引入fs模块</span><br><span class="line">let http = require(&#x27;http&#x27;);</span><br><span class="line">let fs = require(&#x27;fs&#x27;);</span><br><span class="line">let path = require(&#x27;path&#x27;);</span><br><span class="line">let PULIC_PATH = path.resolve(__dirname,&#x27;01_helloWorld.html&#x27;);</span><br><span class="line"></span><br><span class="line">// 创建服务器，参数是一个回调函数，表示如果有请求进来要做什么</span><br><span class="line">let server = http.createServer((req,res)=&gt;&#123;</span><br><span class="line">    fs.readFile(PULIC_PATH,(err,data)=&gt;&#123;</span><br><span class="line">        console.log(&#x27;data&#x27;,data,err);</span><br><span class="line">        // 设置http头部，状态码是200，文件类型是html，字符集是utf8</span><br><span class="line">        res.writeHead(200,&#123;&quot;Content-type&quot;:&quot;text/html;charset=UTF-8&quot;&#125;);</span><br><span class="line">        res.end(data);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 运行服务器</span><br><span class="line">server.listen(3000,&#x27;192.168.1.9&#x27;)</span><br></pre></td></tr></table></figure>

<p><strong>问：如何根据不同的路由展示不同的页面？</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">let http = require(&#x27;http&#x27;);</span><br><span class="line">let fs = require(&#x27;fs&#x27;);</span><br><span class="line">let PUBILC_PATH = require(&#x27;path&#x27;);</span><br><span class="line"></span><br><span class="line">// 创建服务器，参数是一个回调函数，表示如果有请求进来要做什么</span><br><span class="line">let server = http.createServer((req,res)=&gt;&#123;</span><br><span class="line">    if (req.url == &#x27;/sqaure&#x27;) &#123;</span><br><span class="line">        let path = PUBILC_PATH.resolve(__dirname,&#x27;01_helloWorld.html&#x27;);</span><br><span class="line">        fs.readFile(path,(err,data)=&gt;&#123;</span><br><span class="line">            console.log(&#x27;data&#x27;,data,err);</span><br><span class="line">            // 设置http头部，状态码是200，文件类型是html，字符集是utf8</span><br><span class="line">            res.writeHead(200,&#123;&quot;Content-type&quot;:&quot;text/html;charset=UTF-8&quot;&#125;);</span><br><span class="line">            res.end(data);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; else if (req.url == &#x27;/circle&#x27;) &#123;</span><br><span class="line">        let path = PUBILC_PATH.resolve(__dirname,&#x27;01_helloWorld_circle.html&#x27;);</span><br><span class="line">        fs.readFile(path,(err,data)=&gt;&#123;</span><br><span class="line">            console.log(&#x27;data&#x27;,data,err);</span><br><span class="line">            // 设置http头部，状态码是200，文件类型是html，字符集是utf8</span><br><span class="line">            res.writeHead(200,&#123;&quot;Content-type&quot;:&quot;text/html;charset=UTF-8&quot;&#125;);</span><br><span class="line">            res.end(data);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        res.writeHead(404,&#123;&quot;Content-type&quot;:&quot;text/html;charset=UTF-8&quot;&#125;);</span><br><span class="line">        res.end(&#x27;没有这个页面哦&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 运行服务器</span><br><span class="line">server.listen(3000,&#x27;192.168.1.9&#x27;)</span><br><span class="line"></span><br><span class="line">说明：在浏览器中输入http://192.168.1.9:3000/circle即可</span><br></pre></td></tr></table></figure>

<h2 id="4-http-模块与-url-模块"><a href="#4-http-模块与-url-模块" class="headerlink" title="4.http 模块与 url 模块"></a>4.http 模块与 url 模块</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">实例：</span><br><span class="line">    let http = require(&#x27;http&#x27;);</span><br><span class="line">    let url = require(&#x27;url&#x27;);</span><br><span class="line"></span><br><span class="line">    let server = http.createServer((req,res)=&gt;&#123;</span><br><span class="line">        let path = url.parse(req.url);</span><br><span class="line">        /*</span><br><span class="line">            Url &#123;</span><br><span class="line">                protocol: null,</span><br><span class="line">                slashes: null,</span><br><span class="line">                auth: null,</span><br><span class="line">                host: null,</span><br><span class="line">                port: null,</span><br><span class="line">                hostname: null,</span><br><span class="line">                hash: null,</span><br><span class="line">                search: &#x27;?name=wq&amp;age=20&#x27;,</span><br><span class="line">                query: &#x27;name=wq&amp;age=20&#x27;,</span><br><span class="line">                pathname: &#x27;/user&#x27;,</span><br><span class="line">                path: &#x27;/user?name=wq&amp;age=20&#x27;,</span><br><span class="line">                href: &#x27;/user?name=wq&amp;age=20&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        */</span><br><span class="line">        console.log(&#x27;服务器接收到了请求1：&#x27;,path);</span><br><span class="line"></span><br><span class="line">        // 将第二个参数设为true，就把query参数变为Object</span><br><span class="line">        let path2 = url.parse(req.url,true);</span><br><span class="line">        /*</span><br><span class="line">            Url &#123;</span><br><span class="line">                protocol: null,</span><br><span class="line">                slashes: null,</span><br><span class="line">                auth: null,</span><br><span class="line">                host: null,</span><br><span class="line">                port: null,</span><br><span class="line">                hostname: null,</span><br><span class="line">                hash: null,</span><br><span class="line">                search: &#x27;?name=wq&amp;age=20&#x27;,</span><br><span class="line">                query: [Object: null prototype] &#123; name: &#x27;wq&#x27;, age: &#x27;20&#x27; &#125;,</span><br><span class="line">                pathname: &#x27;/user&#x27;,</span><br><span class="line">                path: &#x27;/user?name=wq&amp;age=20&#x27;,</span><br><span class="line">                href: &#x27;/user?name=wq&amp;age=20&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        */</span><br><span class="line">        console.log(&#x27;服务器接收到了请求2：&#x27;,path2);</span><br><span class="line"></span><br><span class="line">        // 设置一个相应头</span><br><span class="line">        res.writeHead(200,&#123;&quot;Content-Type&quot;:&quot;text/html;charset=UTF-8&quot;&#125;);</span><br><span class="line">        // 每个请求都应该加上.end()方法，不然，浏览器请求会一直转菊花等待后端结束</span><br><span class="line">        res.end(&#x27;&lt;h1&gt;响应头&lt;/h1&gt;&#x27;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    server.listen(3000,&#x27;192.168.1.9&#x27;);</span><br></pre></td></tr></table></figure>

<p><strong>实操：做一个简单的表单提交</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;http://192.168.1.9:3000&quot; method=&quot;GET&quot;&gt;</span><br><span class="line">       &lt;input name=&#x27;name&#x27; /&gt;</span><br><span class="line">       &lt;input name=&#x27;age&#x27; /&gt;</span><br><span class="line">       &lt;input name=&#x27;sex&#x27; /&gt;</span><br><span class="line">       &lt;input type=&quot;submit&quot;&gt;</span><br><span class="line">   &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">   let http = require(&#x27;http&#x27;);</span><br><span class="line">   let url = require(&#x27;url&#x27;);</span><br><span class="line">   let queryString = require(&#x27;querystring&#x27;);</span><br><span class="line"></span><br><span class="line">   let server = http.createServer((req,res)=&gt;&#123;</span><br><span class="line">       let queryObj = url.parse(req.url,true).query;</span><br><span class="line">       // querystring的作用与上句作用一样</span><br><span class="line">       let queryObj2 = queryString.parse(req.url.split(&#x27;?&#x27;)[1]);</span><br><span class="line">       console.log(&#x27;参数&#x27;,queryObj,queryObj2);</span><br><span class="line"></span><br><span class="line">       res.end(&#x27;服务器收到了参数&#x27;);</span><br><span class="line">   &#125;)</span><br><span class="line"></span><br><span class="line">   server.listen(3000,&#x27;192.168.1.9&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="5-fs-模块"><a href="#5-fs-模块" class="headerlink" title="5.fs 模块"></a>5.fs 模块</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">let http = require(&#x27;http&#x27;);</span><br><span class="line">let fs = require(&#x27;fs&#x27;);</span><br><span class="line"></span><br><span class="line">let server = http.createServer((req,res)=&gt;&#123;</span><br><span class="line"></span><br><span class="line">    let userID = parseInt(Math.random()*89999)+10000;</span><br><span class="line">    console.log(userID+&#x27;进入连接...&#x27;)</span><br><span class="line"></span><br><span class="line">    res.writeHead(200, &#123;&#x27;Content-Type&#x27;: &#x27;text/html;charset=utf-8&#x27;,&#x27;Access-Control-Allow-Origin&#x27;:&#x27;*&#x27;&#125;);</span><br><span class="line"></span><br><span class="line">    // 读取文件</span><br><span class="line">    fs.readFile(&#x27;../笔记.txt&#x27;,(error,data)=&gt;&#123;</span><br><span class="line">        console.log(error,data);</span><br><span class="line">        if (error) &#123;</span><br><span class="line">            throw error;</span><br><span class="line">        &#125;</span><br><span class="line">        console.log(userID+&#x27;读取完毕...&#x27;)</span><br><span class="line">        res.end();</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    // 创建文件夹</span><br><span class="line">    fs.mkdir(`./image/$&#123;userID&#125;`);</span><br><span class="line"></span><br><span class="line">    // 读取文件状态</span><br><span class="line">    fs.stat(&#x27;../笔记.txt&#x27;,(error,stats)=&gt;&#123;</span><br><span class="line">        /*</span><br><span class="line">            Stats &#123;</span><br><span class="line">                dev: 580307240,</span><br><span class="line">                mode: 33206,</span><br><span class="line">                nlink: 1,</span><br><span class="line">                uid: 0,</span><br><span class="line">                gid: 0,</span><br><span class="line">                rdev: 0,</span><br><span class="line">                blksize: 4096,</span><br><span class="line">                ino: 10696049115206348,</span><br><span class="line">                size: 7275,   // 文件的大小（以字节为单位）</span><br><span class="line">                blocks: 16,</span><br><span class="line">                atimeMs: 1579832397095.3948, // 表明上次访问此文件的时间戳</span><br><span class="line">                mtimeMs: 1579872595571.8716, // 表明上次修改此文件的时间戳</span><br><span class="line">                ctimeMs: 1579872595571.8716,  // 表明上次更改文件状态的时间戳</span><br><span class="line">                birthtimeMs: 1579832397095.3948, // 表明此文件的创建时间的时间戳</span><br><span class="line">                atime: 2020-01-24T02:19:57.095Z,</span><br><span class="line">                mtime: 2020-01-24T13:29:55.572Z,</span><br><span class="line">                ctime: 2020-01-24T13:29:55.572Z,</span><br><span class="line">                birthtime: 2020-01-24T02:19:57.095Z</span><br><span class="line">            &#125;</span><br><span class="line">        */</span><br><span class="line">        console.log(&#x27;读取文件状态&#x27;,stats);</span><br><span class="line">        console.log(&#x27;是否是文件夹：&#x27;,stats.isDirectory());</span><br><span class="line">        console.log(&#x27;是否是文件：&#x27;,stats.isFile());</span><br><span class="line">        res.end();</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    // 存储所有文件夹名</span><br><span class="line">    let dictionary = [];</span><br><span class="line">    // 查看文件夹中有多少文件</span><br><span class="line">    fs.readdir(&#x27;../node&#x27;,(error,files)=&gt;&#123;</span><br><span class="line">        // 以数组的形式输出node文件夹中所有的文件名</span><br><span class="line">        /*</span><br><span class="line">            [</span><br><span class="line">                &#x27;01_helloWorld.html&#x27;,</span><br><span class="line">                &#x27;01_helloWorld.js&#x27;,</span><br><span class="line">                &#x27;01_helloWorld_circle.html&#x27;,</span><br><span class="line">                &#x27;02_helloWorld.js&#x27;,</span><br><span class="line">                &#x27;02_表单提交.html&#x27;,</span><br><span class="line">                &#x27;03_router.js&#x27;,</span><br><span class="line">                &#x27;04_EventLoop.js&#x27;</span><br><span class="line">            ]</span><br><span class="line">        */</span><br><span class="line">        console.log(&#x27;node文件夹下的文件名：&#x27;,files);</span><br><span class="line">        files.map(item =&gt; &#123;</span><br><span class="line">            fs.stat(`./$&#123;item&#125;`,(error,stats)=&gt;&#123;</span><br><span class="line">                if (stats.isDirectory()) &#123;</span><br><span class="line">                    dictionary.push(item);</span><br><span class="line">                &#125;</span><br><span class="line">                console.log(&#x27;文件夹：&#x27;+dictionary);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">        res.end();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(3000,&#x27;192.168.1.9&#x27;);</span><br><span class="line"></span><br><span class="line">// 实例：获取某个文件夹中所有文件(夹)的名字</span><br><span class="line">let http = require(&#x27;http&#x27;);</span><br><span class="line"></span><br><span class="line">let fs = require(&#x27;fs&#x27;);</span><br><span class="line"></span><br><span class="line">let server = http.createServer((req,res)=&gt;&#123;</span><br><span class="line">    fs.readdir(&#x27;../node&#x27;,(error,files)=&gt;&#123;</span><br><span class="line">        // 存放文件夹的数组</span><br><span class="line">        let dictionary = [];</span><br><span class="line">        (function iterator(i)&#123;</span><br><span class="line">            if (i == files.length) &#123;</span><br><span class="line">                res.end(&#x27;获取目录结束...&#x27;);</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">            fs.stat(`../node/$&#123;files[i]&#125;`,(err,stats)=&gt;&#123;</span><br><span class="line">                if (stats.isDirectory()) &#123;</span><br><span class="line">                    dictionary.push(files[i]);</span><br><span class="line">                    console.log(&#x27;dictionary&#x27;,dictionary)</span><br><span class="line">                &#125;</span><br><span class="line">                iterator(i+1);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)(0)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(3000,&#x27;192.168.1.9&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="6-制作一个静态资源文件管理"><a href="#6-制作一个静态资源文件管理" class="headerlink" title="6.制作一个静态资源文件管理"></a>6.制作一个静态资源文件管理</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">// 意思是：新建一个static文件夹，文件夹下有1.html文件，可以通过http://192.168.1.9:3000/1.html去访问</span><br><span class="line">let http = require(&#x27;http&#x27;);</span><br><span class="line">let url = require(&#x27;url&#x27;);</span><br><span class="line">let fs = require(&#x27;fs&#x27;);</span><br><span class="line">let path = require(&#x27;path&#x27;);</span><br><span class="line"></span><br><span class="line">let server = http.createServer((req,res)=&gt;&#123;</span><br><span class="line">    // 获取路径</span><br><span class="line">    let pathName = url.parse(req.url).pathname;</span><br><span class="line">    if (pathName == &#x27;/&#x27;) &#123;</span><br><span class="line">        pathName = &#x27;index.html&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    // 获取文件拓展名</span><br><span class="line">    let extname = path.extname(pathName);</span><br><span class="line">    console.log(&#x27;获取文件拓展名&#x27;,extname);</span><br><span class="line"></span><br><span class="line">    // 获取文件</span><br><span class="line">    fs.readFile(&#x27;./static/&#x27;+pathName,(error,data)=&gt;&#123;</span><br><span class="line">        if (error) &#123;</span><br><span class="line">            fs.readFile(&#x27;./static/404.html&#x27;,(err,errData)=&gt;&#123;</span><br><span class="line">                console.log(&#x27;errrr&#x27;,err,errData)</span><br><span class="line">                res.writeHead(404,&#123;&#x27;Content-Type&#x27;:&#x27;text/html;charset=UTF8&#x27;&#125;);</span><br><span class="line">                res.end(errData);</span><br><span class="line">            &#125;)</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        res.writeHead(200,&#123;&quot;Content-Type&quot;:getMIME(extname)&#125;)</span><br><span class="line">        res.end(data);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(3000,&#x27;192.168.1.9&#x27;);</span><br><span class="line"></span><br><span class="line">function getMIME(extname)&#123;</span><br><span class="line">    switch(extname)&#123;</span><br><span class="line">        case &quot;.html&quot;:</span><br><span class="line">            return &quot;text/html&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case &quot;.jpg&quot;:</span><br><span class="line">            return &quot;image/jpg&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case &quot;.css&quot;:</span><br><span class="line">            return &quot;text/css&quot;;</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-文件夹模块和-package-文件"><a href="#7-文件夹模块和-package-文件" class="headerlink" title="7.文件夹模块和 package 文件"></a>7.文件夹模块和 package 文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">1)在js文件中引用，如果不写./ ， 会默认查找node_modules文件夹下的文件</span><br><span class="line"></span><br><span class="line">test.js文件</span><br><span class="line">let foo = require(&#x27;foo.js&#x27;);</span><br><span class="line">console.log(foo);</span><br><span class="line"></span><br><span class="line">node_modules文件夹下foo.js文件</span><br><span class="line">let a = 200;</span><br><span class="line">exports.b = b;</span><br><span class="line"></span><br><span class="line">2)在js文件中，如果引用不加扩展名，默认引用文件夹下index.js文件</span><br><span class="line"></span><br><span class="line">test.js文件</span><br><span class="line">let a = &#x27;bar&#x27;;</span><br><span class="line">exports.a = a;</span><br><span class="line"></span><br><span class="line">node_modules文件夹下bar文件夹下的index.js文件</span><br><span class="line">let a = &#x27;bar&#x27;;</span><br><span class="line">exports.a = a;</span><br><span class="line"></span><br><span class="line">问：如果修改bar文件夹下index.js文件夹名为app.js，如何修改才能正常引用？</span><br><span class="line">在bar文件夹下新建文件package.json,</span><br><span class="line">package.json文件</span><br><span class="line">&#123;</span><br><span class="line">    &quot;name&quot;: &quot;app&quot;,</span><br><span class="line">    &quot;version&quot;: &quot;0.0.1&quot;,</span><br><span class="line">    &quot;main&quot;: &quot;app.js&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">3)package.json管理依赖</span><br><span class="line">在根文件夹下执行命令npm init，会生成package.json文件</span><br><span class="line">package.json中：</span><br><span class="line">&quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;moment&quot;: &quot;^2.24.0&quot;   // ^在谁前面就表示谁不变，在这里就表示2的大版本保持不变</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">4)路径注意问题</span><br><span class="line">前提：同级目录下有a.js文件和text文件夹，text文件夹下有b.js和c.js</span><br><span class="line">引用：</span><br><span class="line">    1.a引用b</span><br><span class="line">        let b = require(&#x27;./text/b.js);</span><br><span class="line">    2.b引用c</span><br><span class="line">        let c = require(&#x27;./c.js);</span><br><span class="line">注意：引用都是从当前文件寻找其他文件</span><br><span class="line">问：如果b.js中需要引入像fs等第三方模块读取文件时，如何引用？</span><br><span class="line">    使用绝对路径__dirname：</span><br><span class="line">    fs.readFile(__dirname+&#x27;/1.txt&#x27;,()=&gt;&#123;&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="8-POST-请求"><a href="#8-POST-请求" class="headerlink" title="8.POST 请求"></a>8.POST 请求</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;input id=&#x27;name&#x27; /&gt;</span><br><span class="line">&lt;input id=&#x27;age&#x27; /&gt;</span><br><span class="line">&lt;input id=&#x27;submit&#x27; type=&quot;submit&quot; value=&quot;提交&quot; /&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    document.getElementById(&#x27;submit&#x27;).onclick=()=&gt;&#123;</span><br><span class="line">        let name = document.getElementById(&#x27;name&#x27;).value;</span><br><span class="line">        let age = document.getElementById(&#x27;age&#x27;).value;</span><br><span class="line"></span><br><span class="line">        let xhr = new XMLHttpRequest();</span><br><span class="line">        xhr.open(&#x27;POST&#x27;,&#x27;http://192.168.1.9:3000&#x27;);</span><br><span class="line">        xhr.addEventListener(&#x27;load&#x27;,function()&#123;</span><br><span class="line">            console.log(this.response);</span><br><span class="line">        &#125;)</span><br><span class="line">        let obj = &#123;</span><br><span class="line">            name,</span><br><span class="line">            age</span><br><span class="line">        &#125;;</span><br><span class="line">        xhr.send(JSON.stringify(obj));</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">let http = require(&#x27;http&#x27;);</span><br><span class="line">let server = http.createServer((req,res)=&gt;&#123;</span><br><span class="line">    if (req.method == &quot;POST&quot;) &#123;</span><br><span class="line">        let allData = &#x27;&#x27;;</span><br><span class="line">        req.on(&#x27;data&#x27;,(chunk)=&gt;&#123;</span><br><span class="line">            allData += chunk;</span><br><span class="line">        &#125;)</span><br><span class="line">        req.on(&#x27;end&#x27;,()=&gt;&#123;</span><br><span class="line">            res.writeHead(200,&#123;&#x27;Content-Type&#x27;:&#x27;text/html&#x27;,&#x27;Access-Control-Allow-Origin&#x27;:&#x27;*&#x27;&#125;);</span><br><span class="line">            res.end(allData);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(3000,&#x27;192.168.1.9&#x27;);</span><br><span class="line"></span><br><span class="line">例：实现上传图片</span><br><span class="line">前提：npm install formidable</span><br><span class="line"></span><br><span class="line">&lt;form action=&quot;http://192.168.1.9:3000&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; name=&#x27;descript&#x27; /&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot; /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">let http = require(&#x27;http&#x27;);</span><br><span class="line">let formidable = require(&#x27;formidable&#x27;);</span><br><span class="line">let fs = require(&#x27;fs&#x27;);</span><br><span class="line">let path = require(&#x27;path&#x27;);</span><br><span class="line">let server = http.createServer((req,res)=&gt;&#123;</span><br><span class="line">    if (req.method == &quot;POST&quot;) &#123;</span><br><span class="line">        let form = new formidable.IncomingForm();</span><br><span class="line">        // 设置文件上传存储地址</span><br><span class="line">        form.uploadDir = &#x27;./upLoads&#x27;;</span><br><span class="line">        // 所有的文本域、单选框等都存放在fields中；所有的文件域都存放在files中</span><br><span class="line">        form.parse(req,(err,fields,files)=&gt;&#123;</span><br><span class="line">            // 修改文件名</span><br><span class="line">            let oldPath = __dirname + &quot;/&quot; + files.file.path;</span><br><span class="line">            let newPath = __dirname + &quot;/upLoads&quot; + &quot;/&quot; + fields.descript + path.extname(files.file.name);</span><br><span class="line">            console.log(&#x27;修改文件名&#x27;,oldPath,newPath);</span><br><span class="line">            fs.rename(oldPath,newPath,(error)=&gt;&#123;</span><br><span class="line">                if (error) &#123;</span><br><span class="line">                    throw Error(&#x27;改名失败！&#x27;);</span><br><span class="line">                &#125;</span><br><span class="line">                res.writeHead(200,&#123;&quot;Content-Type&quot;:&quot;text/plain;charset=utf-8&quot;&#125;);</span><br><span class="line">                res.end(&#x27;上传成功&#x27;);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(3000,&#x27;192.168.1.9&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="9-模板引擎"><a href="#9-模板引擎" class="headerlink" title="9.模板引擎"></a>9.模板引擎</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">1)ejs模板引擎:是一种后端模板引擎</span><br><span class="line"></span><br><span class="line">let ejs = require(&#x27;ejs&#x27;);</span><br><span class="line"></span><br><span class="line">let str = &#x27;今天买了&lt;%= a %&gt;s&#x27;;</span><br><span class="line">let data = &#123;</span><br><span class="line">    a:6,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let html = ejs.render(str,data)</span><br><span class="line">console.log(html);  // 今天买了6s</span><br><span class="line"></span><br><span class="line">问：如何读取ejs页面？</span><br><span class="line"></span><br><span class="line">index.ejs</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;今天买了&lt;%= a %&gt;s&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">let ejs = require(&#x27;ejs&#x27;);</span><br><span class="line">let fs = require(&#x27;fs&#x27;);</span><br><span class="line">let http = require(&#x27;http&#x27;);</span><br><span class="line"></span><br><span class="line">let server = http.createServer((req,res)=&gt;&#123;</span><br><span class="line">    fs.readFile(&quot;./views/ejs01.ejs&quot;,(err,data)=&gt;&#123;</span><br><span class="line">        let template = data.toString();</span><br><span class="line">        let obj = &#123; a: 6&#125;;</span><br><span class="line"></span><br><span class="line">        let html = ejs.render(template,obj);</span><br><span class="line"></span><br><span class="line">        res.writeHead(200,&#123;&#x27;Content-Type&#x27;:&#x27;text/html;charset=utf-8&#x27;,&#x27;Access-Control-Allow-Origin&#x27;:&#x27;*&#x27;&#125;);</span><br><span class="line">        res.end(html);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(8000,&#x27;127.0.0.1&#x27;);</span><br><span class="line"></span><br><span class="line">2)Jade模板引擎：也是一种后端模板引擎，省略了html标签</span><br></pre></td></tr></table></figure>

<h2 id="10-Express-框架"><a href="#10-Express-框架" class="headerlink" title="10.Express 框架"></a>10.Express 框架</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line">Express是后端Node的框架。</span><br><span class="line">前提：npm install express</span><br><span class="line">1)初识Express</span><br><span class="line">let express = require(&#x27;express&#x27;);</span><br><span class="line"></span><br><span class="line">let app = express();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// express路由能力</span><br><span class="line">app.get(&quot;/index&quot;,(req,res)=&gt;&#123;</span><br><span class="line">    res.send(&#x27;首页&#x27;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.get(&quot;/my&quot;,(req,res)=&gt;&#123;</span><br><span class="line">    res.send(&#x27;我的&#x27;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.get(/\/student\/([\d]&#123;5&#125;)/,(req,res)=&gt;&#123;</span><br><span class="line">    res.send(&quot;学生信息，学号：&quot;+req.params[0]);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.get(&quot;/teacher/:teacherID&quot;,(req,res)=&gt;&#123;</span><br><span class="line">    res.send(&quot;老师信息，工号：&quot;+req.params.teacherID);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// express引用静态文件能力(即以前放入Apache中的包)</span><br><span class="line">app.use(express.static(&#x27;./static&#x27;));</span><br><span class="line"></span><br><span class="line">// express引用模板引擎能力</span><br><span class="line">app.set(&#x27;view engine&#x27;,&#x27;ejs&#x27;);</span><br><span class="line">app.get(&#x27;/view&#x27;,(req,res)=&gt;&#123;</span><br><span class="line">    res.render(&#x27;ejs01&#x27;,&#123;</span><br><span class="line">        a: 11,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(3000);</span><br><span class="line"></span><br><span class="line">2)如果想要处理任何类型的请求(get,post)就使用app.all</span><br><span class="line">app.all(&quot;/&quot;,(req,res)=&gt;&#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">3)Restful路由设计：简单来说，就是同一个路由路径，根据不同的请求类型，展现出不同的功能</span><br><span class="line"></span><br><span class="line">4)中间件</span><br><span class="line">如果GET、POST请求的回调函数中，没有next参数，那么就会匹配第一个路由，不会继续往下匹配；如果想要继续往下匹配，就需要next()</span><br><span class="line"></span><br><span class="line">let express = require(&#x27;express&#x27;);</span><br><span class="line"></span><br><span class="line">let app = express();</span><br><span class="line"></span><br><span class="line">app.get(&#x27;/&#x27;,(req,res,next)=&gt;&#123;</span><br><span class="line">    console.log(&#x27;1&#x27;);</span><br><span class="line">    next();</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.get(&#x27;/&#x27;,(req,res)=&gt;&#123;</span><br><span class="line">    console.log(&#x27;2&#x27;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(3000);</span><br><span class="line"></span><br><span class="line">1)app.use()是一个中间件，这与get/post不同的是，app.use()的网址不是精确匹配的，是可以扩展的</span><br><span class="line">let express = require(&#x27;express&#x27;);</span><br><span class="line"></span><br><span class="line">let app = express();</span><br><span class="line"></span><br><span class="line">app.use(&quot;/admin&quot;,(req,res)=&gt;&#123;</span><br><span class="line">    // 当用户输入 http://127.0.0.1:3000/admin/userinfo/001</span><br><span class="line">    console.log(req.originalUrl);  // 用户输入访问的网址  /admin/userinfo/001</span><br><span class="line">    console.log(req.baseUrl);      // use中的第一个参数   /admin</span><br><span class="line">    console.log(req.path);         // 用户网址减去use中的第一个参数  /userinfo/001</span><br><span class="line">    res.end();</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(3000);</span><br><span class="line"></span><br><span class="line">2)当app.use不写路径时，实际上是相当于&quot;/&quot;，代表所有网址</span><br><span class="line">app.use((req,res,next)=&gt;&#123;</span><br><span class="line">    next();</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">3)静态服务</span><br><span class="line">let express = require(&#x27;express&#x27;);</span><br><span class="line"></span><br><span class="line">let app = express();</span><br><span class="line"></span><br><span class="line">// 当用户访问http://127.0.0.1:3000/static/即可访问static文件夹下文件</span><br><span class="line">app.use(&#x27;/static&#x27;,express.static(&#x27;./static&#x27;));</span><br><span class="line"></span><br><span class="line">// use函数会自动识别err这个参数，如果有就能自动捕获</span><br><span class="line">app.use((req, res)=&gt;&#123;</span><br><span class="line">    res.send(&#x27;不存在这个页面！&#x27;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(3000);</span><br><span class="line"></span><br><span class="line">4)render()和send()</span><br><span class="line">①大多数情况下，渲染内容用res.render()，将会根据views中的模板文件进行渲染。如果渲染不想使用views文件夹，可以：</span><br><span class="line">    app.set(&#x27;views&#x27;,__dirname+&#x27;/Views2&#x27;);</span><br><span class="line">②如果想写一个快速测试页，当然可是使用res.render()。这个函数将根据内容，自动帮我们设置了Content-Type头部和200状态码</span><br><span class="line">③如果想要使用不同的状态码，可以：</span><br><span class="line">    res.status(400).render(&#x27;we connot find it&#x27;)</span><br><span class="line">④如果想要设置不同的Content-Type，可以：</span><br><span class="line">    res.set(&#x27;Content-Type&#x27;,&#x27;text-html&#x27;);</span><br><span class="line"></span><br><span class="line">5)express的GET和POST请求</span><br><span class="line">①GET请求</span><br><span class="line">let express = require(&#x27;express&#x27;);</span><br><span class="line"></span><br><span class="line">let app = express();</span><br><span class="line"></span><br><span class="line">app.get(&#x27;/&#x27;,(req,res)=&gt;&#123;</span><br><span class="line">    // 获取参数</span><br><span class="line">    // 当访问http://127.0.0.1:3000/?name=wq&amp;id=1270837469</span><br><span class="line">    console.log(req.query); // &#123; name: &#x27;wq&#x27;, id: &#x27;1270837469&#x27; &#125;</span><br><span class="line">    res.send();</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(3000);</span><br><span class="line">②POST请求</span><br><span class="line"></span><br><span class="line">前提：npm install body-parser</span><br><span class="line">let bodyParser = require(&#x27;body-parser&#x27;);</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;extended:false&#125;));</span><br><span class="line">app.post(&#x27;/&#x27;,(req,res)=&gt;&#123;</span><br><span class="line">    res.send(JSON.stringify(req.body));</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="11-NoSQL"><a href="#11-NoSQL" class="headerlink" title="11.NoSQL"></a>11.NoSQL</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">定义：非结构性数据库，没有行和列的概念，用JSON来存储数据，代替了老牌数据库表和行的概念，分别使用集合和文档。</span><br><span class="line"></span><br><span class="line">mongodb的一些命令：</span><br><span class="line">    mongo：使用数据库</span><br><span class="line">    mongod：开机</span><br><span class="line">    mongoimport：导入数据</span><br><span class="line"></span><br><span class="line">启动mongodb：</span><br><span class="line">    新建一个文件夹我的目录是：F:\mongo</span><br><span class="line">    打开cmd，执行 mongod --dbpath F:\mongo</span><br><span class="line">    新打开一个cmd，执行 mongo</span><br><span class="line"></span><br><span class="line">mongodb命令：</span><br><span class="line">    show dbs：展示当前所有数据库</span><br><span class="line">    use 数据库名：使用指定数据库；或者新建数据库</span><br><span class="line">    db：查看当前所在数据库</span><br><span class="line">    插入数据：</span><br><span class="line">        db.数据库名.insert(&#123;&quot;name&quot;:&quot;wq&quot;&#125;)</span><br><span class="line">    查看当前数据库集合：</span><br><span class="line">        show collections</span><br><span class="line">    查看当前集合中的文档：</span><br><span class="line">        db.数据库名.find()</span><br><span class="line">    查询name字段为&#x27;wq&#x27;的文档：</span><br><span class="line">        db.数据库名.find(&#123;&quot;name&quot;:&quot;wq&quot;&#125;)</span><br><span class="line">    删除数据库：(当前所在的数据库)</span><br><span class="line">        db.dropDatabase()</span><br><span class="line">    导入数据库：</span><br><span class="line">        mongoimport --db 数据库名 --collection 集合名 --drop --file 文件路径</span><br><span class="line">            注意： --drop 代表删除之前集合中存在的数据</span><br><span class="line">查询：</span><br><span class="line">    数据结构：</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;name&quot;:&quot;wq&quot;,</span><br><span class="line">            &quot;age&quot;:23,</span><br><span class="line">            &quot;hobby&quot;:[&quot;sleep&quot;,&quot;eat&quot;],</span><br><span class="line">            &quot;score&quot;:&#123;</span><br><span class="line">                &quot;yuwen&quot;:89,</span><br><span class="line">                &quot;shuxue&quot;:100</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;points&quot;: [</span><br><span class="line">                &#123; &quot;points&quot;: 78, &quot;bonus&quot;: 8 &#125;,</span><br><span class="line">                &#123; &quot;points&quot;: 57, &quot;bonus&quot;: 7 &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">1)查询数学成绩为100的学生</span><br><span class="line">     db.student.find(&#123;&quot;score.shuxue&quot;:100&#125;)</span><br><span class="line">2)查询年龄为23并且数学成绩为100的学生</span><br><span class="line">     db.student.find(&#123;&quot;score.shuxue&quot;:100,&quot;age&quot;:23&#125;)</span><br><span class="line">3)查询语文成绩大于70分的学生($gt)</span><br><span class="line">    db.student.find(&#123;&quot;score.yuwen&quot;:&#123;$gt:70&#125;&#125;)</span><br><span class="line">4)查询语文成绩小于70分的学生($lt)</span><br><span class="line">    db.student.find(&#123;&quot;score.yuwen&quot;:&#123;$lt:70&#125;&#125;)</span><br><span class="line">4)查询语文成绩小于70或者年龄小于20岁的学生</span><br><span class="line">    db.student.find(&#123;$or:[&#123;&quot;score.yuwen&quot;:&#123;$lt:70&#125;&#125;,&#123;&quot;age&quot;:&#123;$lt:20&#125;&#125;]&#125;)</span><br><span class="line">5)查询年龄大于15岁的学生并且按照语文成绩升序排列(1代表升序，-1代表降序)，如果有两个参数，则先按前者排序，后按后者排序</span><br><span class="line">    db.student.find(&#123;&quot;age&quot;:&#123;$gt:15&#125;&#125;).sort(&#123;&quot;age&quot;:1&#125;)</span><br><span class="line">6)查询爱好为睡觉的学生</span><br><span class="line">    db.student.find(&#123;&quot;hobby&quot;:&quot;sleep&quot;&#125;)</span><br><span class="line">7)查询第二个爱好为eat的学生</span><br><span class="line">    db.student.find(&#123;&quot;hobby.1&quot;:&quot;eat&quot;&#125;)</span><br><span class="line">8)查询bonus大于7的学生</span><br><span class="line">    db.student.find(&#123;&quot;points&quot;:&#123;$elemMatch:&#123;&quot;bonus&quot;:&#123;$gt:7&#125;&#125;&#125;&#125;)</span><br><span class="line">9)查询hobby为eat和sleep的学生</span><br><span class="line">    db.student.find(&#123;&quot;hobby&quot;:&#123;$all:[&quot;eat&quot;,&quot;sleep&quot;]&#125;&#125;)</span><br><span class="line">10)查询爱好为2个的学生</span><br><span class="line">    db.student.find(&#123;&quot;hobby&quot;:&#123;$size:2&#125;&#125;)</span><br><span class="line"></span><br><span class="line">删除</span><br><span class="line">    1)删除集合</span><br><span class="line">        db.集合名.drop()</span><br><span class="line">    2)删除集合中名字为wq的学生</span><br><span class="line">        db.student.remove(&#123;&quot;name&quot;:&quot;wq&quot;&#125;)</span><br><span class="line">        注意：只删除一个添加&#123;justOne:true&#125;</span><br><span class="line">            db.student.remove(&#123;&quot;name&quot;:&quot;wq&quot;&#125;,&#123;justOne:true&#125;)</span><br><span class="line">修改</span><br><span class="line">    1)修改名字为wq2的学生年龄为21</span><br><span class="line">        db.student.update(&#123;&quot;name&quot;:&quot;wq2&quot;&#125;,&#123;$set:&#123;&quot;age&quot;:21&#125;&#125;)</span><br><span class="line">    2)修改名字满足wq\d&#123;1,&#125;所有学生的年龄为33</span><br><span class="line">        db.student.updateMany(&#123;&quot;name&quot;:/wq\d&#123;1,&#125;/&#125;,&#123;$set:&#123;&quot;age&quot;:33&#125;&#125;)</span><br><span class="line">    3)完全替换名字为wq2</span><br><span class="line">        db.student.update(&#123;&quot;name&quot;:&quot;wq2&quot;&#125;,&#123;&quot;name&quot;:&quot;wq2&quot;,&quot;age&quot;:1&#125;)</span><br><span class="line">    4)添加points</span><br><span class="line">        db.students.update(&#123;&quot;name&quot;:&quot;wq&quot;&#125;,&#123;$addToSet:&#123;&quot;points&quot;:&#123; &quot;points&quot;: 58, &quot;bonus&quot;: 7 &#125;&#125;&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="12-Nodejs-连接-Mongodb-数据库"><a href="#12-Nodejs-连接-Mongodb-数据库" class="headerlink" title="12.Nodejs 连接 Mongodb 数据库"></a>12.Nodejs 连接 Mongodb 数据库</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">let express = require(&#x27;express&#x27;);</span><br><span class="line"></span><br><span class="line">let app = express();</span><br><span class="line"></span><br><span class="line">let MongoClient = require(&#x27;mongodb&#x27;).MongoClient;</span><br><span class="line"></span><br><span class="line">app.get(&#x27;/&#x27;,(req,res)=&gt;&#123;</span><br><span class="line">    // itcase代表数据库</span><br><span class="line">    let url = &quot;mongodb://127.0.0.1:27017/itcase&quot;;</span><br><span class="line">    MongoClient.connect(url,(err,client)=&gt;&#123;</span><br><span class="line">        if (err) &#123;</span><br><span class="line">            console.log(&#x27;数据库连接失败！&#x27;)</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        console.log(&#x27;数据库连接成功！&#x27;)</span><br><span class="line">        let db = client.db(&quot;itcase&quot;);</span><br><span class="line">        db.collection(&#x27;student&#x27;).insertOne(&#123;</span><br><span class="line">            &quot;name&quot;:&quot;wcc&quot;,</span><br><span class="line">            &quot;age&quot;:30</span><br><span class="line">        &#125;,(error,result)=&gt;&#123;</span><br><span class="line">            if (error) &#123;</span><br><span class="line">                console.log(&#x27;数据插入失败！&#x27;)</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">            console.log(&#x27;result&#x27;,result);</span><br><span class="line">            res.send();</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(3000);</span><br></pre></td></tr></table></figure>

<h2 id="13-nodejs-操作-mongodb-增删改查"><a href="#13-nodejs-操作-mongodb-增删改查" class="headerlink" title="13.nodejs 操作 mongodb(增删改查)"></a>13.nodejs 操作 mongodb(增删改查)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">let MongoClient = require(&#x27;mongodb&#x27;).MongoClient;</span><br><span class="line"></span><br><span class="line">// 连接数据库</span><br><span class="line">function connectMongodb(dbName,callback)&#123;</span><br><span class="line">    let url = `mongodb://127.0.0.1:27017/$&#123;dbName&#125;`;</span><br><span class="line">    MongoClient.connect(url,callback)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 插入数据</span><br><span class="line">exports.insertOne = (dbName,collectionName,data,callback) =&gt; &#123;</span><br><span class="line">    connectMongodb(dbName,(err,client)=&gt;&#123;</span><br><span class="line">        if (err) &#123;</span><br><span class="line">            console.log(&#x27;数据库连接失败！&#x27;)</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        let db = client.db(dbName);</span><br><span class="line">        db.collection(collectionName).insertOne(data,callback);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 查询数据</span><br><span class="line">exports.find = (dbName,collectionName,condition,pageSize,pageNo,callback) =&gt;&#123;</span><br><span class="line">    connectMongodb(dbName,(err,client)=&gt;&#123;</span><br><span class="line">        let db = client.db(dbName);</span><br><span class="line">        let cursor = db.collection(collectionName).find(condition).limit(pageSize).skip((pageNo-1)*pageSize);</span><br><span class="line">        let result = [];</span><br><span class="line">        cursor.each((error,doc)=&gt;&#123;</span><br><span class="line">            if (doc!=null) &#123;</span><br><span class="line">                result.push(doc);</span><br><span class="line">            &#125;else &#123;</span><br><span class="line">                callback(null,result);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 删除数据</span><br><span class="line">exports.delete = (dbName,collectionName,condition,callback)=&gt;&#123;</span><br><span class="line">    connectMongodb(dbName,(err,client)=&gt;&#123;</span><br><span class="line">        let db = client.db(dbName);</span><br><span class="line">        db.collection(collectionName).deleteMany(condition,(error,result)=&gt;&#123;</span><br><span class="line">            if(error)&#123;</span><br><span class="line">                callback(&#x27;删除失败！&#x27;,null);</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">            callback(null,result);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 修改数据</span><br><span class="line">exports.update = (dbName,collectionName,searchCondition,updateData,callback)=&gt;&#123;</span><br><span class="line">    connectMongodb(dbName,(err,client)=&gt;&#123;</span><br><span class="line">        let db = client.db(dbName);</span><br><span class="line">        db.collection(collectionName).updateOne(searchCondition,&#123;$set:updateData&#125;,(error,result)=&gt;&#123;</span><br><span class="line">            if(error)&#123;</span><br><span class="line">                callback(&#x27;修改失败！&#x27;,null);</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">            callback(null,result);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="13-Cookie-和-Session"><a href="#13-Cookie-和-Session" class="headerlink" title="13.Cookie 和 Session"></a>13.Cookie 和 Session</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">Cookie:</span><br><span class="line">    1)Http是无状态协议，简单的说，当你浏览一个页面，然后转到同一个网站的另一个页面，服务器无法认识到这是同一个浏览器在访问同一个网站。每一次访问都是没有关系的。</span><br><span class="line">    2)Cookie是一个简单到爆的想法：当访问一个页面的时候，服务器在下行Http报文中，命令浏览器存储一个字符串；当浏览器再次访问同一个域的时候，将把这个字符串携带到</span><br><span class="line">      上行Http请求中。</span><br><span class="line">    特点：</span><br><span class="line">        1)Cookie不加密，用户可以自由看到</span><br><span class="line">        2)用户可以删除Cookie或者禁用它</span><br><span class="line">        3)Cookie可以被篡改</span><br><span class="line">        4)Cookie可以用于攻击</span><br><span class="line">        5)Cookie的存储量小</span><br><span class="line"></span><br><span class="line">node中的Cookie:</span><br><span class="line">    前提：npm install cookie-parser</span><br><span class="line">    例子：</span><br><span class="line">        let express = require(&#x27;express&#x27;);</span><br><span class="line">        let cookieParser = require(&#x27;cookie-parser&#x27;);</span><br><span class="line">        let app = express();</span><br><span class="line">        app.use(cookieParser());</span><br><span class="line"></span><br><span class="line">        app.get(&#x27;/&#x27;,(req,res)=&gt;&#123;</span><br><span class="line">            console.log(&#x27;请求Cookie&#x27;,req.cookies)</span><br><span class="line">            // maxAge：Cookie的有效期</span><br><span class="line">            res.cookie(&#x27;name&#x27;,&#x27;wq&#x27;,&#123;maxAge:24*60*60*1000&#125;);</span><br><span class="line">            res.send();</span><br><span class="line">        &#125;)</span><br><span class="line">        app.listen(3000);</span><br><span class="line"></span><br><span class="line">Session：</span><br><span class="line">    Session不是一开始就有的技术，而是依赖Cookie。当浏览器禁用cookie或者用户清除cookie的时候登录效果就消失了。</span><br><span class="line">    Session下发的乱码是乱码，并且服务器自己缓存一些东西，下次服务器带着乱码请求，与缓存比对，就知道请求用户是谁了。</span><br><span class="line"></span><br><span class="line">node中的Session：</span><br><span class="line">    前提：npm install express-session</span><br><span class="line">    let express = require(&#x27;express&#x27;);</span><br><span class="line">    let app = express();</span><br><span class="line"></span><br><span class="line">    let session = require(&#x27;express-session&#x27;);</span><br><span class="line"></span><br><span class="line">    app.use(session(&#123;</span><br><span class="line">        secret:&#x27;wq&#x27;,</span><br><span class="line">        resave:false,</span><br><span class="line">        saveUninitialized:true</span><br><span class="line">    &#125;))</span><br><span class="line"></span><br><span class="line">    app.get(&#x27;/&#x27;,(req,res)=&gt;&#123;</span><br><span class="line">        if (req.session.userInfo) &#123;</span><br><span class="line">            res.send(&#x27;欢迎您,&#x27;+req.session.userInfo);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        res.send(&#x27;您未登录，请先登录！！&#x27;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    app.get(&#x27;/login&#x27;,(req,res)=&gt;&#123;</span><br><span class="line">        req.session.userInfo = &#x27;王清&#x27;;  // 设置Session</span><br><span class="line">        res.send(&#x27;您已成功登录！&#x27;);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    app.listen(3000);</span><br></pre></td></tr></table></figure>

<h2 id="14-MD5-加密"><a href="#14-MD5-加密" class="headerlink" title="14.MD5 加密"></a>14.MD5 加密</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">    MD5加密是函数型加密，就是每次加密的结果是一样的，没有随机位。</span><br><span class="line">    特点：</span><br><span class="line">    1)无论需要加密的文字多长多短，永远是32位。</span><br><span class="line">    2)哪怕只改一个字，密文都会大变。</span><br><span class="line"></span><br><span class="line">node中的加密：</span><br><span class="line">    前提：npm install crypto</span><br><span class="line">    let express = require(&#x27;express&#x27;);</span><br><span class="line">    let app = express();</span><br><span class="line">    let crypto = require(&#x27;crypto&#x27;);</span><br><span class="line"></span><br><span class="line">    app.get(&#x27;/&#x27;,(req,res)=&gt;&#123;</span><br><span class="line">        // 选择加密方式，一般有：sha1,md5,sha256,sha512</span><br><span class="line">        let md5 = crypto.createHash(&#x27;md5&#x27;);</span><br><span class="line">        let password = md5.update(&#x27;wq&#x27;).digest(&#x27;base64&#x27;);</span><br><span class="line">        res.send(&quot;加密之后的密码：&quot;+password);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    app.listen(3000);</span><br></pre></td></tr></table></figure>

<h2 id="16-Mongoose"><a href="#16-Mongoose" class="headerlink" title="16.Mongoose"></a>16.Mongoose</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">简介：是一个将JavaScript对象与数据库产生联系的框架。Object Related Model(ORM:对象关系模型)。操作对象就是操作数据库</span><br><span class="line">   前提：npm install mongoose</span><br><span class="line">   例子demo：</span><br><span class="line">       let mongoose = require(&#x27;mongoose&#x27;);</span><br><span class="line">       // 连接数据库</span><br><span class="line">       mongoose.connect(&#x27;mongodb://127.0.0.1/animals&#x27;);</span><br><span class="line"></span><br><span class="line">       // 创建模型：相当于创建了一个类，每个Cat实例都有name和age属性，在mongo中相当于文档</span><br><span class="line">       let Cat = mongoose.model(&#x27;cat&#x27;,&#123;name:String,age:Number&#125;);</span><br><span class="line"></span><br><span class="line">       // 实例化</span><br><span class="line">       let Ketty = new Cat(&#123;name:&#x27;Ketty&#x27;,age:12&#125;);</span><br><span class="line"></span><br><span class="line">       // 保存到数据库</span><br><span class="line">       Ketty.save((err,result)=&gt;&#123;</span><br><span class="line">           console.log(err,result);</span><br><span class="line">       &#125;)</span><br><span class="line">   封装增删改查：</span><br><span class="line">       前提：在同一目录下新建models文件夹和app.js文件，models文件夹下新建db.js和student.js;</span><br><span class="line">       代码：</span><br><span class="line">           app.js：</span><br><span class="line">               let db = require(&#x27;./models/db&#x27;);</span><br><span class="line"></span><br><span class="line">               let Student = require(&#x27;./models/student&#x27;);</span><br><span class="line"></span><br><span class="line">               // 添加方法一：</span><br><span class="line">               let xiaoming = new Student(&#123;name:&#x27;小明&#x27;,age:18&#125;)</span><br><span class="line">               xiaoming.save(()=&gt;&#123;console.log(&#x27;添加小明成功！&#x27;)&#125;)</span><br><span class="line"></span><br><span class="line">               // 添加方法二：</span><br><span class="line">               Student.create(&#123;name:&#x27;小红&#x27;,age:20,sex:&#x27;女&#x27;&#125;,()=&gt;&#123;console.log(&#x27;添加小红成功！&#x27;)&#125;);</span><br><span class="line"></span><br><span class="line">               // 查找方法一：利用自定义的静态方法查找</span><br><span class="line">               Student.findByName(&#x27;小红&#x27;,(err,result)=&gt;&#123;console.log(result)&#125;)</span><br><span class="line"></span><br><span class="line">               // 查找方法二：</span><br><span class="line">               Student.find(&#123;name:&#x27;小红&#x27;&#125;,(err,result)=&gt;&#123;console.log(result)&#125;);</span><br><span class="line"></span><br><span class="line">               // 修改小红年龄为30岁:这里可以不用添加$set为&#123;$set:&#123;age:30&#125;&#125;</span><br><span class="line">               Student.updateOne(&#123;name:&#x27;小红&#x27;&#125;,&#123;age:30&#125;,(err,result)=&gt;&#123;console.log(result)&#125;)</span><br><span class="line"></span><br><span class="line">			// 修改方法二:</span><br><span class="line">               Student.find(&#123;name:&#x27;小红&#x27;&#125;,(err,result)=&gt;&#123;</span><br><span class="line">                   let xiaohong = result[0];</span><br><span class="line">                   xiaohong.age=30;</span><br><span class="line">                   xiaohong.save();</span><br><span class="line">               &#125;);</span><br><span class="line"></span><br><span class="line">               // 删除小红</span><br><span class="line">               Student.deleteOne(&#123;name:&#x27;小红&#x27;&#125;,(err,result)=&gt;&#123;console.log(result)&#125;)</span><br><span class="line"></span><br><span class="line">               // 使用实例方法</span><br><span class="line">			let xiaoqiang = new Student(&#123;name:&#x27;小强&#x27;,age:22&#125;);</span><br><span class="line">			xiaoqiang.console();</span><br><span class="line">           db.js：</span><br><span class="line">               let mongoose = require(&#x27;mongoose&#x27;);</span><br><span class="line"></span><br><span class="line">               // 创建连接，给每个用户都会创建一个连接</span><br><span class="line">               let db = mongoose.createConnection(&#x27;mongodb://127.0.0.1:27017/school&#x27;)</span><br><span class="line"></span><br><span class="line">               db.once(&#x27;open&#x27;,()=&gt;&#123;</span><br><span class="line">                   console.log(&#x27;数据库连接成功！&#x27;);</span><br><span class="line">               &#125;)</span><br><span class="line"></span><br><span class="line">               module.exports = db;</span><br><span class="line">           student.js:</span><br><span class="line">               let mongoose = require(&#x27;mongoose&#x27;);</span><br><span class="line">               let db = require(&#x27;./db&#x27;);</span><br><span class="line"></span><br><span class="line">               let studentSchema = new mongoose.Schema(&#123;</span><br><span class="line">                   name  : &#123;type:String&#125;,</span><br><span class="line">                   age   : &#123;type:Number&#125;,</span><br><span class="line">                   sex   : &#123;type:String,default:&#x27;男&#x27;&#125;</span><br><span class="line">               &#125;)</span><br><span class="line"></span><br><span class="line">               // 创建查询静态方法</span><br><span class="line">               studentSchema.statics.findByName = (name,callback) =&gt; &#123;</span><br><span class="line">                   db.model(&#x27;student&#x27;).find(&#123;name&#125;,callback);</span><br><span class="line">               &#125;</span><br><span class="line"></span><br><span class="line">               /**</span><br><span class="line">               * 创建更改静态方法</span><br><span class="line">               * conditions：修改条件</span><br><span class="line">               * data：改成data</span><br><span class="line">               * options:可选参数，它有如下属性</span><br><span class="line">               *      safe ：（布尔型）安全模式（默认为架构中设置的值（true））</span><br><span class="line">                       upsert ：（boolean）如果不匹配，是否创建文档（false）</span><br><span class="line">                       multi ：（boolean）是否应该更新多个文档（false）</span><br><span class="line">                       runValidators：如果为true，则在此命令上运行更新验证程序。更新验证器根据模型的模式验证更新操作。</span><br><span class="line">                       strict：（布尔）覆盖strict此更新的选项</span><br><span class="line">                       overwrite： （布尔）禁用只更新模式，允许您覆盖文档（false）</span><br><span class="line">               */</span><br><span class="line">               studentSchema.statics.update = (conditions,data,options,callback) =&gt; &#123;</span><br><span class="line">                   db.model(&#x27;student&#x27;).update(conditions,&#123;$set:data&#125;,options,callback);</span><br><span class="line">               &#125;</span><br><span class="line"></span><br><span class="line">			// 定义实例方法</span><br><span class="line">			studentSchema.methods.console = ()=&gt;&#123;</span><br><span class="line">			    console.log(&#x27;这是实例方法&#x27;)</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">               let studentModel = db.model(&#x27;student&#x27;,studentSchema);</span><br><span class="line"></span><br><span class="line">               module.exports = studentModel;</span><br></pre></td></tr></table></figure>

<h2 id="17-WebSocket-和-Socket-IO-框架"><a href="#17-WebSocket-和-Socket-IO-框架" class="headerlink" title="17.WebSocket 和 Socket.IO 框架"></a>17.WebSocket 和 Socket.IO 框架</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">WebSocket允许客户端和服务器以全双工的方式进行通信；WebSocket的原理：利用HTTP请求产生握手之后，二者转用TCP协议进行交流(QQ协议)</span><br><span class="line"></span><br><span class="line">方法一：利用socket.io模块</span><br><span class="line">前提：npm install socket.io</span><br><span class="line">模拟websocket：</span><br><span class="line">    前端代码studyWebsocket.html:</span><br><span class="line">        &lt;h1&gt;模拟websocket&lt;/h1&gt;</span><br><span class="line">        &lt;input id=&#x27;content&#x27; /&gt;&lt;button id=&#x27;send&#x27;&gt;发送&lt;/button&gt;</span><br><span class="line">        &lt;script src=&quot;https://cdn.bootcss.com/socket.io/2.2.0/socket.io.dev.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">        &lt;script&gt;</span><br><span class="line">            var socket = io.connect(&#x27;http://127.0.0.1:3000&#x27;);</span><br><span class="line">            document.getElementById(&#x27;send&#x27;).onclick = ()=&gt;&#123;</span><br><span class="line">                socket.emit(&#x27;question&#x27;,document.getElementById(&#x27;content&#x27;).value);</span><br><span class="line">            &#125;</span><br><span class="line">            socket.on(&#x27;answer&#x27;,data=&gt;console.log(data));</span><br><span class="line">        &lt;/script&gt;</span><br><span class="line">    Node代码：</span><br><span class="line">    	(</span><br><span class="line">			如果使用express框架：</span><br><span class="line">				const express = require(&#x27;express&#x27;);</span><br><span class="line">				const app = express();</span><br><span class="line">				let server = require(&#x27;http&#x27;).createServer(app);</span><br><span class="line">				let io = require(&#x27;socket.io&#x27;)(server);</span><br><span class="line">		)</span><br><span class="line">        let http = require(&#x27;http&#x27;);</span><br><span class="line">        let fs = require(&#x27;fs&#x27;);</span><br><span class="line"></span><br><span class="line">        let server = http.createServer((req,res)=&gt;&#123;</span><br><span class="line">            if (req.url == &#x27;/&#x27;) &#123;</span><br><span class="line">                fs.readFile(&#x27;./studyWebsocket.html&#x27;,(err,data)=&gt;&#123;</span><br><span class="line">                    res.end(data);</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        let io = require(&#x27;socket.io&#x27;)(server);</span><br><span class="line"></span><br><span class="line">        // 监听连接事件</span><br><span class="line">        // 对于前端和后端的socket对象，都有emit和on方法，emit发送请求，on接受请求</span><br><span class="line">        io.on(&#x27;connection&#x27;,socket=&gt;&#123;</span><br><span class="line">            socket.on(&#x27;question&#x27;,data=&gt;&#123;</span><br><span class="line">                socket.emit(&#x27;answer&#x27;,data);</span><br><span class="line">            &#125;)</span><br><span class="line">            // 广播：所有连接到此websocket上来的用户，如果其中一个用户发起thank请求，所有用户都能得到回应</span><br><span class="line">            io.emit(&#x27;broadcast&#x27;,&#123;&#x27;say&#x27;:&#x27;谢谢&#x27;&#125;);</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        server.listen(3000,&#x27;127.0.0.1&#x27;);</span><br><span class="line"></span><br><span class="line">方法二：利用ws模块</span><br><span class="line">		前端代码：</span><br><span class="line">			&lt;h1&gt;模拟websocket&lt;/h1&gt;</span><br><span class="line">		    &lt;input id=&#x27;content&#x27; /&gt;&lt;button id=&#x27;send&#x27;&gt;发送&lt;/button&gt;</span><br><span class="line">		    &lt;script&gt;</span><br><span class="line">		        var ws = new WebSocket(&#x27;ws://127.0.0.1:3000&#x27;);</span><br><span class="line">		        ws.addEventListener(&#x27;open&#x27;,()=&gt;&#123;</span><br><span class="line">		            ws.send(&#x27;连接成功...&#x27;);</span><br><span class="line">		        &#125;)</span><br><span class="line">		        document.getElementById(&#x27;send&#x27;).onclick = ()=&gt;&#123;</span><br><span class="line">		            // 给服务器发送一个字符串:</span><br><span class="line">		            ws.send(document.getElementById(&#x27;content&#x27;).value);</span><br><span class="line">		        &#125;</span><br><span class="line">		        ws.onmessage = result=&gt;&#123;</span><br><span class="line">		            console.log(result.data);</span><br><span class="line">		        &#125;</span><br><span class="line">		    &lt;/script&gt;</span><br><span class="line"></span><br><span class="line">		node代码：</span><br><span class="line">			const WebSocket = require(&#x27;ws&#x27;);</span><br><span class="line">			// 实例化:</span><br><span class="line">			const wss = new WebSocket.Server(&#123;</span><br><span class="line">			    port: 3000</span><br><span class="line">			&#125;);</span><br><span class="line"></span><br><span class="line">			// 监听连接事件</span><br><span class="line">			wss.on(&#x27;connection&#x27;,(ws)=&gt;&#123;</span><br><span class="line">			    // 接受对方发送过来的信息</span><br><span class="line">			    ws.on(&#x27;message&#x27;,data=&gt;&#123;</span><br><span class="line">			        ws.send(data);</span><br><span class="line">			    &#125;)</span><br><span class="line">			&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/16/angular%E5%92%8Cvue%E8%BF%98%E6%9C%89jquery%E7%9A%84%E5%8C%BA%E5%88%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/portal.jpg">
      <meta itemprop="name" content="Bruce Chen">
      <meta itemprop="description" content="It's better to burn out than to fade away.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Chen's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/16/angular%E5%92%8Cvue%E8%BF%98%E6%9C%89jquery%E7%9A%84%E5%8C%BA%E5%88%AB/" class="post-title-link" itemprop="url">angular和vue还有jquery的区别</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-12-16 14:18:06 / 修改时间：14:20:14" itemprop="dateCreated datePublished" datetime="2022-12-16T14:18:06+08:00">2022-12-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E6%80%BB%E7%BB%93/" itemprop="url" rel="index"><span itemprop="name">前端框架总结</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="angularjs-简单介绍和特点"><a href="#angularjs-简单介绍和特点" class="headerlink" title="angularjs 简单介绍和特点"></a>angularjs 简单介绍和特点</h2><p>首先 angular 是一个 mvc 框架, 使用 mvc 解耦, 采用 model, controller 以及 view 的方式去组织代码, 会将一个 html 页面分成若干个模块, 每个模块都有自己的 scope, service, directive, 各个模块之间也可以进行通信, 但是整体结构上是比较清晰的, 就是说其代码组织是模块化的, angular 的 view 可能仅仅是一个框架, , 对 view 的 dom 操作或者事件监听都是在 directive 中实现的, 而且一般情况下很少直接去写 dom 操作代码, 只要你监听 model, model 发生变化后 view 也会发生变化, 就是双向绑定机制, angularjs 适用于单页面开发</p>
<p>在 angularJS 中，一个模板就是一个 HTML 文件。但是 HTML 的内容扩展了，包含了很多帮助你映射 model 到 view 的内容。</p>
<p>HTML 模板将会被浏览器解析到 DOM 中。DOM 然后成为 AngularJS 编译器的输入。AngularJS 将会遍历 DOM 模板来生成一些指导，即，directive（指令）。所有的指令都负责针对 view 来设置数据绑定。</p>
<p>angularJS 并不把模板当做 String 来操作。输入 angularJS 的是 DOM 而非 string。数据绑定是 DOM 变化，不是字符串的连接或者 innerHTML 变化。使用 DOM 作为输入，而不是字符串，是 AngularJS 区别于其它的框架的最大原因。使用 DOM 允许你扩展指令词汇并且可以创建你自己的指令，甚至开发可重用的组件。angular 占用的内存较小, 可以兼容主流的浏览器, 他拥有内置的依赖注入的子系统, 可以帮助开发人员更容易开发, 理解和测试和应用, DI 允许你请求你的依赖，而不是自己找寻它们。比如，我们需要一个东西，DI 负责找创建并且提供给我们。那么 AngularJS 可以做到。指令可以用来创建自定义的标签。它们可以用来装饰元素或者操作 DOM 属性。</p>
<h2 id="vuejs-简单介绍特点"><a href="#vuejs-简单介绍特点" class="headerlink" title="vuejs 简单介绍特点"></a>vuejs 简单介绍特点</h2><p>官网: <a target="_blank" rel="noopener" href="http://cn.vuejs.org/">http://cn.vuejs.org/</a></p>
<p>vue 是一个渐进式的框架, 是一个轻量级的框架, 也不算是一个框架, 他核心只关注图层, 是一个构建数据驱动的 web 界面,易于上手, 还便于第三方库或与既有项目整合,也能够为复杂的单页应用程序提供驱动</p>
<h3 id="1-vue-的核心"><a href="#1-vue-的核心" class="headerlink" title="1. vue 的核心"></a>1. vue 的核心</h3><p>是一个允许采用简洁的模板语法来声明式的将数据渲染进 dom</p>
<p>先创建一个后缀名为.html 的文件</p>
<p>代码如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">html:  &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">js里面的　var app = new Vue(&#123;</span><br><span class="line">　　　　　　el: &#x27;#app&#x27;,</span><br><span class="line">　　　　　　data: &#123;</span><br><span class="line">　　　　　　　msg: &#x27;Hello Vue!&#x27;</span><br><span class="line">　　　　　　&#125;</span><br><span class="line">　　　&#125;)</span><br></pre></td></tr></table></figure>

<p>在浏览器窗口上出现的内容:　 Hello Vue<br>数据和 DOM 已经绑定在一起, 验证是否是响应式的, 修改控制台里面 app.msg,你就会看到上面渲染是列子也更新出来了文本插值, 还可以用绑定 DOM 元素属性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;app-2&quot;&gt;</span><br><span class="line">    &lt;span v-bind:title=&quot;message&quot;&gt;</span><br><span class="line">　　　查看此处动态绑定提示信息！</span><br><span class="line">    &lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">js代码:</span><br><span class="line">var app2 = new Vue(&#123;</span><br><span class="line">　　el: &#x27;#app-2&#x27;,</span><br><span class="line">　　data: &#123;</span><br><span class="line">　　　　　message: &#x27;页面加载于 &#x27; + new Date()</span><br><span class="line">　　　&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="2-vue-指令"><a href="#2-vue-指令" class="headerlink" title="2. vue 指令"></a>2. vue 指令</h3><p>指令带有前缀 v-, 以表示他们是 Vue 提供的特殊属性, 他们会在渲染的 DOM 上应用特殊的响应式行为</p>
<p>v-bind : str &#x3D; “msg” 将这个元素的节点的 str 属性和 vue 实例对象的 msg 属性保持一致</p>
<p>v-if &#x3D; 布尔值 条件渲染指令, 根据其后表达式的布尔值进行判断是否渲染该元素, v-if 只会渲染他身后表达式为 true 的元素</p>
<p>v-show &#x3D; 布尔值 和 v-if 类似,只是会渲染他身后表达式为 false 的元素, 而且会给这样的元素添加 css 的代码, style &#x3D; “display:none”</p>
<p>v-else 必须在 v-if&#x2F;v-show 指令后, 不然就不会起作用, 如果 v-if&#x2F;v-show 的指令表达式为 true, 则 else 就不显示, 如果 v-if&#x2F;v-show 指令的表达式为 false, 则 else 元素会显示在页面上</p>
<p>v-for 类似于 js 的遍历, 用法为 v-for&#x3D;”(item,index) in imgs” :key&#x3D;”index”, items 是数组, item 为数组中的数组元素, index 是索引号, key 是为了更高效的查找到指定元素</p>
<p>v-on 用于监听指定元素的 DOM 事件 v-on:click&#x3D;”greet”</p>
<h3 id="3-vue-的双向数据绑定"><a href="#3-vue-的双向数据绑定" class="headerlink" title="3. vue 的双向数据绑定"></a>3. vue 的双向数据绑定</h3><p>vueJS 是使用 ES5 提供的 Object.defineProperty()方法, 监控对数据的操作, 从而可以自动触发数据, 并且, 由于是在不同的数据上触发同步, 可以精确的将变更发送给绑定的视图, 而不是对所有的数据都执行一次检测</p>
<p>vue 和 angular 中, 都是通过在 html 中添加指令的方式, 将视图元素与数据的绑定关系进行声明</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;form id= &quot;app&quot;&gt;</span><br><span class="line">　　&lt;input type=&quot;test&quot; v-model=&quot;name&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p>以上的 html 代码表示该 input 元素与 name 数据进行绑定, 在 js 代码总可以这样进行初始化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var vm = new Vue(&#123;</span><br><span class="line">　　el: &quot;#app&quot;,</span><br><span class="line">　　data:&#123;</span><br><span class="line">　　　name: &quot;请输入你的名字&quot;</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>代码执行正确后, 页面上 input 元素对应的位置会显示上面的代码给出的初始值 “请输入你的名字”, 由于双向绑定数据已经建立, 因此, 在 vm.name&#x3D;”小米”, 则 input 也会更新为小明, 在页面 input 上输入小明, 则 vm.name 获取的值为小明</p>
<h3 id="4-vue-的插件化"><a href="#4-vue-的插件化" class="headerlink" title="4. vue 的插件化"></a>4. vue 的插件化</h3><p>插件通常会为 vue 添加全局功能, 插件的范围没有限制</p>
<p>添加全局的方法或者属性 vue-element 这个我并不是很懂</p>
<p>添加全局资源 指令&#x2F;过滤器&#x2F; 过渡</p>
<p>添加 vue 实例的办法, 将他们添加到 vue-prototype 上实现</p>
<p>引入一个库, 来提供自己的 api, 同时提供上面的一个或者多个功能, 如 vue-router</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import vueRouter from &#x27;&#x27;vue-router&#x27;;  //使用webpack的单文件组件打包的方式 会调用vue.component来注册全局组件或者vue.components注册局部组件</span><br></pre></td></tr></table></figure>

<p>如果是后者，每个单文件组件中都不需要引入 vue,<br>因为单文件组件经 webpack 打包后，生成的模块只是一个组件选项对象，被其他组件或 Vue 实例注册时使用语法糖，只需要 字面量对象的 组件选项对象就可以了。</p>
<p>使用插件:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue.use(vueRouter); //通过全局方法Vue.use()使用插件, 会阻止注册相同插件多次, 只会注册一次该插件</span><br></pre></td></tr></table></figure>



<h2 id="angular-和-jquery-的区别"><a href="#angular-和-jquery-的区别" class="headerlink" title="angular 和 jquery 的区别"></a>angular 和 jquery 的区别</h2><p>angular 中是尽量避免操作 DOM, angular 是基于数据驱动, 适合做数据操作比较繁琐的项目,angular 适用于单页面开发,是一个比较完善的 mvvm 框架, 包含模板和双向数据绑定, 路由, 模块化, 服务, 过滤器, 依赖注入等所有功能,但是 angular 验证功能比较薄弱, 需要写很多模板标签, 而且 ngview 只能有一个, 不能嵌套多个视图,angular 的兼容性比较好, jquery 是基于操作 DOM, 适用于操作 DOM 比较多的项目, jquery 是一个库, 比较大,兼容大部分浏览器, 有丰富的插件, 可拓展性强, jquery 不能向后兼容, 使用插件时,可能会有冲突,</p>
<h2 id="angular-和-vue-的差别"><a href="#angular-和-vue-的差别" class="headerlink" title="angular 和 vue 的差别"></a>angular 和 vue 的差别</h2><p>一 angular 是 mvvm 框架, 而 vue 是一个渐进式的框架, 相当于 view 层, 都有双向数据绑定, 但是 angular 中的双向数据绑定是基于脏检查机制, vue 的双向数据绑定是基于 ES5 的 getter 和 setter 来实现, 而 angular 是有自己实现一套模板编译规则,vue 比 angular 更轻量, 性能上更高效, 比 angular 更容易上手, 学习成本低, vue 需要一个 el 对象进行实例化, 而 angular 是整个 html 页面下的,单页面应用, 而 vue 可以有多个 vue 实例</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/16/TypeScript%E7%9A%84%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/portal.jpg">
      <meta itemprop="name" content="Bruce Chen">
      <meta itemprop="description" content="It's better to burn out than to fade away.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Chen's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/16/TypeScript%E7%9A%84%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/" class="post-title-link" itemprop="url">TypeScript的使用技巧</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-12-16 14:17:58 / 修改时间：14:23:00" itemprop="dateCreated datePublished" datetime="2022-12-16T14:17:58+08:00">2022-12-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E6%80%BB%E7%BB%93/" itemprop="url" rel="index"><span itemprop="name">前端框架总结</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、Enum-类型"><a href="#一、Enum-类型" class="headerlink" title="一、Enum 类型"></a>一、Enum 类型</h1><p>使用枚举我们可以定义一些带名字的常量。 使用枚举可以清晰地表达意图或创建一组有区别的用例。 TypeScript 支持数字的和基于字符串的枚举。</p>
<h2 id="1-数字枚举"><a href="#1-数字枚举" class="headerlink" title="1.数字枚举"></a>1.数字枚举</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">enum Direction &#123;</span><br><span class="line">  NORTH,</span><br><span class="line">  SOUTH,</span><br><span class="line">  EAST,</span><br><span class="line">  WEST,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let dir: Direction = Direction.NORTH;</span><br></pre></td></tr></table></figure>

<p>默认情况下，NORTH 的初始值为 0，其余的成员会从 1 开始自动增长。换句话说，Direction.SOUTH 的值为 1，Direction.EAST 的值为 2，Direction.WEST 的值为 3。上面的枚举示例代码经过编译后会生成以下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&quot;use strict&quot;;</span><br><span class="line">var Direction;</span><br><span class="line">(function (Direction) &#123;</span><br><span class="line">  Direction[(Direction[&quot;NORTH&quot;] = 0)] = &quot;NORTH&quot;;</span><br><span class="line">  Direction[(Direction[&quot;SOUTH&quot;] = 1)] = &quot;SOUTH&quot;;</span><br><span class="line">  Direction[(Direction[&quot;EAST&quot;] = 2)] = &quot;EAST&quot;;</span><br><span class="line">  Direction[(Direction[&quot;WEST&quot;] = 3)] = &quot;WEST&quot;;</span><br><span class="line">&#125;)(Direction || (Direction = &#123;&#125;));</span><br><span class="line">var dir = Direction.NORTH;</span><br></pre></td></tr></table></figure>

<p>当然我们也可以设置 NORTH 的初始值，比如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">enum Direction &#123;</span><br><span class="line">  NORTH = 3,</span><br><span class="line">  SOUTH,</span><br><span class="line">  EAST,</span><br><span class="line">  WEST,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-字符串枚举"><a href="#2-字符串枚举" class="headerlink" title="2.字符串枚举"></a>2.字符串枚举</h2><p>在 TypeScript 2.4 版本，允许我们使用字符串枚举。在一个字符串枚举里，每个成员都必须用字符串字面量，或另外一个字符串枚举成员进行初始化。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">enum Direction &#123;</span><br><span class="line">  NORTH = &quot;NORTH&quot;,</span><br><span class="line">  SOUTH = &quot;SOUTH&quot;,</span><br><span class="line">  EAST = &quot;EAST&quot;,</span><br><span class="line">  WEST = &quot;WEST&quot;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上代码对于的 ES5 代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&quot;use strict&quot;;</span><br><span class="line">var Direction;</span><br><span class="line">(function (Direction) &#123;</span><br><span class="line">    Direction[&quot;NORTH&quot;] = &quot;NORTH&quot;;</span><br><span class="line">    Direction[&quot;SOUTH&quot;] = &quot;SOUTH&quot;;</span><br><span class="line">    Direction[&quot;EAST&quot;] = &quot;EAST&quot;;</span><br><span class="line">    Direction[&quot;WEST&quot;] = &quot;WEST&quot;;</span><br><span class="line">&#125;)(Direction || (Direction = &#123;&#125;));</span><br></pre></td></tr></table></figure>

<h2 id="3-异构枚举"><a href="#3-异构枚举" class="headerlink" title="3.异构枚举"></a>3.异构枚举</h2><p>异构枚举的成员值是数字和字符串的混合：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">enum Enum &#123;</span><br><span class="line">  A,</span><br><span class="line">  B,</span><br><span class="line">  C = &quot;C&quot;,</span><br><span class="line">  D = &quot;D&quot;,</span><br><span class="line">  E = 8,</span><br><span class="line">  F,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上代码对于的 ES5 代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&quot;use strict&quot;;</span><br><span class="line">var Enum;</span><br><span class="line">(function (Enum) &#123;</span><br><span class="line">    Enum[Enum[&quot;A&quot;] = 0] = &quot;A&quot;;</span><br><span class="line">    Enum[Enum[&quot;B&quot;] = 1] = &quot;B&quot;;</span><br><span class="line">    Enum[&quot;C&quot;] = &quot;C&quot;;</span><br><span class="line">    Enum[&quot;D&quot;] = &quot;D&quot;;</span><br><span class="line">    Enum[Enum[&quot;E&quot;] = 8] = &quot;E&quot;;</span><br><span class="line">    Enum[Enum[&quot;F&quot;] = 9] = &quot;F&quot;;</span><br><span class="line">&#125;)(Enum || (Enum = &#123;&#125;));</span><br></pre></td></tr></table></figure>

<p>通过观察上述生成的 ES5 代码，我们可以发现数字枚举相对字符串枚举多了 “反向映射”：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">console.log(Enum.A) //输出：0</span><br><span class="line">console.log(Enum[0]) // 输出：A</span><br></pre></td></tr></table></figure>

<h1 id="二、特殊数据类型"><a href="#二、特殊数据类型" class="headerlink" title="二、特殊数据类型"></a>二、特殊数据类型</h1><h2 id="1-Unknown-类型"><a href="#1-Unknown-类型" class="headerlink" title="1. Unknown 类型"></a>1. Unknown 类型</h2><p>就像所有类型都可以赋值给 any，所有类型也都可以赋值给 unknown。这使得 unknown 成为 TypeScript 类型系统的另一种顶级类型（另一种是 any）。下面我们来看一下 unknown 类型的使用示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">let value: unknown;</span><br><span class="line"></span><br><span class="line">value = true; // OK</span><br><span class="line">value = 42; // OK</span><br><span class="line">value = &quot;Hello World&quot;; // OK</span><br><span class="line">value = []; // OK</span><br><span class="line">value = &#123;&#125;; // OK</span><br><span class="line">value = Math.random; // OK</span><br><span class="line">value = null; // OK</span><br><span class="line">value = undefined; // OK</span><br><span class="line">value = new TypeError(); // OK</span><br><span class="line">value = Symbol(&quot;type&quot;); // OK</span><br></pre></td></tr></table></figure>

<p>对 <code>value</code> 变量的所有赋值都被认为是类型正确的。但是，当我们尝试将类型为 <code>unknown</code> 的值赋值给其他类型的变量时会发生什么？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">let value: unknown;</span><br><span class="line"></span><br><span class="line">let value1: unknown = value; // OK</span><br><span class="line">let value2: any = value; // OK</span><br><span class="line">let value3: boolean = value; // Error</span><br><span class="line">let value4: number = value; // Error</span><br><span class="line">let value5: string = value; // Error</span><br><span class="line">let value6: object = value; // Error</span><br><span class="line">let value7: any[] = value; // Error</span><br><span class="line">let value8: Function = value; // Error</span><br></pre></td></tr></table></figure>

<p><code>unknown</code> 类型只能被赋值给 <code>any</code> 类型和 <code>unknown</code> 类型本身。直观地说，这是有道理的：只有能够保存任意类型值的容器才能保存 <code>unknown</code> 类型的值。毕竟我们不知道变量 <code>value</code> 中存储了什么类型的值。</p>
<p>现在让我们看看当我们尝试对类型为 unknown 的值执行操作时会发生什么。以下是我们在之前 any 章节看过的相同操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let value: unknown;</span><br><span class="line"></span><br><span class="line">value.foo.bar; // Error</span><br><span class="line">value.trim(); // Error</span><br><span class="line">value(); // Error</span><br><span class="line">new value(); // Error</span><br><span class="line">value[0][1]; // Error</span><br></pre></td></tr></table></figure>

<p>将 <code>value</code> 变量类型设置为 <code>unknown</code> 后，这些操作都不再被认为是类型正确的。通过将 <code>any</code> 类型改变为 <code>unknown</code> 类型，我们已将允许所有更改的默认设置，更改为禁止任何更改。</p>
<h2 id="2-Never-类型"><a href="#2-Never-类型" class="headerlink" title="2. Never 类型"></a>2. Never 类型</h2><p><code>never</code> 类型表示的是那些永不存在的值的类型。 例如，<code>never</code> 类型是那些总是会抛出异常或根本就不会有返回值的函数表达式或箭头函数表达式的返回值类型。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 返回never的函数必须存在无法达到的终点</span><br><span class="line">function error(message: string): never &#123;</span><br><span class="line">  throw new Error(message);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function infiniteLoop(): never &#123;</span><br><span class="line">  while (true) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 TypeScript 中，可以利用 never 类型的特性来实现全面性检查，具体示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">type Foo = string | number;</span><br><span class="line"></span><br><span class="line">function controlFlowAnalysisWithNever(foo: Foo) &#123;</span><br><span class="line">  if (typeof foo === &quot;string&quot;) &#123;</span><br><span class="line">    // 这里 foo 被收窄为 string 类型</span><br><span class="line">  &#125; else if (typeof foo === &quot;number&quot;) &#123;</span><br><span class="line">    // 这里 foo 被收窄为 number 类型</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    // foo 在这里是 never</span><br><span class="line">    const check: never = foo;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意在 else 分支里面，我们把收窄为 never 的 foo 赋值给一个显示声明的 never 变量。如果一切逻辑正确，那么这里应该能够编译通过。但是假如后来有一天你的同事修改了 Foo 的类型：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type Foo = string | number | boolean;</span><br></pre></td></tr></table></figure>

<p>然而他忘记同时修改 <code>controlFlowAnalysisWithNever</code> 方法中的控制流程，这时候 else 分支的 foo 类型会被收窄为 <code>boolean</code> 类型，导致无法赋值给 never 类型，这时就会产生一个编译错误。通过这个方式，我们可以确保</p>
<p><code>controlFlowAnalysisWithNever</code> 方法总是穷尽了 Foo 的所有可能类型。 通过这个示例，我们可以得出一个结论：使用 never 避免出现新增了联合类型没有对应的实现，目的就是写出类型绝对安全的代码。</p>
<h1 id="三、Typescript-的类型系统"><a href="#三、Typescript-的类型系统" class="headerlink" title="三、Typescript 的类型系统"></a>三、Typescript 的类型系统</h1><p>充分使用编辑器的 language service 功能（类型提示，类型检查，类型推倒，自动补全，类型定义跳转)</p>
<p>把类型当做值的集合思考</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">type A= &#x27;A&#x27; // 单值集合 &#123; &#x27;A&#x27; &#125;</span><br><span class="line">type B= &#x27;B&#x27; // 单值集合 &#123; &#x27;B&#x27; &#125;</span><br><span class="line">type AB = &#x27;A&#x27; | &#x27;B&#x27;  // 集合的并集 &#123; &#x27;A&#x27;, &#x27;B&#x27; &#125;</span><br><span class="line">type twoInt =  2 | 4 | 5 ... // 无限元素集合 &#123; 1,2,3,4&#125;</span><br><span class="line">type threeInt = 3 | 6 | 9 // 无限集合</span><br><span class="line">type twoIntersectThreeInt = twoInt &amp; threeInt // 无限集合的交集</span><br><span class="line">type twoUnionThreeInt = 2| 3 | 4 | 6 ... // 无限集合的并集</span><br><span class="line">keyof (A&amp;B) = (keyof A) | (keyof B)</span><br><span class="line">keyof (A|B) = (keyof A) &amp; (keyof B)</span><br></pre></td></tr></table></figure>

<p>术语和集合术语对照表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Typescript术语	                  集合术语</span><br><span class="line">never	                          空集</span><br><span class="line">literal type	                  单值集合</span><br><span class="line">value 可赋值给 T	              value ∈T</span><br><span class="line">T1 assignable to T2	              T1是T2的子集</span><br><span class="line">T1 extends T2	                  T1是T2的子集</span><br><span class="line">T1	                              T2</span><br><span class="line">T1 &amp; T2	                          T1 和T2的交集</span><br><span class="line">unknown	                          universal set</span><br></pre></td></tr></table></figure>

<h1 id="四、了解-type-和-interface-的区别"><a href="#四、了解-type-和-interface-的区别" class="headerlink" title="四、了解 type 和 interface 的区别"></a>四、了解 type 和 interface 的区别</h1><p>绝大部分情况下，type 和 interface 都能等价转换</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">// 普通对象</span><br><span class="line">type TState = &#123;</span><br><span class="line">    name: string;</span><br><span class="line">    capital: string;</span><br><span class="line">&#125;</span><br><span class="line">interface IState &#123;</span><br><span class="line">    name: string;</span><br><span class="line">    capital: string;</span><br><span class="line">&#125;</span><br><span class="line">// index signature</span><br><span class="line">type TDict = &#123;[key:string]: string &#125;</span><br><span class="line">interface IDict &#123;</span><br><span class="line">    [key:string]: string</span><br><span class="line">&#125;</span><br><span class="line">type TFn = (x:number) =&gt; string;</span><br><span class="line">interface IFn &#123;</span><br><span class="line">    (x:number):string;</span><br><span class="line">&#125;</span><br><span class="line">// function with props</span><br><span class="line">type TFnWithProps = &#123;</span><br><span class="line">    (x:number):number;</span><br><span class="line">    prop: string;</span><br><span class="line">&#125;</span><br><span class="line">interface IFnWithProps &#123;</span><br><span class="line">    (x:number):number;</span><br><span class="line">    prop: string;</span><br><span class="line">&#125;</span><br><span class="line">//  constructor</span><br><span class="line">type TConstructor = new(x:number) =&gt; &#123;x:number&#125;</span><br><span class="line">interface IConstructor&#123;</span><br><span class="line">    new(x:number): &#123;x:number&#125;</span><br><span class="line">&#125;</span><br><span class="line">// generic</span><br><span class="line">type TPair&lt;T&gt;= &#123;</span><br><span class="line">    first: T;</span><br><span class="line">    second: T;</span><br><span class="line">&#125;</span><br><span class="line">interface IPair&lt;T&gt; &#123;</span><br><span class="line">    first: T;</span><br><span class="line">    second: T;</span><br><span class="line">&#125;</span><br><span class="line">// extends</span><br><span class="line">type TStateWithProps = TState &amp; &#123; population : number&#125;</span><br><span class="line">interface IStateWithProp extends IState &#123;</span><br><span class="line">    population: number;</span><br><span class="line">&#125;</span><br><span class="line">// implements</span><br><span class="line">class StateT implements TState &#123;</span><br><span class="line">    name = &#x27;&#x27;;</span><br><span class="line">    capital = &#x27;&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">class StateI implements IState &#123;</span><br><span class="line">    name=&#x27;&#x27;;</span><br><span class="line">    capital = &#x27;&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>type 和 interface 亦有所区别</p>
<ol>
<li>interface 无法应用于 union type | intersection type | conditional type | tuple</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type AorB = &#x27;A&#x27; | &#x27;B&#x27;</span><br><span class="line">type NamedVariable = (Input | Output) &amp; &#123; name: string&#125;</span><br><span class="line">type Pair = [number,number]</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>interface 可以 argumented,而 type 不可以</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// inner</span><br><span class="line">interface IState &#123;</span><br><span class="line">    name :string;</span><br><span class="line">    capital: string;</span><br><span class="line">&#125;</span><br><span class="line">// outer</span><br><span class="line">interface IState &#123;</span><br><span class="line">    population: number</span><br><span class="line">&#125;</span><br><span class="line">const wyoming: IState = &#123;</span><br><span class="line">    name: &#x27;Wyoming&#x27;,</span><br><span class="line">    capital: &#x27;Cheyenne&#x27;,</span><br><span class="line">    population: 500_000</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="五、keyof-操作符"><a href="#五、keyof-操作符" class="headerlink" title="五、keyof 操作符"></a>五、keyof 操作符</h1><h2 id="keyof-简介"><a href="#keyof-简介" class="headerlink" title="keyof 简介"></a>keyof 简介</h2><p>TypeScript 允许我们遍历某种类型的属性，并通过 keyof 操作符提取其属性的名称。keyof 操作符是在 TypeScript 2.1 版本引入的，该操作符可以用于获取某种类型的所有键，其返回类型是联合类型。</p>
<p>下面我们来看个例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">interface Person &#123;</span><br><span class="line">  name: string;</span><br><span class="line">  age: number;</span><br><span class="line">  location: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type K1 = keyof Person; // &quot;name&quot; | &quot;age&quot; | &quot;location&quot;</span><br><span class="line">type K2 = keyof Person[];  // number | &quot;length&quot; | &quot;push&quot; | &quot;concat&quot; | ...</span><br><span class="line">type K3 = keyof &#123; [x: string]: Person &#125;;  // string | number</span><br></pre></td></tr></table></figure>

<p>除了接口外，keyof 也可以用于操作类，比如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class Person &#123;</span><br><span class="line">  name: string = &quot;Semlinker&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let sname: keyof Person;</span><br><span class="line">sname = &quot;name&quot;;</span><br></pre></td></tr></table></figure>

<p>若把 <code>sname = &quot;name&quot;</code> 改为 <code>sname = &quot;age&quot;</code> 的话，TypeScript 编译器会提示以下错误信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Type &#x27;&quot;age&quot;&#x27; is not assignable to type &#x27;&quot;name&quot;&#x27;.</span><br></pre></td></tr></table></figure>

<p>keyof 操作符除了支持接口和类之外，它也支持基本数据类型：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">let K1: keyof boolean; // let K1: &quot;valueOf&quot;</span><br><span class="line">let K2: keyof number; // let K2: &quot;toString&quot; | &quot;toFixed&quot; | &quot;toExponential&quot; | ...</span><br><span class="line">let K3: keyof symbol; // let K3: &quot;valueOf&quot;</span><br></pre></td></tr></table></figure>

<p>此外 keyof 也称为输入索引类型查询，与之相对应的是索引访问类型，也称为查找类型。在语法上，它们看起来像属性或元素访问，但最终会被转换为类型：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">type P1 = Person[&quot;name&quot;];  // string</span><br><span class="line">type P2 = Person[&quot;name&quot; | &quot;age&quot;];  // string | number</span><br><span class="line">type P3 = string[&quot;charAt&quot;];  // (pos: number) =&gt; string</span><br><span class="line">type P4 = string[][&quot;push&quot;];  // (...items: string[]) =&gt; number</span><br><span class="line">type P5 = string[][0];  // string</span><br></pre></td></tr></table></figure>

<h2 id="keyof-的作用"><a href="#keyof-的作用" class="headerlink" title="keyof 的作用"></a>keyof 的作用</h2><p>JavaScript 是一种高度动态的语言。有时在静态类型系统中捕获某些操作的语义可能会很棘手。以一个简单的 prop 函数为例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function prop(obj, key) &#123;</span><br><span class="line">  return obj[key];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>该函数接收 obj 和 key 两个参数，并返回对应属性的值。对象上的不同属性，可以具有完全不同的类型，我们甚至不知道 obj 对象长什么样。</p>
<p>那么在 TypeScript 中如何定义上面的 prop 函数呢？我们来尝试一下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function prop(obj: object, key: string) &#123;</span><br><span class="line">  return obj[key];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上面代码中，为了避免调用 prop 函数时传入错误的参数类型，我们为 obj 和 key 参数设置了类型，分别为 {} 和 string 类型。然而，事情并没有那么简单。针对上述的代码，TypeScript 编译器会输出以下错误信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Element implicitly has an &#x27;any&#x27; type because expression of type &#x27;string&#x27; can&#x27;t be used to index type &#x27;&#123;&#125;&#x27;.</span><br></pre></td></tr></table></figure>

<p>元素隐式地拥有 any 类型，因为 string 类型不能被用于索引 {} 类型。要解决这个问题，你可以使用以下非常暴力的方案：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function prop(obj: object, key: string) &#123;</span><br><span class="line">  return (obj as any)[key];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很明显该方案并不是一个好的方案，我们来回顾一下 prop 函数的作用，该函数用于获取某个对象中指定属性的属性值。因此我们期望用户输入的属性是对象上已存在的属性，那么如何限制属性名的范围呢？这时我们可以利用本文的主角 keyof 操作符：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function prop&lt;T extends object, K extends keyof T&gt;(obj: T, key: K) &#123;</span><br><span class="line">  return obj[key];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在以上代码中，我们使用了 TypeScript 的泛型和泛型约束。首先定义了 T 类型并使用 extends 关键字约束该类型必须是 object 类型的子类型，然后使用 keyof 操作符获取 T 类型的所有键，其返回类型是联合类型，最后利用 extends 关键字约束 K 类型必须为 keyof T 联合类型的子类型。 是骡子是马拉出来遛遛就知道了，我们来实际测试一下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">type Todo = &#123;</span><br><span class="line">  id: number;</span><br><span class="line">  text: string;</span><br><span class="line">  done: boolean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const todo: Todo = &#123;</span><br><span class="line">  id: 1,</span><br><span class="line">  text: &quot;Learn TypeScript keyof&quot;,</span><br><span class="line">  done: false</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function prop&lt;T extends object, K extends keyof T&gt;(obj: T, key: K) &#123;</span><br><span class="line">  return obj[key];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const id = prop(todo, &quot;id&quot;); // const id: number</span><br><span class="line">const text = prop(todo, &quot;text&quot;); // const text: string</span><br><span class="line">const done = prop(todo, &quot;done&quot;); // const done: boolean</span><br></pre></td></tr></table></figure>

<p>很明显使用泛型，重新定义后的 prop&lt;T extends object, K extends keyof T&gt;(obj: T, key: K) 函数，已经可以正确地推导出指定键对应的类型。那么当访问 todo 对象上不存在的属性时，会出现什么情况？比如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const date = prop(todo, &quot;date&quot;);</span><br></pre></td></tr></table></figure>

<p>对于上述代码，TypeScript 编译器会提示以下错误：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Argument of type &#x27;&quot;date&quot;&#x27; is not assignable to parameter of type &#x27;&quot;id&quot; | &quot;text&quot; | &quot;done&quot;&#x27;.</span><br></pre></td></tr></table></figure>

<p>这就阻止我们尝试读取不存在的属性。</p>
<h2 id="keyof-与对象的数值属性"><a href="#keyof-与对象的数值属性" class="headerlink" title="keyof 与对象的数值属性"></a>keyof 与对象的数值属性</h2><p>在使用对象的数值属性时，我们也可以使用 keyof 关键字。请记住，如果我们定义一个带有数值属性的对象，那么我们既需要定义该属性，又需要使用数组语法访问该属性， 如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class ClassWithNumericProperty &#123;</span><br><span class="line">  [1]: string = &quot;Semlinker&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let classWithNumeric = new ClassWithNumericProperty();</span><br><span class="line">console.log(`$&#123;classWithNumeric[1]&#125; `);</span><br></pre></td></tr></table></figure>

<p>下面我们来举个示例，介绍一下在含有数值属性的对象中，如何使用 keyof 操作符来安全地访问对象的属性：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">enum Currency &#123;</span><br><span class="line">  CNY = 6,</span><br><span class="line">  EUR = 8,</span><br><span class="line">  USD = 10</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const CurrencyName = &#123;</span><br><span class="line">  [Currency.CNY]: &quot;人民币&quot;,</span><br><span class="line">  [Currency.EUR]: &quot;欧元&quot;,</span><br><span class="line">  [Currency.USD]: &quot;美元&quot;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">console.log(`CurrencyName[Currency.CNY] = $&#123;CurrencyName[Currency.CNY]&#125;`);</span><br><span class="line">console.log(`CurrencyName[36] = $&#123;CurrencyName[6]&#125;`);</span><br></pre></td></tr></table></figure>

<p>上面的代码中，首先定义了一个 Currency 枚举用于表示三种货币类型，接着定义一个 CurrencyName 对象，该对象使用数值属性作为键，对应的值是该货币类型的名称。该代码成功运行后，控制台会输出以下结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CurrencyName[Currency.CNY] = 人民币</span><br><span class="line">CurrencyName[36] = 人民币</span><br></pre></td></tr></table></figure>

<p>为了方便用户能根据货币类型来获取对应的货币名称，我们来定义一个 getCurrencyName 函数，具体实现如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function getCurrencyName&lt;T, K extends keyof T&gt;(key: K, map: T): T[K] &#123;</span><br><span class="line">  return map[key];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(`name = $&#123;getCurrencyName(Currency.CNY, CurrencyName)&#125;`);</span><br></pre></td></tr></table></figure>

<p>同样，getCurrencyName 函数和前面介绍的 prop 函数一样，使用了泛型和泛型约束，从而来保证属性的安全访问。最后，我们来简单介绍一下 keyof 与 typeof 操作符如何配合使用。</p>
<h2 id="keyof-与-typeof-操作符"><a href="#keyof-与-typeof-操作符" class="headerlink" title="keyof 与 typeof 操作符"></a>keyof 与 typeof 操作符</h2><p>typeof 操作符用于获取变量的类型。因此这个操作符的后面接的始终是一个变量，且需要运用到类型定义当中。为了方便大家理解，我们来举一个具体的示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">type Person = &#123;</span><br><span class="line">  name: string;</span><br><span class="line">  age: number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let man: Person = &#123;</span><br><span class="line">  name: &quot;Semlinker&quot;,</span><br><span class="line">  age: 30</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Human = typeof man;</span><br></pre></td></tr></table></figure>

<p>了解完 typeof 和 keyof 操作符的作用，我们来举个例子，介绍一下它们如何结合在一起使用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">const COLORS = &#123;</span><br><span class="line">  red: &#x27;red&#x27;,</span><br><span class="line">  blue: &#x27;blue&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 首先通过typeof操作符获取color变量的类型，然后通过keyof操作符获取该类型的所有键，</span><br><span class="line">// 即字符串字面量联合类型 &#x27;red&#x27; | &#x27;blue&#x27;</span><br><span class="line">type Colors = keyof typeof COLORS</span><br><span class="line">let color: Colors;</span><br><span class="line">color = &#x27;red&#x27; // Ok</span><br><span class="line">color = &#x27;blue&#x27; // Ok</span><br><span class="line"></span><br><span class="line">// Type &#x27;&quot;yellow&quot;&#x27; is not assignable to type &#x27;&quot;red&quot; | &quot;blue&quot;&#x27;.</span><br><span class="line">color = &#x27;yellow&#x27; // Error</span><br></pre></td></tr></table></figure>

<h1 id="六、TypeScript-泛型"><a href="#六、TypeScript-泛型" class="headerlink" title="六、TypeScript 泛型"></a>六、TypeScript 泛型</h1><p>软件工程中，我们不仅要创建一致的定义良好的 API，同时也要考虑可重用性。 组件不仅能够支持当前的数据类型，同时也能支持未来的数据类型，这在创建大型系统时为你提供了十分灵活的功能。</p>
<p>在像 <code>C#</code> 和 <code>Java</code> 这样的语言中，可以使用泛型来创建可重用的组件，一个组件可以支持多种类型的数据。 这样用户就可以以自己的数据类型来使用组件。</p>
<p>设计泛型的关键目的是在成员之间提供有意义的约束，这些成员可以是：类的实例成员、类的方法、函数参数和函数返回值。</p>
<p>泛型（Generics）是允许同一个函数接受不同类型参数的一种模板。相比于使用 any 类型，使用泛型来创建可复用的组件要更好，因为泛型会保留参数类型。</p>
<h2 id="泛型接口"><a href="#泛型接口" class="headerlink" title="泛型接口"></a>泛型接口</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">interface GenericIdentityFn&lt;T&gt; &#123;</span><br><span class="line">  (arg: T): T;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="泛型类"><a href="#泛型类" class="headerlink" title="泛型类"></a>泛型类</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class GenericNumber&lt;T&gt; &#123;</span><br><span class="line">  zeroValue: T;</span><br><span class="line">  add: (x: T, y: T) =&gt; T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let myGenericNumber = new GenericNumber&lt;number&gt;();</span><br><span class="line">myGenericNumber.zeroValue = 0;</span><br><span class="line">myGenericNumber.add = function (x, y) &#123;</span><br><span class="line">  return x + y;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="泛型变量"><a href="#泛型变量" class="headerlink" title="泛型变量"></a>泛型变量</h2><p>对刚接触 TypeScript 泛型的小伙伴来说，看到 T 和 E，还有 K 和 V 这些泛型变量时，估计会一脸懵逼。其实这些大写字母并没有什么本质的区别，只不过是一个约定好的规范而已。也就是说使用大写字母 A-Z 定义的类型变量都属于泛型，把 T 换成 A，也是一样的。下面我们介绍一下一些常见泛型变量代表的意思：</p>
<ul>
<li>T（Type）：表示一个 TypeScript 类型</li>
<li>K（Key）：表示对象中的键类型</li>
<li>V（Value）：表示对象中的值类型</li>
<li>E（Element）：表示元素类型</li>
</ul>
<h2 id="泛型工具类型"><a href="#泛型工具类型" class="headerlink" title="泛型工具类型"></a>泛型工具类型</h2><p>为了方便开发者 TypeScript 内置了一些常用的工具类型，比如 Partial、Required、Readonly、Record 和 ReturnType 等。出于篇幅考虑，这里我们只简单介绍 Partial 工具类型。不过在具体介绍之前，我们得先介绍一些相关的基础知识，方便读者自行学习其它的工具类型。</p>
<p><strong>1.typeof</strong><br>在 TypeScript 中，typeof 操作符可以用来获取一个变量声明或对象的类型。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">interface Person &#123;</span><br><span class="line">  name: string;</span><br><span class="line">  age: number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const sem: Person = &#123; name: &#x27;semlinker&#x27;, age: 30 &#125;;</span><br><span class="line">type Sem= typeof sem; // -&gt; Person</span><br><span class="line"></span><br><span class="line">function toArray(x: number): Array&lt;number&gt; &#123;</span><br><span class="line">  return [x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Func = typeof toArray; // -&gt; (x: number) =&gt; number[]</span><br></pre></td></tr></table></figure>

<p><strong>2.keyof</strong><br>keyof 操作符可以用来获取一个对象中的所有 key 值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">interface Person &#123;</span><br><span class="line">    name: string;</span><br><span class="line">    age: number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type K1 = keyof Person; // &quot;name&quot; | &quot;age&quot;</span><br><span class="line">type K2 = keyof Person[]; // &quot;length&quot; | &quot;toString&quot; | &quot;pop&quot; | &quot;push&quot; | &quot;concat&quot; | &quot;join&quot;</span><br><span class="line">type K3 = keyof &#123; [x: string]: Person &#125;;  // string | number</span><br></pre></td></tr></table></figure>

<p><strong>3.in</strong><br>in 用来遍历枚举类型：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">type Keys = &quot;a&quot; | &quot;b&quot; | &quot;c&quot;</span><br><span class="line"></span><br><span class="line">type Obj =  &#123;</span><br><span class="line">  [p in Keys]: any</span><br><span class="line">&#125; // -&gt; &#123; a: any, b: any, c: any &#125;</span><br></pre></td></tr></table></figure>

<p><strong>4.infer</strong><br>在条件类型语句中，可以用 infer 声明一个类型变量并且对它进行使用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type ReturnType&lt;T&gt; = T extends (</span><br><span class="line">  ...args: any[]</span><br><span class="line">) =&gt; infer R ? R : any;</span><br></pre></td></tr></table></figure>

<p>以上代码中 infer R 就是声明一个变量来承载传入函数签名的返回值类型，简单说就是用它取到函数返回值的类型方便之后使用。</p>
<p><strong>5.extends</strong><br>有时候我们定义的泛型不想过于灵活或者说想继承某些类等，可以通过 extends 关键字添加泛型约束。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">interface ILengthwise &#123;</span><br><span class="line">  length: number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function loggingIdentity&lt;T extends ILengthwise&gt;(arg: T): T &#123;</span><br><span class="line">  console.log(arg.length);</span><br><span class="line">  return arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在这个泛型函数被定义了约束，因此它不再是适用于任意类型：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">loggingIdentity(3);  // Error, number doesn&#x27;t have a .length property</span><br></pre></td></tr></table></figure>

<p>这时我们需要传入符合约束类型的值，必须包含必须的属性：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">loggingIdentity(&#123;length: 10, value: 3&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>6.Partial</strong></p>
<p>Partial<T> 的作用就是将某个类型里的属性全部变为可选项 ?。</p>
<p><strong>定义：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * node_modules/typescript/lib/lib.es5.d.ts</span><br><span class="line"> * Make all properties in T optional</span><br><span class="line"> */</span><br><span class="line">type Partial&lt;T&gt; = &#123;</span><br><span class="line">  [P in keyof T]?: T[P];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>在以上代码中，首先通过 keyof T 拿到 T 的所有属性名，然后使用 in 进行遍历，将值赋给 P，最后通过 T[P] 取得相应的属性值。中间的 ? 号，用于将所有属性变为可选。</p>
<p><strong>示例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">interface Todo &#123;</span><br><span class="line">  title: string;</span><br><span class="line">  description: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function updateTodo(todo: Todo, fieldsToUpdate: Partial&lt;Todo&gt;) &#123;</span><br><span class="line">  return &#123; ...todo, ...fieldsToUpdate &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const todo1 = &#123;</span><br><span class="line">  title: &quot;organize desk&quot;,</span><br><span class="line">  description: &quot;clear clutter&quot;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const todo2 = updateTodo(todo1, &#123;</span><br><span class="line">  description: &quot;throw out trash&quot;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>在上面的 updateTodo 方法中，我们利用 Partial<T> 工具类型，定义 fieldsToUpdate 的类型为 Partial<Todo>，即：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   title?: string | undefined;</span><br><span class="line">   description?: string | undefined;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="七、充分利用泛型和类型运算避免冗余类型标记"><a href="#七、充分利用泛型和类型运算避免冗余类型标记" class="headerlink" title="七、充分利用泛型和类型运算避免冗余类型标记"></a>七、充分利用泛型和类型运算避免冗余类型标记</h1><p>使用泛型提取公共的 util type，简化类型编写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">interface ButtonProps &#123;</span><br><span class="line">    type: string;</span><br><span class="line">    size: &#x27;large&#x27; | &#x27;middle&#x27;| &#x27;small&#x27;</span><br><span class="line">&#125;</span><br><span class="line">interface ButtonPropsWithChildren&#123;</span><br><span class="line">    type: string;</span><br><span class="line">    size: &#x27;large&#x27; | &#x27;middle&#x27;| &#x27;small&#x27;,</span><br><span class="line">    children: React.ReactNode</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用 PropsWithChildren 简化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import &#123; PropsWithChildren &#125; from &#x27;react&#x27;;</span><br><span class="line">type ButtonPropsWithChildren = PropsWithChildren&lt;ButtonProps&gt;</span><br></pre></td></tr></table></figure>

<p>使用 index type | mapped type | keyof 等进行类型传递</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">interface State &#123;</span><br><span class="line">    userId: string;</span><br><span class="line">    pageTitle: string;</span><br><span class="line">    recentFiles: string[]</span><br><span class="line">    pageContents: string;</span><br><span class="line">&#125;</span><br><span class="line">interface TopNavState &#123;</span><br><span class="line">    userId: string;</span><br><span class="line">    pageTitle: string;</span><br><span class="line">    recentFiles: string[]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述代码可通过 lookup type 简化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">interface TopNavState = &#123;</span><br><span class="line">    userId: State[&#x27;userId&#x27;];</span><br><span class="line">    pageTitle: State[&#x27;pageTitle&#x27;]</span><br><span class="line">    recentFiles: State[&#x27;recentFiles&#x27;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用 mapped type 可进一步简化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type TopNavState = &#123;</span><br><span class="line">    [k in &#x27;userId&#x27; | &#x27;pageTitle&#x27; | &#x27;recentFiles&#x27;] : State[k]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再使用工具类进一步简化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type TopNavState = Pick&lt;State, &#x27;userId&#x27;, &#x27;pageTitle&#x27;, &#x27;rencentFiles&#x27;&gt;</span><br></pre></td></tr></table></figure>

<p>我们也可以利用 typeof 来进行类型传递</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function getUserInfo(userId:string)&#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    userId,</span><br><span class="line">    name,</span><br><span class="line">    age,</span><br><span class="line">    height,</span><br><span class="line">    weight,</span><br><span class="line">    favoriteColor</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">type UserInfo = ReturnType&lt;typeof getUserInfo&gt;</span><br></pre></td></tr></table></figure>

<p>编写 utility type 时，多多使用 generic constraint 保证实例化时的类型安全</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">interface Name &#123;</span><br><span class="line">    first: string;</span><br><span class="line">    last: string</span><br><span class="line">&#125;</span><br><span class="line">type Pick1&lt;T, K&gt;&#123;</span><br><span class="line">    [k in K]: T[k]</span><br><span class="line">&#125;</span><br><span class="line">type FirstLast = Pick1&lt;Name, &#x27;first&#x27;| &#x27;last&#x27;&gt;</span><br><span class="line">type FirstMiddle = Pick1&lt;Name, &#x27;first&#x27;, &#x27;middle&#x27;&gt; // 应该报错但没报错</span><br><span class="line">type Pick2&lt;T, K extends keyof T&gt; = &#123; // 添加泛型约束</span><br><span class="line">    [k in K]: T[K]</span><br><span class="line">&#125;</span><br><span class="line">type FirstMiddle = Pick2&lt;Name, &#x27;first&#x27;, &#x27;middle&#x27;&gt; // 正确的报错了</span><br></pre></td></tr></table></figure>

<h1 id="八、用-TypeScript-编写-React-的最佳实践"><a href="#八、用-TypeScript-编写-React-的最佳实践" class="headerlink" title="八、用 TypeScript 编写 React 的最佳实践"></a>八、用 TypeScript 编写 React 的最佳实践</h1><h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><p>React 的核心概念之一是组件。在这里，我们将引用 React v16.8 以后的标准组件，这意味着使用 Hook 而不是类的组件。</p>
<p>通常，一个基本的组件有很多需要关注的地方。让我们看一个例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import React from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">// 函数声明式写法</span><br><span class="line">function Heading(): React.ReactNode &#123;</span><br><span class="line">  return &lt;h1&gt;My Website Heading&lt;/h1&gt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 函数扩展式写法</span><br><span class="line">const OtherHeading: React.FC = () =&gt; &lt;h1&gt;My Website Heading&lt;/h1&gt;</span><br></pre></td></tr></table></figure>

<p>注意这里的关键区别。在第一个例子中，我们使用函数声明式写法，我们注明了这个函数返回值是 <code>React.ReactNode</code> 类型。相反，第二个例子使用了一个函数表达式。因为第二个实例返回一个函数，而不是一个值或表达式，所以我们我们注明了这个函数返回值是 <code>React.FC</code> 类型。</p>
<p>记住这两种方式可能会让人混淆。这主要取决于设计选择。无论您选择在项目中使用哪个，都要始终如一地使用它。</p>
<h2 id="Props"><a href="#Props" class="headerlink" title="Props"></a>Props</h2><p>我们将介绍的下一个核心概念是 Props。你可以使用 interface 或 type 来定义 Props 。让我们看另一个例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import React from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">interface Props &#123;</span><br><span class="line">  name: string;</span><br><span class="line">  color: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type OtherProps = &#123;</span><br><span class="line">  name: string;</span><br><span class="line">  color: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Notice here we&#x27;re using the function declaration with the interface Props</span><br><span class="line">function Heading(&#123; name, color &#125;: Props): React.ReactNode &#123;</span><br><span class="line">  return &lt;h1&gt;My Website Heading&lt;/h1&gt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Notice here we&#x27;re using the function expression with the type OtherProps</span><br><span class="line">const OtherHeading: React.FC&lt;OtherProps&gt; = (&#123; name, color &#125;) =&gt;</span><br><span class="line">  &lt;h1&gt;My Website Heading&lt;/h1&gt;</span><br></pre></td></tr></table></figure>

<p>关于 interface 或 type ，我们建议遵循 react-typescript-cheatsheet 社区提出的准则：</p>
<ul>
<li>在编写库或第三方环境类型定义时，始终将 interface 用于公共 API 的定义。</li>
<li>考虑为你的 React 组件的 State 和 Props 使用 type ，因为它更受约束。”</li>
</ul>
<p>让我们再看一个示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import React from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">type Props = &#123;</span><br><span class="line">   /** color to use for the background */</span><br><span class="line">  color?: string;</span><br><span class="line">   /** standard children prop: accepts any valid React Node */</span><br><span class="line">  children: React.ReactNode;</span><br><span class="line">   /** callback function passed to the onClick handler*/</span><br><span class="line">  onClick: ()  =&gt; void;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const Button: React.FC&lt;Props&gt; = (&#123; children, color = &#x27;tomato&#x27;, onClick &#125;) =&gt; &#123;</span><br><span class="line">   return &lt;button style=&#123;&#123; backgroundColor: color &#125;&#125; onClick=&#123;onClick&#125;&gt;&#123;children&#125;&lt;/button&gt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在此 <code>&lt;Button /&gt;</code> 组件中，我们为 Props 使用 type。每个 Props 上方都有简短的说明，以为其他开发人员提供更多背景信息。? 表示 Props 是可选的。<code>children props</code> 是一个 <code>React.ReactNode</code> 表示它还是一个 React 组件。</p>
<p>通常，在 React 和 TypeScript 项目中编写 Props 时，请记住以下几点：</p>
<ul>
<li>始终使用 TSDoc 标记为你的 Props 添加描述性注释 <code>/** comment */</code>。</li>
<li>无论你为组件 Props 使用 type 还是 interface ，都应始终使用它们。</li>
<li>如果 props 是可选的，请适当处理或使用默认值。</li>
</ul>
<h2 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h2><p>幸运的是，当使用 Hook 时， TypeScript 类型推断工作得很好。这意味着你没有什么好担心的。举个例子:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// `value` is inferred as a string</span><br><span class="line">// `setValue` is inferred as (newValue: string) =&gt; void</span><br><span class="line">const [value, setValue] = useState(&#x27;&#x27;)</span><br></pre></td></tr></table></figure>

<p>TypeScript 推断出 useState 钩子给出的值。这是一个 React 和 TypeScript 协同工作的成果。</p>
<p>在极少数情况下，你需要使用一个空值初始化 Hook ，可以使用泛型并传递联合以正确键入 Hook 。查看此实例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">type User = &#123;</span><br><span class="line">  email: string;</span><br><span class="line">  id: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// the generic is the &lt; &gt;</span><br><span class="line">// the union is the User | null</span><br><span class="line">// together, TypeScript knows, &quot;Ah, user can be User or null&quot;.</span><br><span class="line">const [user, setUser] = useState&lt;User | null&gt;(null);</span><br></pre></td></tr></table></figure>

<p>下面是一个使用 useReducer 的例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">type AppState = &#123;&#125;;</span><br><span class="line">type Action =</span><br><span class="line">  | &#123; type: &quot;SET_ONE&quot;; payload: string &#125;</span><br><span class="line">  | &#123; type: &quot;SET_TWO&quot;; payload: number &#125;;</span><br><span class="line"></span><br><span class="line">export function reducer(state: AppState, action: Action): AppState &#123;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line">    case &quot;SET_ONE&quot;:</span><br><span class="line">      return &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        one: action.payload // `payload` is string</span><br><span class="line">      &#125;;</span><br><span class="line">    case &quot;SET_TWO&quot;:</span><br><span class="line">      return &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        two: action.payload // `payload` is number</span><br><span class="line">      &#125;;</span><br><span class="line">    default:</span><br><span class="line">      return state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可见，Hooks 并没有为 React 和 TypeScript 项目增加太多复杂性。</p>
<h2 id="常见用例"><a href="#常见用例" class="headerlink" title="常见用例"></a>常见用例</h2><h3 id="处理表单事件"><a href="#处理表单事件" class="headerlink" title="处理表单事件"></a>处理表单事件</h3><p>最常见的情况之一是 onChange 在表单的输入字段上正确键入使用的。这是一个例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import React from &#x27;react&#x27;</span><br><span class="line"></span><br><span class="line">const MyInput = () =&gt; &#123;</span><br><span class="line">  const [value, setValue] = React.useState(&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">  // 事件类型是“ChangeEvent”</span><br><span class="line">  // 我们将 “HTMLInputElement” 传递给 input</span><br><span class="line">  function onChange(e: React.ChangeEvent&lt;HTMLInputElement&gt;) &#123;</span><br><span class="line">    setValue(e.target.value)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return &lt;input value=&#123;value&#125; onChange=&#123;onChange&#125; id=&quot;input-example&quot;/&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="扩展组件的-Props"><a href="#扩展组件的-Props" class="headerlink" title="扩展组件的 Props"></a>扩展组件的 Props</h3><p>有时，你希望获取为一个组件声明的 Props，并对它们进行扩展，以便在另一个组件上使用它们。但是你可能想要修改一两个属性。还记得我们如何看待两种类型组件 Props、type 或 interface 的方法吗?取决于你使用的组件决定了你如何扩展组件 Props 。让我们先看看如何使用 type:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">type ButtonProps = &#123;</span><br><span class="line">    /** the background color of the button */</span><br><span class="line">    color: string;</span><br><span class="line">    /** the text to show inside the button */</span><br><span class="line">    text: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type ContainerProps = ButtonProps &amp; &#123;</span><br><span class="line">    /** the height of the container (value used with &#x27;px&#x27;) */</span><br><span class="line">    height: number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const Container: React.FC&lt;ContainerProps&gt; = (&#123; color, height, width, text &#125;) =&gt; &#123;</span><br><span class="line">  return &lt;div style=&#123;&#123; backgroundColor: color, height: `$&#123;height&#125;px` &#125;&#125;&gt;&#123;text&#125;&lt;/div&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果你使用 interface 来声明 props，那么我们可以使用关键字 extends 从本质上“扩展”该接口，但要进行一些修改：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">interface ButtonProps &#123;</span><br><span class="line">    /** the background color of the button */</span><br><span class="line">    color: string;</span><br><span class="line">    /** the text to show inside the button */</span><br><span class="line">    text: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface ContainerProps extends ButtonProps &#123;</span><br><span class="line">    /** the height of the container (value used with &#x27;px&#x27;) */</span><br><span class="line">    height: number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const Container: React.FC&lt;ContainerProps&gt; = (&#123; color, height, width, text &#125;) =&gt; &#123;</span><br><span class="line">  return &lt;div style=&#123;&#123; backgroundColor: color, height: `$&#123;height&#125;px` &#125;&#125;&gt;&#123;text&#125;&lt;/div&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>两种方法都可以解决问题。由您决定使用哪个。就个人而言，扩展 interface 更具可读性，但最终取决于你和你的团队。</p>
<h1 id="九、编译上下文"><a href="#九、编译上下文" class="headerlink" title="九、编译上下文"></a>九、编译上下文</h1><h2 id="tsconfig-json-的作用"><a href="#tsconfig-json-的作用" class="headerlink" title="tsconfig.json 的作用"></a>tsconfig.json 的作用</h2><ul>
<li>用于标识 TypeScript 项目的根路径；</li>
<li>用于配置 TypeScript 编译器；</li>
<li>用于指定编译的文件。</li>
</ul>
<h2 id="tsconfig-json-重要字段"><a href="#tsconfig-json-重要字段" class="headerlink" title="tsconfig.json 重要字段"></a>tsconfig.json 重要字段</h2><ul>
<li>files - 设置要编译的文件的名称；</li>
<li>include - 设置需要进行编译的文件，支持路径模式匹配；</li>
<li>exclude - 设置无需进行编译的文件，支持路径模式匹配；</li>
<li>compilerOptions - 设置与编译流程相关的选项。</li>
</ul>
<h2 id="compilerOptions-选项"><a href="#compilerOptions-选项" class="headerlink" title="compilerOptions 选项"></a>compilerOptions 选项</h2><p>compilerOptions 支持很多选项，常见的有 baseUrl、 target、baseUrl、 moduleResolution 和 lib 等。</p>
<p>compilerOptions 每个选项的详细说明如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;compilerOptions&quot;: &#123;</span><br><span class="line"></span><br><span class="line">    /* 基本选项 */</span><br><span class="line">    &quot;target&quot;: &quot;es5&quot;,                       // 指定 ECMAScript 目标版本: &#x27;ES3&#x27; (default), &#x27;ES5&#x27;, &#x27;ES6&#x27;/&#x27;ES2015&#x27;, &#x27;ES2016&#x27;, &#x27;ES2017&#x27;, or &#x27;ESNEXT&#x27;</span><br><span class="line">    &quot;module&quot;: &quot;commonjs&quot;,                  // 指定使用模块: &#x27;commonjs&#x27;, &#x27;amd&#x27;, &#x27;system&#x27;, &#x27;umd&#x27; or &#x27;es2015&#x27;</span><br><span class="line">    &quot;lib&quot;: [],                             // 指定要包含在编译中的库文件</span><br><span class="line">    &quot;allowJs&quot;: true,                       // 允许编译 javascript 文件</span><br><span class="line">    &quot;checkJs&quot;: true,                       // 报告 javascript 文件中的错误</span><br><span class="line">    &quot;jsx&quot;: &quot;preserve&quot;,                     // 指定 jsx 代码的生成: &#x27;preserve&#x27;, &#x27;react-native&#x27;, or &#x27;react&#x27;</span><br><span class="line">    &quot;declaration&quot;: true,                   // 生成相应的 &#x27;.d.ts&#x27; 文件</span><br><span class="line">    &quot;sourceMap&quot;: true,                     // 生成相应的 &#x27;.map&#x27; 文件</span><br><span class="line">    &quot;outFile&quot;: &quot;./&quot;,                       // 将输出文件合并为一个文件</span><br><span class="line">    &quot;outDir&quot;: &quot;./&quot;,                        // 指定输出目录</span><br><span class="line">    &quot;rootDir&quot;: &quot;./&quot;,                       // 用来控制输出目录结构 --outDir.</span><br><span class="line">    &quot;removeComments&quot;: true,                // 删除编译后的所有的注释</span><br><span class="line">    &quot;noEmit&quot;: true,                        // 不生成输出文件</span><br><span class="line">    &quot;importHelpers&quot;: true,                 // 从 tslib 导入辅助工具函数</span><br><span class="line">    &quot;isolatedModules&quot;: true,               // 将每个文件做为单独的模块 （与 &#x27;ts.transpileModule&#x27; 类似）.</span><br><span class="line"></span><br><span class="line">    /* 严格的类型检查选项 */</span><br><span class="line">    &quot;strict&quot;: true,                        // 启用所有严格类型检查选项</span><br><span class="line">    &quot;noImplicitAny&quot;: true,                 // 在表达式和声明上有隐含的 any类型时报错</span><br><span class="line">    &quot;strictNullChecks&quot;: true,              // 启用严格的 null 检查</span><br><span class="line">    &quot;noImplicitThis&quot;: true,                // 当 this 表达式值为 any 类型的时候，生成一个错误</span><br><span class="line">    &quot;alwaysStrict&quot;: true,                  // 以严格模式检查每个模块，并在每个文件里加入 &#x27;use strict&#x27;</span><br><span class="line"></span><br><span class="line">    /* 额外的检查 */</span><br><span class="line">    &quot;noUnusedLocals&quot;: true,                // 有未使用的变量时，抛出错误</span><br><span class="line">    &quot;noUnusedParameters&quot;: true,            // 有未使用的参数时，抛出错误</span><br><span class="line">    &quot;noImplicitReturns&quot;: true,             // 并不是所有函数里的代码都有返回值时，抛出错误</span><br><span class="line">    &quot;noFallthroughCasesInSwitch&quot;: true,    // 报告 switch 语句的 fallthrough 错误。（即，不允许 switch 的 case 语句贯穿）</span><br><span class="line"></span><br><span class="line">    /* 模块解析选项 */</span><br><span class="line">    &quot;moduleResolution&quot;: &quot;node&quot;,            // 选择模块解析策略： &#x27;node&#x27; (Node.js) or &#x27;classic&#x27; (TypeScript pre-1.6)</span><br><span class="line">    &quot;baseUrl&quot;: &quot;./&quot;,                       // 用于解析非相对模块名称的基目录</span><br><span class="line">    &quot;paths&quot;: &#123;&#125;,                           // 模块名到基于 baseUrl 的路径映射的列表</span><br><span class="line">    &quot;rootDirs&quot;: [],                        // 根文件夹列表，其组合内容表示项目运行时的结构内容</span><br><span class="line">    &quot;typeRoots&quot;: [],                       // 包含类型声明的文件列表</span><br><span class="line">    &quot;types&quot;: [],                           // 需要包含的类型声明文件名列表</span><br><span class="line">    &quot;allowSyntheticDefaultImports&quot;: true,  // 允许从没有设置默认导出的模块中默认导入。</span><br><span class="line"></span><br><span class="line">    /* Source Map Options */</span><br><span class="line">    &quot;sourceRoot&quot;: &quot;./&quot;,                    // 指定调试器应该找到 TypeScript 文件而不是源文件的位置</span><br><span class="line">    &quot;mapRoot&quot;: &quot;./&quot;,                       // 指定调试器应该找到映射文件而不是生成文件的位置</span><br><span class="line">    &quot;inlineSourceMap&quot;: true,               // 生成单个 soucemaps 文件，而不是将 sourcemaps 生成不同的文件</span><br><span class="line">    &quot;inlineSources&quot;: true,                 // 将代码与 sourcemaps 生成到一个文件中，要求同时设置了 --inlineSourceMap 或 --sourceMap 属性</span><br><span class="line"></span><br><span class="line">    /* 其他选项 */</span><br><span class="line">    &quot;experimentalDecorators&quot;: true,        // 启用装饰器</span><br><span class="line">    &quot;emitDecoratorMetadata&quot;: true          // 为装饰器提供元数据的支持</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tsconfig.json 配置文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;compilerOptions&quot;: &#123;</span><br><span class="line">    &quot;target&quot;: &quot;es5&quot;, // 指定 ECMAScript 版本</span><br><span class="line">    &quot;lib&quot;: [</span><br><span class="line">      &quot;dom&quot;,</span><br><span class="line">      &quot;dom.iterable&quot;,</span><br><span class="line">      &quot;esnext&quot;</span><br><span class="line">    ], // 要包含在编译中的依赖库文件列表</span><br><span class="line">    &quot;allowJs&quot;: true, // 允许编译 JavaScript 文件</span><br><span class="line">    &quot;skipLibCheck&quot;: true, // 跳过所有声明文件的类型检查</span><br><span class="line">    &quot;esModuleInterop&quot;: true, // 禁用命名空间引用 (import * as fs from &quot;fs&quot;) 启用 CJS/AMD/UMD 风格引用 (import fs from &quot;fs&quot;)</span><br><span class="line">    &quot;allowSyntheticDefaultImports&quot;: true, // 允许从没有默认导出的模块进行默认导入</span><br><span class="line">    &quot;strict&quot;: true, // 启用所有严格类型检查选项</span><br><span class="line">    &quot;forceConsistentCasingInFileNames&quot;: true, // 不允许对同一个文件使用不一致格式的引用</span><br><span class="line">    &quot;module&quot;: &quot;esnext&quot;, // 指定模块代码生成</span><br><span class="line">    &quot;moduleResolution&quot;: &quot;node&quot;, // 使用 Node.js 风格解析模块</span><br><span class="line">    &quot;resolveJsonModule&quot;: true, // 允许使用 .json 扩展名导入的模块</span><br><span class="line">    &quot;noEmit&quot;: true, // 不输出(意思是不编译代码，只执行类型检查)</span><br><span class="line">    &quot;jsx&quot;: &quot;react&quot;, // 在.tsx文件中支持JSX</span><br><span class="line">    &quot;sourceMap&quot;: true, // 生成相应的.map文件</span><br><span class="line">    &quot;declaration&quot;: true, // 生成相应的.d.ts文件</span><br><span class="line">    &quot;noUnusedLocals&quot;: true, // 报告未使用的本地变量的错误</span><br><span class="line">    &quot;noUnusedParameters&quot;: true, // 报告未使用参数的错误</span><br><span class="line">    &quot;experimentalDecorators&quot;: true, // 启用对ES装饰器的实验性支持</span><br><span class="line">    &quot;incremental&quot;: true, // 通过从以前的编译中读取/写入信息到磁盘上的文件来启用增量编译</span><br><span class="line">    &quot;noFallthroughCasesInSwitch&quot;: true </span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;include&quot;: [</span><br><span class="line">    &quot;src/**/*&quot; // *** TypeScript文件应该进行类型检查 ***</span><br><span class="line">  ],</span><br><span class="line">  &quot;exclude&quot;: [&quot;node_modules&quot;, &quot;build&quot;] // *** 不进行类型检查的文件 ***</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="十、参考资料"><a href="#十、参考资料" class="headerlink" title="十、参考资料"></a>十、参考资料</h2><ul>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1641493?from=article.detail.1595718">了不起的 TypeScript 入门教程</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.staleclosure.com/effective-typescript/">Effective Typescript</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_40906515/article/details/106798727">用 TypeScript 编写 React 的最佳实践</a></li>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1595718">TypeScript keyof 操作符</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/16/Vue3%E6%9C%80%E6%96%B0%E7%9A%8415%E4%B8%AA%E5%B8%B8%E7%94%A8Api/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/portal.jpg">
      <meta itemprop="name" content="Bruce Chen">
      <meta itemprop="description" content="It's better to burn out than to fade away.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Chen's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/16/Vue3%E6%9C%80%E6%96%B0%E7%9A%8415%E4%B8%AA%E5%B8%B8%E7%94%A8Api/" class="post-title-link" itemprop="url">Vue3最新的15个常用Api</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-12-16 14:17:50 / 修改时间：14:23:32" itemprop="dateCreated datePublished" datetime="2022-12-16T14:17:50+08:00">2022-12-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E6%80%BB%E7%BB%93/" itemprop="url" rel="index"><span itemprop="name">前端框架总结</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Vue2 每次都把整个 Vue 导入，例如 Vue2 的 main.js 文件中的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &#x27;vue&#x27;</span><br><span class="line">import App from &#x27;./App.vue&#x27;</span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = false</span><br><span class="line"></span><br><span class="line">new Vue(&#123;</span><br><span class="line">  render: h =&gt; h(App)</span><br><span class="line">&#125;).$mount(&#x27;#app&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>但很明显我们的项目中不可能用到 Vue 所有的 API，因此很多模块其实是没有用的</p>
<p>那么在 Vue3 中，对外暴露了很多的 API 供开发者使用，我们可以根据自己的需求，将所需要的 API 从 Vue 中导入。例如 main.js 中的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import &#123; createApp &#125; from &#x27;vue&#x27;;</span><br><span class="line">import App from &#x27;./App.vue&#x27;</span><br><span class="line"></span><br><span class="line">createApp(App).mount(&#x27;#app&#x27;)</span><br></pre></td></tr></table></figure>

<p>利用了 import 和 export 的导入导出语法，实现了按需打包模块的功能，项目打包后的文件体积明显小了很多</p>
<p>这也是我们本文需要对 Vue3 API 进行详细了解的原因</p>
<h2 id="（1）setup"><a href="#（1）setup" class="headerlink" title="（1）setup"></a>（1）setup</h2><p>setup 函数也是 Composition API 的入口函数，我们的变量、方法都是在该函数里定义的，来看一下使用方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">  	&lt;p&gt;&#123;&#123; number &#125;&#125;&lt;/p&gt;</span><br><span class="line">  	&lt;button @click=&quot;add&quot;&gt;增加&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 1. 从 vue 中引入 ref 函数</span><br><span class="line">import &#123;ref&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">  	// 2. 用 ref 函数包装一个响应式变量 number</span><br><span class="line">    let number = ref(0)</span><br><span class="line"></span><br><span class="line">    // 3. 设定一个方法</span><br><span class="line">    function add() &#123;</span><br><span class="line">    	// number是被ref函数包装过了的，其值保存在.value中</span><br><span class="line">		number.value ++</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    // 4. 将 number 和 add 返回出去，供template中使用</span><br><span class="line">    return &#123;number, add&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>上述代码中用到了 ref 函数，下面会详细讲解，在这里你只需要理解它的作用是包装一个响应式的数据即可，并且你可以将 ref 函数包装过的变量看作是 Vue2 data 中的变量</p>
<p>这样就简单实现了一个点击按钮数字加 1 的功能</p>
<hr>
<p>在 Vue2 中，我们访问 data 或 props 中的变量，都是通过类似 this.number 这样的形式去获取的，但要特别注意的是，在 setup 中，this 指向的是 undefined，也就是说不能再向 Vue2 一样通过 this 去获取变量了</p>
<p>那么到底该如何获取到 props 中的数据呢？</p>
<p>其实 setup 函数还有两个参数，分别是 props 、context，前者存储着定义当前组件允许外界传递过来的参数名称以及对应的值；后者是一个上下文对象，能从中访问到 attr 、emit 、slots</p>
<p>其中 emit 就是我们熟悉的 Vue2 中与父组件通信的方法，可以直接拿来调用</p>
<h2 id="（2）生命周期"><a href="#（2）生命周期" class="headerlink" title="（2）生命周期"></a>（2）生命周期</h2><p>Vue2 中有 beforeCreate 、created 、beforeMount 、mounted 、beforeUpdate 等生命周期函数</p>
<p>而在 Vue3 中，这些生命周期部分有所变化，并且调用的方式也有所改变，下面放上一张变化图来简单了解一下</p>
<table>
<thead>
<tr>
<th>Vue2</th>
<th>Vue3</th>
</tr>
</thead>
<tbody><tr>
<td>beforeCreate</td>
<td>setup</td>
</tr>
<tr>
<td>created</td>
<td>setup</td>
</tr>
<tr>
<td>beforeMount</td>
<td>onBeforeMount</td>
</tr>
<tr>
<td>mounted</td>
<td>onMounted</td>
</tr>
<tr>
<td>beforeUpdate</td>
<td>onBeforeUpdate</td>
</tr>
<tr>
<td>updated</td>
<td>onUpdated</td>
</tr>
<tr>
<td>beforeDestory</td>
<td>onBeforeUnmount</td>
</tr>
<tr>
<td>destoryed</td>
<td>onUnmounted</td>
</tr>
</tbody></table>
<p>Vue3 的这些生命周期调用也很简单，同样是先从 vue 中导入，再进行直接调用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 1. 从 vue 中引入 多个生命周期函数</span><br><span class="line">import &#123;onBeforeMount, onMounted, onBeforeUpdate, onUpdated, onBeforeUnmount, unMounted&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">	onBeforeMount(() =&gt; &#123;</span><br><span class="line">		// 在挂载前执行某些代码</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	onMounted(() =&gt; &#123;</span><br><span class="line">		// 在挂载后执行某些代码</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	onBeforeUpdate(() =&gt; &#123;</span><br><span class="line">		// 在更新前前执行某些代码</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	onUpdated(() =&gt; &#123;</span><br><span class="line">		// 在更新后执行某些代码</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	onBeforeUnmount(() =&gt; &#123;</span><br><span class="line">		// 在组件销毁前执行某些代码</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	onUnmounted(() =&gt; &#123;</span><br><span class="line">		// 在组件销毁后执行某些代码</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">    return &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="（3）reactive"><a href="#（3）reactive" class="headerlink" title="（3）reactive"></a>（3）reactive</h2><p>reactive 方法是用来创建一个响应式的数据对象，该 API 也很好地解决了 Vue2 通过 defineProperty 实现数据响应式的缺陷</p>
<p>用法很简单，只需将数据作为参数传入即可，代码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">  	&lt;!-- 4. 访问响应式数据对象中的 count  --&gt;</span><br><span class="line">  	&#123;&#123; state.count &#125;&#125;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 1. 从 vue 中导入 reactive</span><br><span class="line">import &#123;reactive&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">  	// 2. 创建响应式的数据对象</span><br><span class="line">	const state = reactive(&#123;count: 3&#125;)</span><br><span class="line"></span><br><span class="line">	// 3. 将响应式数据对象state return 出去，供template使用</span><br><span class="line">    return &#123;state&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="（4）ref"><a href="#（4）ref" class="headerlink" title="（4）ref"></a>（4）ref</h2><p>在介绍 setup 函数时，我们使用了 ref 函数包装了一个响应式的数据对象，这里表面上看上去跟 reactive 好像功能一模一样啊，确实差不多，因为 ref 就是通过 reactive 包装了一个对象 ，然后是将值传给该对象中的 value 属性，这也就解释了为什么每次访问时我们都需要加上 .value</p>
<p>我们可以简单地把 ref(obj) 理解为这个样子 reactive({value: obj})</p>
<p>这里我们写一段代码来具体看一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;ref, reactive&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;App&#x27;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">  	const obj = &#123;count: 3&#125;</span><br><span class="line">  	const state1 = ref(obj)</span><br><span class="line">  	const state2 = reactive(obj)</span><br><span class="line"></span><br><span class="line">	console.log(state1)</span><br><span class="line">	console.log(state2)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>来看一下打印结果<br><img src="https://img-blog.csdnimg.cn/20201118122406844.png?x-oss-process=image" alt="image"></p>
<blockquote>
<p>注意： 这里指的 .value 是在 setup 函数中访问 ref 包装后的对象时才需要加的，在 template 模板中访问时是不需要的，因为在编译时，会自动识别其是否为 ref 包装过的</p>
</blockquote>
<p>那么我们到底该如何选择 ref 和 reactive 呢？</p>
<p><strong>建议：</strong></p>
<ol>
<li>基本类型值（String 、Number 、Boolean 等）或单值对象（类似像 {count: 3} 这样只有一个属性值的对象）使用 ref</li>
<li>引用类型值（Object 、Array）使用 reactive</li>
</ol>
<h2 id="（5）toRef"><a href="#（5）toRef" class="headerlink" title="（5）toRef"></a>（5）toRef</h2><p>toRef 是将某个对象中的某个值转化为响应式数据，其接收两个参数，第一个参数为 obj 对象；第二个参数为对象中的属性名</p>
<p>代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">// 1. 导入 toRef</span><br><span class="line">import &#123;toRef&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const obj = &#123;count: 3&#125;</span><br><span class="line">        // 2. 将 obj 对象中属性count的值转化为响应式数据</span><br><span class="line">        const state = toRef(obj, &#x27;count&#x27;)</span><br><span class="line"></span><br><span class="line">		// 3. 将toRef包装过的数据对象返回供template使用</span><br><span class="line">        return &#123;state&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>但其实表面上看上去 toRef 这个 API 好像非常的没用，因为这个功能也可以用 ref 实现，代码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">// 1. 导入 ref</span><br><span class="line">import &#123;ref&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const obj = &#123;count: 3&#125;</span><br><span class="line">        // 2. 将 obj 对象中属性count的值转化为响应式数据</span><br><span class="line">        const state = ref(obj.count)</span><br><span class="line"></span><br><span class="line">		// 3. 将ref包装过的数据对象返回供template使用</span><br><span class="line">        return &#123;state&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>乍一看好像还真是，其实这两者是有区别的，我们可以通过一个案例来比较一下，代码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; state1 &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;button @click=&quot;add1&quot;&gt;增加&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">	&lt;p&gt;&#123;&#123; state2 &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;button @click=&quot;add2&quot;&gt;增加&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;ref, toRef&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const obj = &#123;count: 3&#125;</span><br><span class="line">        const state1 = ref(obj.count)</span><br><span class="line">        const state2 = toRef(obj, &#x27;count&#x27;)</span><br><span class="line"></span><br><span class="line">        function add1() &#123;</span><br><span class="line">            state1.value ++</span><br><span class="line">            console.log(&#x27;原始值：&#x27;, obj);</span><br><span class="line">            console.log(&#x27;响应式数据对象：&#x27;, state1);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">		function add2() &#123;</span><br><span class="line">            state2.value ++</span><br><span class="line">            console.log(&#x27;原始值：&#x27;, obj);</span><br><span class="line">            console.log(&#x27;响应式数据对象：&#x27;, state2);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return &#123;state1, state2, add1, add2&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>我们分别用 ref 和 toRef 将 obj 中的 count 转化为响应式，并声明了两个方法分别使 count 值增加，每次增加后打印一下原始值 obj 和被包装过的响应式数据对象，同时还要看看视图的变化</p>
<p><strong>ref：</strong></p>
<p><img src="https://img-blog.csdnimg.cn/20201118131536584.gif#pic_center" alt="image"></p>
<p>可以看到，在对响应式数据的值进行 +1 操作后，视图改变了，原始值未改变，响应式数据对象的值也改变了，这说明 ref 是对原数据的一个拷贝，不会影响到原始值，同时响应式数据对象值改变后会同步更新视图</p>
<p><strong>toRef：</strong></p>
<p><img src="https://img-blog.csdnimg.cn/20201118131948827.gif#pic_center" alt="image"></p>
<p>可以看到，在对响应式数据的值进行 +1 操作后，视图未发生改变，原始值改变了，响应式数据对象的值也改变了，这说明 toRef 是对原数据的一个引用，会影响到原始值，但是响应式数据对象值改变后会不会更新视图</p>
<p>总结：</p>
<ul>
<li>ref 是对传入数据的拷贝；toRef 是对传入数据的引用</li>
<li>ref 的值改变会更新视图；toRef 的值改变不会更新视图</li>
</ul>
<h2 id="（6）toRefs"><a href="#（6）toRefs" class="headerlink" title="（6）toRefs"></a>（6）toRefs</h2><p>了解完 toRef 后，就很好理解 toRefs 了，其作用就是将传入的对象里所有的属性的值都转化为响应式数据对象，该函数支持一个参数，即 obj 对象</p>
<p>我们来看一下它的基本使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">// 1. 导入 toRefs</span><br><span class="line">import &#123;toRefs&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const obj = &#123;</span><br><span class="line">			name: &#x27;前端印象&#x27;,</span><br><span class="line">			age: 22,</span><br><span class="line">			gender: 0</span><br><span class="line">		&#125;</span><br><span class="line">        // 2. 将 obj 对象中属性count的值转化为响应式数据</span><br><span class="line">        const state = toRefs(obj)</span><br><span class="line"></span><br><span class="line">		// 3. 打印查看一下</span><br><span class="line">		console.log(state)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>打印结果如下：<br><img src="https://img-blog.csdnimg.cn/20201118132812793.png#pic_center" alt="image"></p>
<p>返回的是一个对象，对象里包含了每一个包装过后的响应式数据对象</p>
<h2 id="（7）shallowReactive"><a href="#（7）shallowReactive" class="headerlink" title="（7）shallowReactive"></a>（7）shallowReactive</h2><p>听这个 API 的名称就知道，这是一个渐层的 reactive，难道意思就是原本的 reactive 是深层的呗，没错，这是一个用于性能优化的 API</p>
<p>其实将 obj 作为参数传递给 reactive 生成响应式数据对象时，若 obj 的层级不止一层，那么会将每一层都用 Proxy 包装一次，我们来验证一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;reactive&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const obj = &#123;</span><br><span class="line">			a: 1,</span><br><span class="line">			first: &#123;</span><br><span class="line">				b: 2,</span><br><span class="line">				second: &#123;</span><br><span class="line">					c: 3</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">        const state = reactive(obj)</span><br><span class="line"></span><br><span class="line">		console.log(state)</span><br><span class="line">		console.log(state.first)</span><br><span class="line">		console.log(state.first.second)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>来看一下打印结果：</p>
<p><img src="https://img-blog.csdnimg.cn/20201118134158778.png#pic_center" alt="image"></p>
<p>设想一下如果一个对象层级比较深，那么每一层都用 Proxy 包装后，对于性能是非常不友好的</p>
<p>接下来我们再来看看 shallowReactive</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;shallowReactive&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const obj = &#123;</span><br><span class="line">			a: 1,</span><br><span class="line">			first: &#123;</span><br><span class="line">				b: 2,</span><br><span class="line">				second: &#123;</span><br><span class="line">					c: 3</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">        const state = shallowReactive(obj)</span><br><span class="line"></span><br><span class="line">		console.log(state)</span><br><span class="line">		console.log(state.first)</span><br><span class="line">		console.log(state.first.second)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>来看一下打印结果：</p>
<p><img src="https://img-blog.csdnimg.cn/20201118134358346.png#pic_center" alt="image"></p>
<p>结果非常的明了了，只有第一层被 Proxy 处理了，也就是说只有修改第一层的值时，才会响应式更新，代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; state.a &#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; state.first.b &#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; state.first.second.c &#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;button @click=&quot;change1&quot;&gt;改变1&lt;/button&gt;</span><br><span class="line">	&lt;button @click=&quot;change2&quot;&gt;改变2&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;shallowReactive&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const obj = &#123;</span><br><span class="line">			a: 1,</span><br><span class="line">			first: &#123;</span><br><span class="line">				b: 2,</span><br><span class="line">				second: &#123;</span><br><span class="line">					c: 3</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">        const state = shallowReactive(obj)</span><br><span class="line"></span><br><span class="line">		function change1() &#123;</span><br><span class="line">			state.a = 7</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		function change2() &#123;</span><br><span class="line">			state.first.b = 8</span><br><span class="line">			state.first.second.c = 9</span><br><span class="line">			console.log(state);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		return &#123;state&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>来看一下具体过程：</p>
<p><img src="https://img-blog.csdnimg.cn/2020111814184662.gif#pic_center" alt="image"></p>
<p>首先我们点击了第二个按钮，改变了第二层的 b 和第三层的 c，虽然值发生了改变，但是视图却没有进行更新；</p>
<p>当我们点击了第一个按钮，改变了第一层的 a 时，整个视图进行了更新；</p>
<p>由此可说明，shallowReactive 监听了第一层属性的值，一旦发生改变，则更新视图</p>
<h2 id="（8）shallowRef"><a href="#（8）shallowRef" class="headerlink" title="（8）shallowRef"></a>（8）shallowRef</h2><p>这是一个浅层的 ref，与 shallowReactive 一样是拿来做性能优化的</p>
<p>shallowReactive 是监听对象第一层的数据变化用于驱动视图更新，那么 shallowRef 则是监听 .value 的值的变化来更新视图的</p>
<p>我们来看一下具体代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; state.a &#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; state.first.b &#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; state.first.second.c &#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;button @click=&quot;change1&quot;&gt;改变1&lt;/button&gt;</span><br><span class="line">	&lt;button @click=&quot;change2&quot;&gt;改变2&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;shallowRef&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const obj = &#123;</span><br><span class="line">			a: 1,</span><br><span class="line">			first: &#123;</span><br><span class="line">				b: 2,</span><br><span class="line">				second: &#123;</span><br><span class="line">					c: 3</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		const state = shallowRef(obj)</span><br><span class="line">		console.log(state);</span><br><span class="line"></span><br><span class="line">		function change1() &#123;</span><br><span class="line">			// 直接将state.value重新赋值</span><br><span class="line">			state.value = &#123;</span><br><span class="line">				a: 7,</span><br><span class="line">				first: &#123;</span><br><span class="line">					b: 8,</span><br><span class="line">					second: &#123;</span><br><span class="line">						c: 9</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		function change2() &#123;</span><br><span class="line">			state.value.first.b = 8</span><br><span class="line">            state.value.first.second.c = 9</span><br><span class="line">            console.log(state);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		return &#123;state, change1, change2&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>首先看一下被 shallowRef 包装过后是怎样的结构</p>
<p><img src="https://img-blog.csdnimg.cn/20201119112420368.png?x-oss-process=image" alt="image"></p>
<p>然后再来看看改变其值会有什么变化</p>
<p><img src="https://img-blog.csdnimg.cn/20201119112840682.gif#pic_center" alt="image"></p>
<p>我们先点击了第二个按钮，发现数据确实被改变了，但是视图并没随之更新；</p>
<p>于是点击了第一个按钮，即将整个 .value 重新赋值了，视图就立马更新了</p>
<p>这么一看，未免也太过麻烦了，改个数据还要重新赋值，不要担心，此时我们可以用到另一个 API，叫做 triggerRef ，调用它就可以立马更新视图，其接收一个参数 state ，即需要更新的 ref 对象</p>
<p>我们来使用一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; state.a &#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; state.first.b &#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; state.first.second.c &#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;button @click=&quot;change&quot;&gt;改变&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;shallowRef, triggerRef&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const obj = &#123;</span><br><span class="line">			a: 1,</span><br><span class="line">			first: &#123;</span><br><span class="line">				b: 2,</span><br><span class="line">				second: &#123;</span><br><span class="line">					c: 3</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		const state = shallowRef(obj)</span><br><span class="line">		console.log(state);</span><br><span class="line"></span><br><span class="line">		function change() &#123;</span><br><span class="line">			state.value.first.b = 8</span><br><span class="line">            state.value.first.second.c = 9</span><br><span class="line">            // 修改值后立即驱动视图更新</span><br><span class="line">            triggerRef(state)</span><br><span class="line">            console.log(state);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		return &#123;state, change&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>我们来看一下具体过程<br><img src="https://img-blog.csdnimg.cn/20201119113821279.gif#pic_center" alt="image"></p>
<p>可以看到，我们没有给 .value 重新赋值，只是在修改值后，调用了 triggerRef 就实现了视图的更新</p>
<h2 id="（9）toRaw"><a href="#（9）toRaw" class="headerlink" title="（9）toRaw"></a>（9）toRaw</h2><p>toRaw 方法是用于获取 ref 或 reactive 对象的原始数据的</p>
<p>先来看一段代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; state.name &#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; state.age &#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;button @click=&quot;change&quot;&gt;改变&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;reactive&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const obj = &#123;</span><br><span class="line">			name: &#x27;前端印象&#x27;,</span><br><span class="line">			age: 22</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		const state = reactive(obj)</span><br><span class="line"></span><br><span class="line">		function change() &#123;</span><br><span class="line">			state.age = 90</span><br><span class="line">			console.log(obj); // 打印原始数据obj</span><br><span class="line">			console.log(state);  // 打印 reactive对象</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		return &#123;state, change&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>来看看具体过程</p>
<p><img src="https://img-blog.csdnimg.cn/20201119120334341.gif#pic_center" alt="image"></p>
<p>我们改变了 reactive 对象中的数据，于是看到原始数据 obj 和被 reactive 包装过的对象的值都发生了变化，由此我们可以看出，这两者是一个引用关系</p>
<p>那么此时我们就想了，那如果直接改变原始数据 obj 的值，会怎么样呢？答案是： reactive 的值也会跟着改变，但是视图不会更新</p>
<p>由此可见，当我们想修改数据，但不想让视图更新时，可以选择直接修改原始数据上的值，因此需要先获取到原始数据，我们可以使用 Vue3 提供的 toRaw 方法</p>
<p>toRaw 接收一个参数，即 ref 对象或 reactive 对象</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;reactive, toRaw&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const obj = &#123;</span><br><span class="line">			name: &#x27;前端印象&#x27;,</span><br><span class="line">			age: 22</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		const state = reactive(obj)</span><br><span class="line">		const raw = toRaw(state)</span><br><span class="line"></span><br><span class="line">		console.log(obj === raw)   // true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>上述代码就证明了 toRaw 方法从 reactive 对象中获取到的是原始数据，因此我们就可以很方便的通过修改原始数据的值而不更新视图来做一些性能优化了</p>
<blockquote>
<p>注意： 补充一句，当 toRaw 方法接收的参数是 ref 对象时，需要加上 .value 才能获取到原始数据对象</p>
</blockquote>
<h2 id="（10）markRaw"><a href="#（10）markRaw" class="headerlink" title="（10）markRaw"></a>（10）markRaw</h2><p>markRaw 方法可以将原始数据标记为非响应式的，即使用 ref 或 reactive 将其包装，仍无法实现数据响应式，其接收一个参数，即原始数据，并返回被标记后的数据</p>
<p>我们来看一下代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; state.name &#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; state.age &#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;button @click=&quot;change&quot;&gt;改变&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;reactive, markRaw&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const obj = &#123;</span><br><span class="line">			name: &#x27;前端印象&#x27;,</span><br><span class="line">			age: 22</span><br><span class="line">		&#125;</span><br><span class="line">		// 通过markRaw标记原始数据obj, 使其数据更新不再被追踪</span><br><span class="line">		const raw = markRaw(obj)</span><br><span class="line">		// 试图用reactive包装raw, 使其变成响应式数据</span><br><span class="line">		const state = reactive(raw)</span><br><span class="line"></span><br><span class="line">		function change() &#123;</span><br><span class="line">			state.age = 90</span><br><span class="line">			console.log(state);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		return &#123;state, change&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>我们来看一下在被 markRaw 方法处理过后的数据是否还能被 reactive 包装成响应式数据</p>
<p><img src="https://img-blog.csdnimg.cn/20201119130344291.gif#pic_center" alt="image"></p>
<p>从图中可以看到，即使我们修改了值也不会更新视图了，即没有实现数据响应式</p>
<h2 id="（11）provide-amp-amp-inject"><a href="#（11）provide-amp-amp-inject" class="headerlink" title="（11）provide &amp;&amp; inject"></a>（11）provide &amp;&amp; inject</h2><p>与 Vue2 中的 provide 和 inject 作用相同，只不过在 Vue3 中需要手动从 vue 中导入</p>
<p>这里简单说明一下这两个方法的作用：</p>
<ul>
<li>provide ：向子组件以及子孙组件传递数据。接收两个参数，第一个参数是 key，即数据的名称；第二个参数为 value，即数据的值</li>
<li>inject ：接收父组件或祖先组件传递过来的数据。接收一个参数 key，即父组件或祖先组件传递的数据名称</li>
</ul>
<p>假设这有三个组件，分别是 A.vue 、B.vue 、C.vue，其中 B.vue 是 A.vue 的子组件，C.vue 是 B.vue 的子组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">// A.vue</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;provide&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const obj= &#123;</span><br><span class="line">			name: &#x27;前端印象&#x27;,</span><br><span class="line">			age: 22</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// 向子组件以及子孙组件传递名为info的数据</span><br><span class="line">		provide(&#x27;info&#x27;, obj)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">// B.vue</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;inject&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">		// 接收A.vue传递过来的数据</span><br><span class="line">		inject(&#x27;info&#x27;)  // &#123;name: &#x27;前端印象&#x27;, age: 22&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">// C.vue</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;inject&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">		// 接收A.vue传递过来的数据</span><br><span class="line">		inject(&#x27;info&#x27;)  // &#123;name: &#x27;前端印象&#x27;, age: 22&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="（12）watch-amp-amp-watchEffect"><a href="#（12）watch-amp-amp-watchEffect" class="headerlink" title="（12）watch &amp;&amp; watchEffect"></a>（12）watch &amp;&amp; watchEffect</h3><p>watch 和 watchEffect 都是用来监视某项数据变化从而执行指定的操作的，但用法上还是有所区别</p>
<p>watch：watch( source, cb, [options] )</p>
<p>参数说明：</p>
<ul>
<li>source：可以是表达式或函数，用于指定监听的依赖对象</li>
<li>cb：依赖对象变化后执行的回调函数</li>
<li>options：可选参数，可以配置的属性有 immediate（立即触发回调函数）、deep（深度监听）<br>当监听 ref 类型时：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;ref, watch&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">		const state = ref(0)</span><br><span class="line"></span><br><span class="line">		watch(state, (newValue, oldValue) =&gt; &#123;</span><br><span class="line">			console.log(`原值为$&#123;oldValue&#125;`)</span><br><span class="line">			console.log(`新值为$&#123;newValue&#125;`)</span><br><span class="line">			/* 1秒后打印结果：</span><br><span class="line">							原值为0</span><br><span class="line">							新值为1</span><br><span class="line">			*/</span><br><span class="line">		&#125;)</span><br><span class="line"></span><br><span class="line">		// 1秒后将state值+1</span><br><span class="line">		setTimeout(() =&gt; &#123;</span><br><span class="line">			state.value ++</span><br><span class="line">		&#125;, 1000)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>当监听 reactive 类型时：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;reactive, watch&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">		const state = reactive(&#123;count: 0&#125;)</span><br><span class="line"></span><br><span class="line">		watch(() =&gt; state.count, (newValue, oldValue) =&gt; &#123;</span><br><span class="line">			console.log(`原值为$&#123;oldValue&#125;`)</span><br><span class="line">			console.log(`新值为$&#123;newValue&#125;`)</span><br><span class="line">			/* 1秒后打印结果：</span><br><span class="line">							原值为0</span><br><span class="line">							新值为1</span><br><span class="line">			*/</span><br><span class="line">		&#125;)</span><br><span class="line"></span><br><span class="line">		// 1秒后将state.count的值+1</span><br><span class="line">		setTimeout(() =&gt; &#123;</span><br><span class="line">			state.count ++</span><br><span class="line">		&#125;, 1000)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>当同时监听多个值时：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;reactive, watch&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">		const state = reactive(&#123; count: 0, name: &#x27;zs&#x27; &#125;)</span><br><span class="line"></span><br><span class="line">	   watch(</span><br><span class="line">	      [() =&gt; state.count, () =&gt; state.name],</span><br><span class="line">	      ([newCount, newName], [oldvCount, oldvName]) =&gt; &#123;</span><br><span class="line">	        console.log(oldvCount) // 旧的 count 值</span><br><span class="line">	        console.log(newCount) // 新的 count 值</span><br><span class="line">	        console.log(oldName) // 旧的 name 值</span><br><span class="line">	        console.log(newvName) // 新的 name 值</span><br><span class="line">	      &#125;</span><br><span class="line">	    )</span><br><span class="line"></span><br><span class="line">	    setTimeout(() =&gt; &#123;</span><br><span class="line">	      state.count ++</span><br><span class="line">	      state.name = &#x27;ls&#x27;</span><br><span class="line">	    &#125;, 1000)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>因为 watch 方法的第一个参数我们已经指定了监听的对象，因此当组件初始化时，不会执行第二个参数中的回调函数，若我们想让其初始化时就先执行一遍，可以在第三个参数对象中设置 immediate: true</p>
<p>watch 方法默认是浅层的监听我们指定的数据，例如如果监听的数据有多层嵌套，深层的数据变化不会触发监听的回调，若我们想要其对深层数据也进行监听，可以在第三个参数对象中设置 deep: true</p>
<blockquote>
<p>补充： watch 方法会返回一个 stop 方法，若想要停止监听，便可直接执行该 stop 函数</p>
</blockquote>
<p>接下来再来聊聊 watchEffect，它与 watch 的区别主要有以下几点：</p>
<ol>
<li>不需要手动传入依赖</li>
<li>每次初始化时会执行一次回调函数来自动获取依赖</li>
<li>无法获取到原值，只能得到变化后的值<br>来看一下该方法如何使用：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;reactive, watchEffect&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">		const state = reactive(&#123; count: 0, name: &#x27;zs&#x27; &#125;)</span><br><span class="line"></span><br><span class="line">	   	watchEffect(() =&gt; &#123;</span><br><span class="line">			console.log(state.count)</span><br><span class="line">			console.log(state.name)</span><br><span class="line">			/*  初始化时打印：</span><br><span class="line">							0</span><br><span class="line">							zs</span><br><span class="line"></span><br><span class="line">				1秒后打印：</span><br><span class="line">							1</span><br><span class="line">							ls</span><br><span class="line">			*/</span><br><span class="line">		&#125;)</span><br><span class="line"></span><br><span class="line">	    setTimeout(() =&gt; &#123;</span><br><span class="line">	      state.count ++</span><br><span class="line">	      state.name = &#x27;ls&#x27;</span><br><span class="line">	    &#125;, 1000)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>从上述代码中可以看出，我们并没有像 watch 方法一样先给其传入一个依赖，而是直接指定了一个回调函数</p>
<p>当组件初始化时，将该回调函数执行一次，自动获取到需要检测的数据是 state.count 和 state.name</p>
<p>根据以上特征，我们可以自行选择使用哪一个监听器</p>
<h2 id="（13）getCurrentInstance"><a href="#（13）getCurrentInstance" class="headerlink" title="（13）getCurrentInstance"></a>（13）getCurrentInstance</h2><p>我们都知道在 Vue2 的任何一个组件中想要获取当前组件的实例可以通过 this 来得到，而在 Vue3 中我们大量的代码都在 setup 函数中运行，并且在该函数中 this 指向的是 undefined，那么该如何获取到当前组件的实例呢？</p>
<p>这时可以用到另一个方法，即 getCurrentInstance</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123; num &#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;ref, getCurrentInstance&#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">    	const num = ref(3)</span><br><span class="line">		const instance = getCurrentInstance()</span><br><span class="line">		console.log(instance)</span><br><span class="line"></span><br><span class="line">		return &#123;num&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>我们来看一下其打印结果</p>
<p><img src="https://img-blog.csdnimg.cn/20201119141859447.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xfUFBQ,size_16,color_FFFFFF,t_70#pic_center" alt="image"></p>
<p>因为 instance 包含的内容太多，所以没截完整，但是主要的内容都在图上了，我们重点来看一下 ctx 和 proxy，因为这两个才是我们想要的 this 的内容</p>
<p><img src="https://img-blog.csdnimg.cn/20201119142920681.png?x-oss-process=image" alt="image"></p>
<p>可以看到 ctx 和 proxy 的内容十分类似，只是后者相对于前者外部包装了一层 proxy，由此可说明 proxy 是响应式的</p>
<h2 id="（14）useStore"><a href="#（14）useStore" class="headerlink" title="（14）useStore"></a>（14）useStore</h2><p>在 Vue2 中使用 Vuex，我们都是通过 this.$store 来获取到 Vuex 实例，但上一部分说了原本 Vue2 中的 this 的获取方式不一样了，并且我们在 Vue3 的 getCurrentInstance().ctx 中也没有发现 $store 这个属性，那么如何获取到 Vuex 实例呢？这就要通过 vuex 中的一个方法了，即 useStore</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// store 文件夹下的 index.js</span><br><span class="line">import Vuex from &#x27;vuex&#x27;</span><br><span class="line"></span><br><span class="line">const store = Vuex.createStore(&#123;</span><br><span class="line">	state: &#123;</span><br><span class="line">		name: &#x27;前端印象&#x27;,</span><br><span class="line">		age: 22</span><br><span class="line">	&#125;,</span><br><span class="line">	mutations: &#123;</span><br><span class="line">		……</span><br><span class="line">	&#125;,</span><br><span class="line">	……</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// example.vue</span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 从 vuex 中导入 useStore 方法</span><br><span class="line">import &#123;useStore&#125; from &#x27;vuex&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">    	// 获取 vuex 实例</span><br><span class="line">    	const store = useStore()</span><br><span class="line"></span><br><span class="line">		console.log(store)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>我们来看一下打印结果</p>
<p><img src="https://img-blog.csdnimg.cn/20201119145014243.png?x-oss-process=image#pic_center" alt="image"></p>
<p>然后接下来就可以像之前一样正常使用 vuex 了</p>
<h2 id="（15）获取标签元素"><a href="#（15）获取标签元素" class="headerlink" title="（15）获取标签元素"></a>（15）获取标签元素</h2><p>最后再补充一个 ref 另外的作用，那就是可以获取到标签元素或组件</p>
<p>在 Vue2 中，我们获取元素都是通过给元素一个 ref 属性，然后通过 this.$refs.xx 来访问的，但这在 Vue3 中已经不再适用了</p>
<p>接下来看看 Vue3 中是如何获取元素的吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div ref=&quot;el&quot;&gt;div元素&lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref, onMounted &#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    // 创建一个DOM引用，名称必须与元素的ref属性名相同</span><br><span class="line">    const el = ref(null)</span><br><span class="line"></span><br><span class="line">    // 在挂载后才能通过 el 获取到目标元素</span><br><span class="line">    onMounted(() =&gt; &#123;</span><br><span class="line">      el.value.innerHTML = &#x27;内容被修改&#x27;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    // 把创建的引用 return 出去</span><br><span class="line">    return &#123;el&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>获取元素的操作一共分为以下几个步骤：</p>
<ul>
<li>先给目标元素的 ref 属性设置一个值，假设为 el</li>
<li>然后在 setup 函数中调用 ref 函数，值为 null，并赋值给变量 el，这里要注意，该变量名必须与我们给元素设置的 ref 属性名相同</li>
<li>把对元素的引用变量 el 返回（return）出去</li>
</ul>
<blockquote>
<p>补充：设置的元素引用变量只有在组件挂载后才能访问到，因此在挂载前对元素进行操作都是无效的</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/16/Vue%E5%AD%A6%E4%B9%A0%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/portal.jpg">
      <meta itemprop="name" content="Bruce Chen">
      <meta itemprop="description" content="It's better to burn out than to fade away.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Chen's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/16/Vue%E5%AD%A6%E4%B9%A0%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/" class="post-title-link" itemprop="url">Vue学习知识点总结</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-12-16 14:17:42 / 修改时间：14:34:31" itemprop="dateCreated datePublished" datetime="2022-12-16T14:17:42+08:00">2022-12-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E6%80%BB%E7%BB%93/" itemprop="url" rel="index"><span itemprop="name">前端框架总结</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Vue 是一套用于构建用户界面的渐进式框架。与其它大型框架不同的是，Vue 被设计为可以自底向上逐层应用。Vue 的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整合。另一方面，Vue 也完全能够为复杂的单页应用提供驱动。</p>
<h2 id="一、Vue-基础使用"><a href="#一、Vue-基础使用" class="headerlink" title="一、Vue 基础使用"></a>一、Vue 基础使用</h2><h3 id="vue-的使用"><a href="#vue-的使用" class="headerlink" title="vue 的使用"></a>vue 的使用</h3><blockquote>
<p>下载 Vue：npm i vue</p>
</blockquote>
<ol>
<li>首先下载 vue，引入 vue.js</li>
<li>js 中创建一个 Vue 对象实例</li>
<li>通过 el 指定 vue 管理页面的边界</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 引入vue.js文件 --&gt;</span><br><span class="line">&lt;script src=&quot;lib/vue.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;input v-model=&quot;message&quot; type=&quot;text&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;h1&gt;&#123;&#123;message&#125;&#125;&lt;/h1&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 下载Vue：npm i vue --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    var vm = new Vue(&#123;</span><br><span class="line">        /**</span><br><span class="line">        *   el是element的简写，用来指定vue管理页面的边界，</span><br><span class="line">        *   也就是说只有包裹在 #app内部的元素，才会收到Vue的管理！！！</span><br><span class="line">        */</span><br><span class="line">        el: &#x27;#app&#x27;,</span><br><span class="line"></span><br><span class="line">        /**</span><br><span class="line">        *   页面中用的到数据都放到data对象中</span><br><span class="line">        */</span><br><span class="line">        data: &#123;</span><br><span class="line">            message: &#x27;邓紫棋喜欢你&#x27;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 写Vue可能会遇到的错误：</span><br><span class="line">        // 1 注意：Vue 是以大写字母开头的，它是一个构造函数！！！</span><br><span class="line">        // 2 注意：在 Vue 中，HTML属性值无法使用 `&#123;&#123;&#125;&#125;`！！！</span><br><span class="line">        // 3 开发期间一定要使用未压缩版的Vue（开发版）</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">    *   vm是Vue的对象实例，可以通过vm.$data.属性名获取data中的属性值，可以省略$data</span><br><span class="line">    */</span><br><span class="line">    console.log(vm.message)</span><br><span class="line">    console.log(vm.$data.message)</span><br><span class="line">    console.log(vm.message === vm.$data.message)</span><br></pre></td></tr></table></figure>

<h3 id="Mustache-表达式使用"><a href="#Mustache-表达式使用" class="headerlink" title="Mustache 表达式使用"></a>Mustache 表达式使用</h3><blockquote>
<p>双花括号<code>&#123;&#123;&#125;&#125;</code> 就是 mustache 语法，用于展示 data 中的内容,mustache 中可以出现任意的 JS 表达式；</p>
</blockquote>
<ul>
<li>表达式<code>&#123;&#123;&#125;&#125;</code>只能从数据对象 data 中获取数据；</li>
<li>mustache 中不能出现语句，比如：if () {} &#x2F; for(var i &#x3D;0 …) {} &#x2F; var num &#x3D; 1;</li>
<li>Mustache 语法不能作用在 HTML 元素的属性上；</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;h1&gt;&#123;&#123; msg &#125;&#125;&lt;/h1&gt;</span><br><span class="line">        &lt;p&gt;&#123;&#123; 1 + 2 &#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;&#123;&#123; [&#x27;a&#x27;, &#x27;c&#x27;, &#x27;b&#x27;] &#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;&#123;&#123; [&#x27;a&#x27;, &#x27;c&#x27;, &#x27;b&#x27;].join(&#x27;-&#x27;) &#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;&#123;&#123; msg + &#x27; -- 拼接内容&#x27; &#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;&#123;&#123; age &gt; 18 ? &#x27;成年了&#x27; : &#x27;未成年&#x27; &#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;&#123;&#123; Math.random() &#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    var vm = new Vue(&#123;</span><br><span class="line">        el:&#x27;#app&#x27;,</span><br><span class="line">        data:&#123;</span><br><span class="line">            msg:&#x27;邓紫棋金鱼嘴&#x27;,</span><br><span class="line">            age:19</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="指令-v-使用"><a href="#指令-v-使用" class="headerlink" title="指令 v-使用"></a>指令 v-使用</h3><blockquote>
<p>指令 (Directives) 是带有 v- 前缀的特殊属性，当表达式的值改变时，将其产生的连带影响，响应式地作用于 DOM。</p>
</blockquote>
<h4 id="1-v-text"><a href="#1-v-text" class="headerlink" title="1.v-text"></a>1.v-text</h4><blockquote>
<p>用来设置当前元素的文本内容，相当于 DOM 对象的 innerText 或 textContent</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-text=&#x27;msg&#x27;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h4 id="2-v-html"><a href="#2-v-html" class="headerlink" title="2.v-html"></a>2.v-html</h4><blockquote>
<p>更新 DOM 对象的 innerHTML</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-html=&#x27;htmlMsg&#x27;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h4 id="3-v-bind"><a href="#3-v-bind" class="headerlink" title="3.v-bind"></a>3.v-bind</h4><blockquote>
<p>通过 v-bind 为 HTML 元素绑定属性，使用 data 中提供的数据;<br>因为 v-bind:title 这种使用方式很繁琐，所以，vue 提供了一个简化语法 :title</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;img v-bind:title=&#x27;msg&#x27; v-bind:src=&#x27;imgPath&#x27; v-bind:name=&#x27;name&#x27;&gt;</span><br><span class="line">&lt;img :title=&#x27;msg&#x27; :src=&#x27;imgPath&#x27; :name=&#x27;name&#x27;&gt;</span><br></pre></td></tr></table></figure>

<h4 id="4-v-on"><a href="#4-v-on" class="headerlink" title="4.v-on"></a>4.v-on</h4><blockquote>
<p>绑定事件,<strong>支持 js 所有的事件类型</strong>， v-on 绑定的事件方法都要写在 Vue 实例中的 methods 对象中;<br>v-on:省略写 @</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;button v-on:click=&#x27;getData&#x27;&gt;点我&lt;/button&gt;&lt;input v-on:onfocus=&#x27;getFocus&#x27;&gt;</span><br><span class="line">&lt;button @click=&#x27;getData&#x27;&gt;点我&lt;/button&gt;&lt;input @onfocus=&#x27;getFocus&#x27;&gt;</span><br></pre></td></tr></table></figure>

<h4 id="5-v-model"><a href="#5-v-model" class="headerlink" title="5.v-model"></a>5.v-model</h4><blockquote>
<p>在表单元素上创建双向数据绑定;<br>只能用在表单元素中，注意：不同的表单元素，v-model 的表现可能会有所不同。<br>比如：v-model 操作文本框的 value 属性，而复选框 v-model 就是操作其选中状态;</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 绑定的是文本框输入的内容 --&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; v-model=&#x27;msg&#x27;&gt;</span><br><span class="line">&lt;!-- 绑定的是复选框是否选中 --&gt;</span><br><span class="line">&lt;input type=&quot;checkbox&quot; v-model=&#x27;isCheck&#x27;&gt;</span><br></pre></td></tr></table></figure>

<h4 id="6-v-for"><a href="#6-v-for" class="headerlink" title="6.v-for"></a>6.v-for</h4><blockquote>
<p>基于源数据多次渲染元素或模板块,不仅可以渲染集合 List 也可以遍历对象 Obj；</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- v-for 遍历list集合--&gt;</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;!--1.item是每一项对象</span><br><span class="line">        使用 v-for 的时候提供 key 属性，以获得性能提升。</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;li v-for=&#x27;item in list&#x27; :key=&#x27;item.key&#x27;&gt;</span><br><span class="line">        姓名：&#123;&#123;item.name&#125;&#125; -- 年龄：&#123;&#123;item.age&#125;&#125;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--2.item 为当前项，index 为索引 --&gt;</span><br><span class="line">    &lt;li v-for=&#x27;(item,index) in list&#x27;&gt;</span><br><span class="line">        姓名：&#123;&#123;item.name&#125;&#125; -- 年龄：&#123;&#123;item.age&#125;&#125; -- 下标：&#123;&#123;index&#125;&#125;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- v-for Obj对象 value,key,index顺序不能变 --&gt;</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;li v-for=&#x27;(value,key,index) in csObj&#x27;&gt;</span><br><span class="line">        key=&#123;&#123;key&#125;&#125; -- value=&#123;&#123;value&#125;&#125; -- index=&#123;&#123;index&#125;&#125;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>

<h4 id="7-v-bind-class-和-v-bind-style"><a href="#7-v-bind-class-和-v-bind-style" class="headerlink" title="7.v-bind:class 和 v-bind:style"></a>7.v-bind:class 和 v-bind:style</h4><blockquote>
<p>表达式的类型：字符串、数组、对象（重点）</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 可以是对象，key是类名 value是布尔值，如果是true就添加这个类，否则就不添加--&gt;</span><br><span class="line">&lt;h2 :class=&#x27;&#123;pink:true,green:true&#125;&#x27;&gt;中国惊奇先生&lt;/h2&gt;</span><br><span class="line">&lt;!-- 可以是数组，--&gt;</span><br><span class="line">&lt;h2 :class=&#x27;[&#x27;pink&#x27;,&#x27;fz&#x27;,&#x27;green&#x27;]&#x27;&gt;斗罗大陆&lt;/h2&gt;</span><br><span class="line">&lt;h2 :style=&quot;&#123; color: activeColor, &#x27;font-size&#x27;: fontSize + &#x27;px&#x27; &#125;&quot;&gt;不良人&lt;/h2&gt;</span><br></pre></td></tr></table></figure>

<h4 id="8-v-if"><a href="#8-v-if" class="headerlink" title="8.v-if"></a>8.v-if</h4><blockquote>
<p>根据表达式布尔值的真假条件是否加载这段代码， true:DOM 中会加载这段代码，false:DOM 中不会加载这段代码；</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;h3 v-if=&#x27;isIF&#x27;&gt;我是v-if,是否会加载我&lt;/h3&gt;</span><br></pre></td></tr></table></figure>

<h4 id="9-v-show"><a href="#9-v-show" class="headerlink" title="9.v-show"></a>9.v-show</h4><blockquote>
<p>根据表达式之真假值，切换元素的 display CSS 属性，无论 true 还是 false DOM 中都会加载这段代码；</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;h3 v-show=&#x27;isShow&#x27;&gt;我是v-show，是否会显示出来</span><br><span class="line">&lt;/h3&gt;</span><br></pre></td></tr></table></figure>

<h4 id="10-v-pre"><a href="#10-v-pre" class="headerlink" title="10.v-pre"></a>10.v-pre</h4><blockquote>
<p>跳过这个元素和它的子元素的编译过程。可以用来显示原始 Mustache 标签。跳过大量没有指令的节点会加快编译。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--测试：页面中的msg不会显示data中的内容，因为跳过了表达式编译--&gt;</span><br><span class="line"> &lt;div v-pre&gt;v-pre跳过编译过程 &#123;&#123;msg&#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h4 id="11-v-once"><a href="#11-v-once" class="headerlink" title="11.v-once"></a>11.v-once</h4><blockquote>
<p>只渲染元素和组件一次。随后的重新渲染，元素&#x2F;组件及其所有的子节点将被视为静态内容并跳过。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--测试：在控制台通过vm对象修改msg,页面显示中的msg内容不会有变化--&gt;</span><br><span class="line">    &lt;div v-once&gt;v-once跳过编译过程 &#123;&#123;msg&#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h4 id="12-v-cloak"><a href="#12-v-cloak" class="headerlink" title="12.v-cloak"></a>12.v-cloak</h4><blockquote>
<p>页面中使用 <code>&#123;&#123;&#125;&#125;</code> 的时候，经历了由 <code>&#123;&#123;&#125;&#125;</code> -&gt; 具体内容，这么一个过程，所以页面会造成“闪烁”<br>解决：通过添加 v-cloak 指令，配合 [v-cloak] { display: none; } 避免了页面闪烁</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-cloak&gt;&#123;&#123;msg&#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h3 id="动态添加数据到-data、异步更新-DOM"><a href="#动态添加数据到-data、异步更新-DOM" class="headerlink" title="动态添加数据到 data、异步更新 DOM"></a>动态添加数据到 data、异步更新 DOM</h3><h4 id="1-动态添加数据到-data"><a href="#1-动态添加数据到-data" class="headerlink" title="1.动态添加数据到 data"></a>1.动态添加数据到 data</h4><blockquote>
<p>只有 data 中的数据才是响应式的，动态添加进来的数据默认为非响应式<br>可以通过以下方式实现动态添加数据的响应式:</p>
</blockquote>
<ul>
<li>1 Vue.set(object, key, value) - 适用于添加单个属性</li>
<li>2 Object.assign() - 适用于添加多个属性</li>
</ul>
<h4 id="2-异步更新-DOM"><a href="#2-异步更新-DOM" class="headerlink" title="2.异步更新 DOM"></a>2.异步更新 DOM</h4><blockquote>
<p>当绑定的数据发生变动时，Vue 异步执行 DOM 更新，监视所有数据改变，一次性更新 DOM；<br>解决方法：</p>
</blockquote>
<ul>
<li>Vue.nextTick</li>
<li>this.$nextTick</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"> &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;!-- 点击按钮之前data中还没有age属性 --&gt;</span><br><span class="line">    &lt;button @click=&#x27;addAge&#x27;&gt;给data添加age&lt;/button&gt;</span><br><span class="line">    &lt;div&gt;名字：&#123;&#123;stu.name&#125;&#125;&lt;/div&gt;</span><br><span class="line">    &lt;!--</span><br><span class="line">        这里使用的表达式中的属性必须是响应式的</span><br><span class="line">        只有data中的数据才是响应式的，动态添加进来的数据默认为非响应式</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;div&gt;年龄：&#123;&#123;stu.age&#125;&#125;&lt;/div&gt;</span><br><span class="line">    &lt;div&gt;性别：&#123;&#123;stu.sex&#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    var vm = new Vue(&#123;</span><br><span class="line">        el: &#x27;#app&#x27;,</span><br><span class="line">        data: &#123;</span><br><span class="line">            msg: &#x27;hello vue&#x27;,</span><br><span class="line">            stu: &#123;</span><br><span class="line">                name: &#x27;jack&#x27;,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            addAge: function () &#123;</span><br><span class="line">                //可以通过以下方式实现动态添加数据的响应式</span><br><span class="line">                //1.添加单个属性</span><br><span class="line">                // 第一个参数：表示要给哪个对象添加响应式属性 $data可以省略</span><br><span class="line">                // 第二个参数：表示要添加的属性名称</span><br><span class="line">                // 第三个参数：表示属性的值</span><br><span class="line">                Vue.set(this.stu, &quot;age&quot;, 18)</span><br><span class="line">                //2.添加多个属性</span><br><span class="line">                //第一个参数：是一个空对象</span><br><span class="line">                //第二个参数：添加到哪个对象</span><br><span class="line">                //第三个参数：添加属性的对象</span><br><span class="line">                this.stu = Object.assign(&#123;&#125;,this.stu,&#123;&quot;name&quot;:&quot;邓紫棋&quot;,&quot;age&quot;:18,&quot;sex&quot;:&quot;man&quot;&#125;)</span><br><span class="line"></span><br><span class="line">                //此时打印的内容为 名字：jack</span><br><span class="line">                //</span><br><span class="line">                //为什么呢？ Vue 异步执行 DOM 更新，监视所有数据改变，一次性更新DOM</span><br><span class="line">                console.log(this.$el.children[1].innerText)</span><br><span class="line"></span><br><span class="line">                //解决方法 Vue.nextTick 和 this.$nextTick 是相同的</span><br><span class="line">                //在DOM更新后，回调执行某个操作（DOM操作）</span><br><span class="line">                this.$nextTick(function()&#123;</span><br><span class="line">                    console.log(this.$el.children[1].innerText)</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="filter-过滤器"><a href="#filter-过滤器" class="headerlink" title="filter 过滤器"></a>filter 过滤器</h3><ul>
<li>作用：文本数据格式化 , 也就是: 将数据按照我们指定的一种格式输出</li>
<li>过滤器可以用在两个地方：<code>&#123;&#123;&#125;&#125;</code>表达式 和 v-bind 指令中</li>
<li>两种过滤器：1 全局过滤器 2 局部过滤器</li>
</ul>
<h4 id="1-全局过滤器"><a href="#1-全局过滤器" class="headerlink" title="1.全局过滤器"></a>1.全局过滤器</h4><ul>
<li>说明：通过全局方式创建的过滤器，在任何一个 vue 实例中都可以使用</li>
<li>注意：使用全局过滤器的时候，需要先创建全局过滤器，再创建 Vue 实例</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;&#123;&#123; dateStr | date &#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;div&gt;&#123;&#123; dateStr | date(&#x27;YYYY-MM-DD hh:mm:ss&#x27;) &#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  Vue.filter(&#x27;date&#x27;, function(value, format) &#123;</span><br><span class="line">    // value 要过滤的字符串内容，比如：dateStr</span><br><span class="line">    // format 过滤器的参数，比如：&#x27;YYYY-MM-DD hh:mm:ss&#x27;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">var vm = new Vue(&#123;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="2-局部过滤器"><a href="#2-局部过滤器" class="headerlink" title="2.局部过滤器"></a>2.局部过滤器</h4><ul>
<li>说明：局部过滤器是在某一个 vue 实例的内容创建的，只在当前实例中起作用</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;&#123;&#123;msg | fi(&quot;九&quot;)&#125;&#125;&lt;/div&gt;</span><br><span class="line">var vm = new Vue(&#123;</span><br><span class="line">          el:&#x27;#app&#x27;,</span><br><span class="line">          data:&#123;</span><br><span class="line">              msg:&#x27;八百个标兵奔北坡，八百个标兵奔北坡&#x27;</span><br><span class="line">          &#125;,</span><br><span class="line">          //2. 局部过滤器 只有在当前Vue实例中才起作用</span><br><span class="line">          // 通过 filters 配置项, 来创建过滤器</span><br><span class="line">          filters:&#123;</span><br><span class="line">              // content是内容，format是过滤的规则可以多个参数</span><br><span class="line">              fi:function(content,format)&#123;</span><br><span class="line">                  return content.replace(/八/g,format);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="watch-监听配置项"><a href="#watch-监听配置项" class="headerlink" title="watch 监听配置项"></a>watch 监听配置项</h3><ul>
<li>概述：watch 是一个对象，键是需要观察的表达式，值是对应回调函数</li>
<li>作用：当表达式的值发生变化后，会调用对应的回调函数完成响应的监视操作</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; v-model=&#x27;userName&#x27;&gt;</span><br><span class="line">    &lt;p v-show=&#x27;isError&#x27;&gt;请输入4-8位字符&lt;/p&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; v-model=&#x27;stu.age&#x27;&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    var vm = new Vue(&#123;</span><br><span class="line">        el: &#x27;#app&#x27;,</span><br><span class="line">        data: &#123;</span><br><span class="line">            userName: &#x27;&#x27;,</span><br><span class="line">            isError: false,</span><br><span class="line">            stu: &#123;</span><br><span class="line">                age: 10,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        // 通过 watch 配置项，来监视数据变化</span><br><span class="line">        // 只能监视 data 中的数据，要监视的数据，作为watch的属性</span><br><span class="line">        watch: &#123;</span><br><span class="line">            // 监视userName值的变化，方法名要用要监视的值的名字</span><br><span class="line">            userName:function(curVal, oldVal)&#123;</span><br><span class="line">                console.log(&#x27;当前值为：&#x27;, curVal, &#x27;上一次值为：&#x27;, oldVal);</span><br><span class="line">                if(curVal.length&gt;=4 &amp;&amp; curVal.length&lt;=8)&#123;</span><br><span class="line">                    this.isError = false;</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    this.isError = true;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            // 监听对象，加上deep:true</span><br><span class="line">            // 注意：如果监视对象的变化，那么，curVal 和 oldVal 是相同的，指向同一个对象</span><br><span class="line">            stu:&#123;</span><br><span class="line">                handler:function(curVal, oldVal)&#123;</span><br><span class="line">                    console.log(&#x27;当前值为：&#x27;, curVal, &#x27;上一次值为：&#x27;, oldVal);</span><br><span class="line">                &#125;,</span><br><span class="line">                deep: true</span><br><span class="line">            &#125;,</span><br><span class="line">            // 一般都是监听对象中的属性</span><br><span class="line">            // 只需要监视某个属性的变化，而不是整个对象中所有的属性的变化</span><br><span class="line">            &#x27;stu.age&#x27;:function(curVal, oldVal)&#123;</span><br><span class="line">                console.log(&#x27;当前值为：&#x27;, curVal, &#x27;上一次值为：&#x27;, oldVal);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="computed-计算属性配置项"><a href="#computed-计算属性配置项" class="headerlink" title="computed 计算属性配置项"></a>computed 计算属性配置项</h3><ul>
<li>说明：计算属性是基于它们的依赖进行缓存的，只有在它的依赖发生改变时才会重新求值</li>
<li>注意：Mustache 语法（<code>&#123;&#123;&#125;&#125;</code>）中不要放入太多的逻辑，否则会让模板过重、难以理解和维护</li>
<li>注意：computed 中的属性不能与 data 中的属性同名，否则会报错</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; v-model=&#x27;num1&#x27;&gt;+</span><br><span class="line">    &lt;input type=&quot;text&quot; v-model=&#x27;num2&#x27;&gt;=</span><br><span class="line">    &lt;input type=&quot;text&quot; v-model=&#x27;result&#x27;&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    var vm = new Vue(&#123;</span><br><span class="line">        el: &#x27;#app&#x27;,</span><br><span class="line">        data: &#123;</span><br><span class="line">            num1: 0,</span><br><span class="line">            num2: 0,</span><br><span class="line">            // result: 0 计算属性名不能和data中的属性相同</span><br><span class="line">        &#125;,</span><br><span class="line">        // 计算属性，通过 computed 配置项来指定</span><br><span class="line">        // 注意：计算属性不能与data中的属性相同！！！否则会报错</span><br><span class="line">        // 特点：计算属性依赖的属性（比如：num1 和 num2）发生改变，那么计算属性就会被重新计算</span><br><span class="line">        // 优势：内部使用缓存机制，如果页面中多个地方都用到了计算属性，那么计算属性只会被重新计算一次！！！</span><br><span class="line">        computed: &#123;</span><br><span class="line">            result:function()&#123;</span><br><span class="line">                return (this.num1-0)+(this.num2-0);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="事件修饰符"><a href="#事件修饰符" class="headerlink" title="事件修饰符"></a>事件修饰符</h3><ul>
<li>.stop 阻止向上冒泡 不会调用父的事件</li>
<li>.prevent 阻止默认行为，调用 event.preventDefault()</li>
<li>.capture 捕获冒泡</li>
<li>.self 只当事件在该元素本身触发时，才会触发事件</li>
<li>.once 事件只触发一次</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- .stop 阻止向上冒泡 不会调用父的事件 --&gt;</span><br><span class="line">&lt;div @click=&#x27;cathFather&#x27;&gt;我是父事件修饰符</span><br><span class="line">    &lt;!-- .stop  阻止冒泡，调用 event.stopPropagation() --&gt;</span><br><span class="line">    &lt;div @click.stop=&#x27;catchSon&#x27;&gt;我是子事件修饰符&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- .prevent 阻止默认行为，调用 event.preventDefault() --&gt;</span><br><span class="line">&lt;a href=&quot;http://www.baidu&quot; @click.prevent=&#x27;onPrevent&#x27;&gt;我是prevent事件&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- .capture捕获冒泡，</span><br><span class="line">    即有冒泡发生时，有该修饰符的dom元素会先执行，如果有多个，从外到内依次执行，然后再按自然顺序执行触发的事件。</span><br><span class="line">--&gt;</span><br><span class="line">&lt;!-- 如果不给爷爷添加capture 点击儿子触发的顺序是 儿子、爸爸、爷爷 --&gt;</span><br><span class="line">&lt;!-- 给爷爷添加了capture事件后 点击儿子触发的顺序是 爷爷、儿子、爸爸 --&gt;</span><br><span class="line">&lt;div @click.capture=&#x27;grandpa&#x27;&gt;我是爷爷</span><br><span class="line">    &lt;div @click=&#x27;father&#x27;&gt;我是爸爸</span><br><span class="line">        &lt;div @click=&#x27;son&#x27;&gt;</span><br><span class="line">                我是儿子</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- .self 只当事件在该元素本身触发时，才会触发事件 --&gt;</span><br><span class="line">&lt;div @click.self=&#x27;onSelfFather&#x27;&gt;self事件爸爸</span><br><span class="line">    &lt;div @click=&#x27;onSelfSon&#x27;&gt;self事件儿子&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- .once  事件只触发一次 --&gt;</span><br><span class="line">&lt;div @click.once=&#x27;onOnce&#x27;&gt;再点我一次试试&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h4 id="键值修饰符"><a href="#键值修饰符" class="headerlink" title="键值修饰符"></a>键值修饰符</h4><ul>
<li>说明：在监听键盘事件时，Vue 允许为 v-on 在监听键盘事件时添加关键修饰符</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;!-- 键值修饰符 包括键盘、鼠标 --&gt;</span><br><span class="line">    &lt;!-- 13是Enter键的code值 --&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; v-model=&#x27;msg&#x27; @keyup.13=&#x27;submit&#x27;&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; v-model=&#x27;msg2&#x27; @keyup.enter=&#x27;submit2&#x27;&gt;&lt;br&gt;</span><br><span class="line">    &lt;!-- 使用自定义键值修饰符 --&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; v-model=&#x27;msg&#x27; @keyup.f2=&#x27;submit&#x27;&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    // 自定义键值修饰符 有时候写code值是数字的时候并没有语义，所有我们给它定义一下</span><br><span class="line">    Vue.config.keyCodes.f2 = 113;</span><br><span class="line">    var vm = new Vue(&#123;</span><br><span class="line">        el:&#x27;#app&#x27;,</span><br><span class="line">        data:&#123;</span><br><span class="line">            msg:&#x27;&#x27;,</span><br><span class="line">            msg2:&#x27;&#x27;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods:&#123;</span><br><span class="line">            submit:function()&#123;</span><br><span class="line">                console.log(&#x27;提交数据=&#x27;+this.msg)</span><br><span class="line">            &#125;,</span><br><span class="line">            submit2:function()&#123;</span><br><span class="line">                console.log(&#x27;提交数据=&#x27;+this.msg2)</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="vue-声明周期钩子函数"><a href="#vue-声明周期钩子函数" class="headerlink" title="vue 声明周期钩子函数"></a>vue 声明周期钩子函数</h3><h4 id="1-beforeCreate"><a href="#1-beforeCreate" class="headerlink" title="1. beforeCreate()"></a>1. beforeCreate()</h4><ul>
<li>说明：在实例初始化之后，数据观测 (data observer) 和 event&#x2F;watcher 事件配置之前被调用</li>
<li>注意：此时，无法获取 data 中的数据、methods 中的方法</li>
<li>使用场景：可以在这个钩子函数中开启页面加载的 loading 效果</li>
</ul>
<h4 id="2-created"><a href="#2-created" class="headerlink" title="2. created()"></a>2. created()</h4><ul>
<li>注意：这是一个常用的生命周期，可以调用 methods 中的方法、改变 data 中的数据</li>
<li>使用场景：发送请求获取数据</li>
</ul>
<h4 id="3-beforeMounted"><a href="#3-beforeMounted" class="headerlink" title="3. beforeMounted()"></a>3. beforeMounted()</h4><ul>
<li>说明：组件将要挂载到页面中，也就是说：组件的内容还没有被挂载到页面中</li>
<li>注意：此时，获取不到页面中 DOM 元素</li>
</ul>
<h4 id="4-mounted"><a href="#4-mounted" class="headerlink" title="4. mounted()"></a>4. mounted()</h4><ul>
<li>说明：组件已经被挂载到页面中，此时，可以进行 DOM 操作了</li>
</ul>
<h4 id="5-beforeUpdate"><a href="#5-beforeUpdate" class="headerlink" title="5. beforeUpdate()"></a>5. beforeUpdate()</h4><ul>
<li>说明：数据更新时调用，发生在虚拟 DOM 重新渲染和打补丁之前。你可以在这个钩子中进一步地更改状态，这不会触发附加的重渲染过程。</li>
</ul>
<h4 id="6-updated"><a href="#6-updated" class="headerlink" title="6. updated()"></a>6. updated()</h4><ul>
<li>说明：组件 DOM 已经更新完成，所以你现在可以执行依赖于 DOM 的操作。</li>
</ul>
<h4 id="7-beforeDestroy"><a href="#7-beforeDestroy" class="headerlink" title="7. beforeDestroy()"></a>7. beforeDestroy()</h4><ul>
<li>说明：实例销毁之前调用。在这一步，实例仍然完全可用。</li>
<li>使用：实例销毁之前，执行清理任务，比如：清除定时器等</li>
</ul>
<h4 id="8-destroyed"><a href="#8-destroyed" class="headerlink" title="8. destroyed()"></a>8. destroyed()</h4><ul>
<li>说明：Vue 实例销毁后调用。调用后，Vue 实例指示的所有东西都会解绑定，所有的事件监听器会被移除，所有的子实例也会被销毁。</li>
</ul>
<h3 id="自定义指令"><a href="#自定义指令" class="headerlink" title="自定义指令"></a>自定义指令</h3><blockquote>
<p>Vue 这种 MVVM 模式的框架不推荐开发人员直接手动操作 DOM 有些情况, 还是需要操作 DOM 的, 如果需要操作 DOM, 就通过 Vue 中的自定义指令来操作!!!</p>
</blockquote>
<p>通过 Vue.directive()方法自定义指令：</p>
<ul>
<li>第一个参数: 表示自定义指令的名称；</li>
<li>第二个参数 1.表示自定义指令运行的时候, 需要执行的逻辑操作；</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Vue.directive(&#x27;ff1&#x27;, function (el) &#123;</span><br><span class="line">    console.log(el)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>第二个参数 2.还可以是一个对象，对象中是指令的钩子函数;</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> Vue.directive(&#x27;ff2&#x27;, &#123;</span><br><span class="line">    // bind 和 inserted 这两个钩子函数， 都是进入页面就立即执行的</span><br><span class="line">    // 区别：inserted 能获取到指令所在元素的父元素，bind 获取不到父元素</span><br><span class="line">    bind(el) &#123;</span><br><span class="line">        console.log(&#x27;bind&#x27;, el.parentNode)</span><br><span class="line">    &#125;,</span><br><span class="line">    inserted(el) &#123;</span><br><span class="line">        console.log(&#x27;inserted&#x27;, el.parentNode)</span><br><span class="line">    &#125;</span><br><span class="line">)&#125;</span><br></pre></td></tr></table></figure>

<p>指令函数的入参:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 标识放到自定义指令的后面 .表示名 --&gt;</span><br><span class="line">&lt;!-- 注意：如果 v-color=&quot;red&quot; 那么，red指的值：data中的red属性 --&gt;</span><br><span class="line">&lt;div v-color.back=&quot; &#x27;blue&#x27; &quot;&gt;&#123;&#123; msg &#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;div v-color.col=&quot; &#x27;red&#x27; &quot;&gt;&#123;&#123; msg &#125;&#125;&lt;/div&gt;</span><br><span class="line">Vue.directive(&#x27;color&#x27;, function (el, binding) &#123;</span><br><span class="line">    if (binding.modifiers.col) &#123;</span><br><span class="line">        el.style.color = binding.value</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        el.style.backgroundColor = binding.value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="小案例"><a href="#小案例" class="headerlink" title="小案例"></a>小案例</h4><blockquote>
<p>案例请到<a target="_blank" rel="noopener" href="https://github.com/pengjunshan/WebPJS">https://github.com/pengjunshan/WebPJS</a>中查看<br><img src="https://upload-images.jianshu.io/upload_images/3735156-799df1d167356992.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="image"></p>
</blockquote>
<h2 id="二、Vue-组件"><a href="#二、Vue-组件" class="headerlink" title="二、Vue 组件"></a>二、Vue 组件</h2><blockquote>
<p>组件是可复用的 Vue 实例,组件分为全局组件和局部组件。因为组件是可复用的 Vue 实例，所以它们与 new Vue 接收相同的选项，例如 data、computed、watch、methods 以及生命周期钩子等,el 是根实例特有的属性，组件中没有。</p>
</blockquote>
<h3 id="全局组件"><a href="#全局组件" class="headerlink" title="全局组件"></a>全局组件</h3><blockquote>
<p>全局组件在所有的 vue 实例中都可以使用,注意：先注册组件，再初始化根实例。</p>
</blockquote>
<h4 id="Vue-component-‘name’，-配置项"><a href="#Vue-component-‘name’，-配置项" class="headerlink" title="Vue.component(‘name’，{配置项})"></a>Vue.component(‘name’，{配置项})</h4><ul>
<li>第一个参数是组件名</li>
<li>第二个参数是组件的配置项，与 Vue 根实例配置项差不多</li>
<li>组件中的 data 必须是个函数数据用 return 返回，Vue 根实例中的 data 是个对象</li>
<li>组件中 template 模板有两种方式，“字符串” “html 模板”</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;hello&gt;&lt;/hello&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;template id=&quot;temp&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;p&gt;我是组件：&#123;&#123;msg&#125;&#125;&lt;/p&gt;</span><br><span class="line">            &lt;button @click=&#x27;fn&#x27;&gt; 点击消灭新冠 &lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line"></span><br><span class="line">        /**</span><br><span class="line">        * 第一个参数是组件名</span><br><span class="line">        * 第二个参数是配置项，与Vue实例的配置几乎一样</span><br><span class="line">        */</span><br><span class="line">        Vue.component(&#x27;hello&#x27;, &#123;</span><br><span class="line">            //template是组件的模板 也就是要展示的内容</span><br><span class="line">            //组件中template模板有两种方式，“字符串” “html模板”</span><br><span class="line">            //方式一：字符串</span><br><span class="line">            // template: `</span><br><span class="line">            //     &lt;div&gt;</span><br><span class="line">            //         &lt;p&gt;我是组件：&#123;&#123;msg&#125;&#125;&lt;/p&gt;</span><br><span class="line">            //         &lt;button @click=&#x27;fn&#x27;&gt; 点击消灭新冠 &lt;/button&gt;</span><br><span class="line">            //     &lt;/div&gt;</span><br><span class="line">            // `,</span><br><span class="line">            //方式二：html模板</span><br><span class="line">            template: &#x27;#temp&#x27;,</span><br><span class="line"></span><br><span class="line">            //组件中的data必须是个函数数据用return返回，Vue根实例中的data是个对象</span><br><span class="line">            data() &#123;</span><br><span class="line">                return &#123;</span><br><span class="line">                    msg: &#x27;武汉加油 中国加油&#x27;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            methods: &#123;</span><br><span class="line">                fn() &#123;</span><br><span class="line">                    this.msg = &#x27;新冠被消灭了，中国威武&#x27;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        var vm = new Vue(&#123;</span><br><span class="line">            el: &#x27;#app&#x27;,</span><br><span class="line">            data: &#123;&#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h3 id="局部组件"><a href="#局部组件" class="headerlink" title="局部组件"></a>局部组件</h3><blockquote>
<p>局部组件，是在某一个具体的 vue 实例中定义的，只能在这个 vue 实例中使用；在 Vue 实例中使用 components 对象创建组件，可以创建多个组件；</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;!-- hello组件 --&gt;</span><br><span class="line">        &lt;hello&gt;&lt;/hello&gt;</span><br><span class="line">        &lt;!-- love组件 --&gt;</span><br><span class="line">        &lt;love&gt;&lt;/love&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;template id=&quot;temp&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;p&gt;我是组件222：&#123;&#123;msg&#125;&#125;&lt;/p&gt;</span><br><span class="line">            &lt;button @click=&#x27;fn&#x27;&gt; 点击消灭新冠 &lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script&gt;</span><br><span class="line"></span><br><span class="line">        //1.局部组件，是在某一个具体的vue实例中定义的，只能在这个vue实例中使用</span><br><span class="line">        //2.在Vue实例中使用components对象创建组件，可以创建多个组件</span><br><span class="line">        //3.组件中template模板有两种方式，“字符串” “html模板”</span><br><span class="line"></span><br><span class="line">        var vm = new Vue(&#123;</span><br><span class="line">            el: &#x27;#app&#x27;,</span><br><span class="line">            data: &#123;</span><br><span class="line">            &#125;,</span><br><span class="line">            components: &#123;</span><br><span class="line">                //hello 组件名</span><br><span class="line">                &#x27;hello&#x27;: &#123;</span><br><span class="line">                    //方式一 字符串</span><br><span class="line">                    template: `</span><br><span class="line">                        &lt;div&gt;</span><br><span class="line">                            &lt;p&gt;我是组件111：&#123;&#123;msg&#125;&#125;&lt;/p&gt;</span><br><span class="line">                            &lt;button @click=&#x27;fn&#x27;&gt; 点击消灭新冠 &lt;/button&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    `,</span><br><span class="line">                    data() &#123;</span><br><span class="line">                        return &#123;</span><br><span class="line">                            msg: &#x27;武汉加油 中国加油&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    methods: &#123;</span><br><span class="line">                        fn() &#123;</span><br><span class="line">                            this.msg = &#x27;新冠被消灭了，中国威武&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#x27;love&#x27;: &#123;</span><br><span class="line">                    //方式二 引用html中的代码模板</span><br><span class="line">                    template: &#x27;#temp&#x27;,</span><br><span class="line">                    data() &#123;</span><br><span class="line">                        return &#123;</span><br><span class="line">                            msg: &#x27;我们爱中国 爱武汉&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    methods: &#123;</span><br><span class="line">                        fn() &#123;</span><br><span class="line">                            this.msg = &#x27;我们爱中华民族&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h3 id="父组件传递子组件数据"><a href="#父组件传递子组件数据" class="headerlink" title="父组件传递子组件数据"></a>父组件传递子组件数据</h3><ul>
<li>方式：通过 props 属性来传递数据</li>
<li>注意：属性的值必须在组件中通过 props 属性显示指定，否则，不会生效</li>
<li>说明：传递过来的 props 属性的用法与 data 属性的用法相同</li>
<li>如果传递的数据是 data 中的属性时，必须使用 v-bind 绑定属性才可以传递过去</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;hello mm=&#x27;中华民族万岁&#x27;&gt;&lt;/hello&gt;</span><br><span class="line">        &lt;!-- 如果传递的数据是data中的属性时，必须使用v-bind绑定属性才可以传递过去 --&gt;</span><br><span class="line">        &lt;!-- &lt;hello zz=&#x27;msg&#x27;&gt;&lt;/hello&gt; --&gt;</span><br><span class="line">        &lt;hello v-bind:zz=&#x27;msg&#x27;&gt;&lt;/hello&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script&gt;</span><br><span class="line"></span><br><span class="line">        // 父组件 传递数据给 子组件：（父组件：Vue的实例对象，子组件：hello组件）</span><br><span class="line">        // 原理：通过 props 属性来传递</span><br><span class="line">        // 注意：使用父组件传递的属性方式和使用data中的属性方式一样</span><br><span class="line">        Vue.component(&#x27;hello&#x27;, &#123;</span><br><span class="line">            template: `</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                    &lt;p&gt;我是组件：&#123;&#123;msg&#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;p v-if=&#x27;mm&#x27;&gt;我接收到父组件的内容：&#123;&#123;mm&#125;&#125;&lt;/P&gt;</span><br><span class="line">                    &lt;p v-if=&#x27;zz&#x27;&gt;我接收到父组件的内容：&#123;&#123;zz&#125;&#125;&lt;/P&gt;</span><br><span class="line">                    &lt;button @click=&#x27;fn&#x27;&gt; 点击消灭新冠 &lt;/button&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            `,</span><br><span class="line">            //指定props中的值，来接收父组件传递过来的值</span><br><span class="line">            props:[&#x27;mm&#x27;,&#x27;zz&#x27;],</span><br><span class="line">            data() &#123;</span><br><span class="line">                return &#123;</span><br><span class="line">                    msg: &#x27;武汉加油 中国加油&#x27;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            methods: &#123;</span><br><span class="line">                fn() &#123;</span><br><span class="line">                    this.msg=this.msg+&#x27;-----&#x27;+(this.mm===undefined? this.zz:this.mm);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        var vm = new Vue(&#123;</span><br><span class="line">            el: &#x27;#app&#x27;,</span><br><span class="line">            data: &#123;</span><br><span class="line">                msg:&#x27;浙江杭州&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h3 id="子组件传递父组件数据"><a href="#子组件传递父组件数据" class="headerlink" title="子组件传递父组件数据"></a>子组件传递父组件数据</h3><ul>
<li>方式：父组件给子组件传递一个函数，由子组件调用这个函数</li>
<li>说明：借助 vue 中的自定义事件（v-on:cunstomFn&#x3D;”fn”）</li>
<li>$emit()：触发事件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;p&gt;&#123;&#123;msg&#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;hello @pfn=&#x27;parentFn&#x27;&gt;&lt;/hello&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;template id=&quot;temp&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;p&gt;我是组件：&#123;&#123;msg&#125;&#125;&lt;/p&gt;</span><br><span class="line">            &lt;button @click=&#x27;sonFn&#x27;&gt; 点击消灭新冠 &lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        //组件传递 子》父</span><br><span class="line">        //1.由父组件定义一个方法，通过@pfn传给子组件</span><br><span class="line">        //2.子组件通过$emit方法把数据传递给父组件定义的方法</span><br><span class="line"></span><br><span class="line">        Vue.component(&#x27;hello&#x27;, &#123;</span><br><span class="line">            template: &#x27;#temp&#x27;,</span><br><span class="line">            data() &#123;</span><br><span class="line">                return &#123;</span><br><span class="line">                    msg: &#x27;武汉加油 中国加油&#x27;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            methods: &#123;</span><br><span class="line">                sonFn() &#123;</span><br><span class="line">                    //通过$emit方法传递数据给父组件的方法，参数可以为多个</span><br><span class="line">                    this.$emit(&#x27;pfn&#x27;, &#x27;新冠被消灭了，中国威武&#x27;, &#x27;测试&#x27;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        var vm = new Vue(&#123;</span><br><span class="line">            el: &#x27;#app&#x27;,</span><br><span class="line">            data: &#123;</span><br><span class="line">                msg: &#x27;标题&#x27;</span><br><span class="line">            &#125;,</span><br><span class="line">            methods: &#123;</span><br><span class="line">                parentFn(data, data2) &#123;</span><br><span class="line">                    this.msg = data;</span><br><span class="line">                    console.log(data2)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h3 id="非父子组件传递数据"><a href="#非父子组件传递数据" class="headerlink" title="非父子组件传递数据"></a>非父子组件传递数据</h3><ul>
<li>可以使用一个空的 Vue 实例作为事件总线 bus</li>
<li>A 组件传递 B 组件数据 1.B 先通过 bus.$on绑定事件，2.A通过bus.$emit 方法调用 B 绑定的事件方法</li>
<li>$on和$emit 都是 bus 调用的</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;aaa&gt;&lt;/aaa&gt;</span><br><span class="line">        &lt;bbb&gt;&lt;/bbb&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        //可以使用一个空的 Vue 实例作为事件总线</span><br><span class="line">        var bus = new Vue()</span><br><span class="line">        //A组件传递B组件数据 1.B先通过bus.$on绑定事件，2.A通过bus.$emit方法调用B绑定的事件方法</span><br><span class="line">        //$on和$emit都是bus调用的</span><br><span class="line">        var vm = new Vue(&#123;</span><br><span class="line">            el: &#x27;#app&#x27;,</span><br><span class="line">            data: &#123;&#125;,</span><br><span class="line">            components: &#123;</span><br><span class="line">                aaa: &#123;</span><br><span class="line">                    template: `</span><br><span class="line">                        &lt;div&gt;</span><br><span class="line">                            &lt;h3&gt;我是组件AA&lt;/h3&gt;</span><br><span class="line">                            &lt;button @click=&#x27;fn&#x27;&gt; 点我传给B数据 &lt;/button&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    `,</span><br><span class="line">                    data() &#123;</span><br><span class="line">                        return &#123;</span><br><span class="line">                            msg: &#x27;A组件&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    methods: &#123;</span><br><span class="line">                        fn() &#123;</span><br><span class="line">                            bus.$emit(&#x27;bfn&#x27;, &#x27;组件A说：你好组件B&#x27;)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;,</span><br><span class="line">                bbb: &#123;</span><br><span class="line">                    template: `</span><br><span class="line">                        &lt;div&gt;</span><br><span class="line">                            &lt;h3&gt;我是组件BB&lt;/h3&gt;</span><br><span class="line">                            &lt;p&gt;&#123;&#123;msg&#125;&#125;&lt;/p&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    `,</span><br><span class="line">                    data() &#123;</span><br><span class="line">                        return &#123;</span><br><span class="line">                            msg: &#x27;我在等待数据...&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    created() &#123;</span><br><span class="line">                        //绑定事件 接收数据，当进入页面时走到这个钩子函数后就自动绑定事件了</span><br><span class="line">                        bus.$on(&#x27;bfn&#x27;, data =&gt; &#123;</span><br><span class="line">                            this.msg = data</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h3 id="组件中插槽使用"><a href="#组件中插槽使用" class="headerlink" title="组件中插槽使用"></a>组件中插槽使用</h3><blockquote>
<p>有时在使用组件的时候希望往组件中加入其它内容，在组件中通过插槽<slot></slot>来接收内容。插槽内可以包含任何模板代码，包括 HTML，甚至其它的组件；</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;hello&gt;</span><br><span class="line">      &lt;p&gt;赶走新冠&lt;/p&gt;</span><br><span class="line">    &lt;/hello&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;template id=&quot;temp&quot;&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;&#123;&#123;msg&#125;&#125;&lt;/p&gt;</span><br><span class="line">      &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">      &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line"></span><br><span class="line">  &lt;script&gt;</span><br><span class="line"></span><br><span class="line">    //当组件渲染的时候，&lt;slot&gt;&lt;/slot&gt; 将会被替换为&quot;赶走新冠&quot;。插槽内可以包含任何模板代码</span><br><span class="line">    //可以有多个插槽</span><br><span class="line">    Vue.component(&#x27;hello&#x27;,&#123;</span><br><span class="line">      template:&#x27;#temp&#x27;,</span><br><span class="line">      data()&#123;</span><br><span class="line">        return&#123;</span><br><span class="line">          msg:&#x27;武汉加油 中国加油&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    var vm = new Vue(&#123;</span><br><span class="line">      el: &#x27;#app&#x27;,</span><br><span class="line">      data: &#123;</span><br><span class="line">        msg:&#x27;赶走新冠&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h3 id="vue-中-ref-使用"><a href="#vue-中-ref-使用" class="headerlink" title="vue 中 ref 使用"></a>vue 中 ref 使用</h3><blockquote>
<p>使用 ref 注册后 可以使用 this.$refs 获取当前 DOM 对象，必须在 mounted()钩子函数之后才可以获取 DOM 对象；元素和组件都可以使用 ref 注册；</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;!-- 使用ref注册后  可以使用this.$refs.pp获取当前DOM对象 --&gt;</span><br><span class="line">        &lt;p ref=&#x27;pp&#x27;&gt;哈喽，大家好&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 组件也可以 --&gt;</span><br><span class="line">        &lt;hello ref=&quot;ho&quot;&gt;&lt;/hello&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        var vm = new Vue(&#123;</span><br><span class="line">            el: &#x27;#app&#x27;,</span><br><span class="line">            components: &#123;</span><br><span class="line">                hello: &#123;</span><br><span class="line">                    template: `&lt;h1&gt;大家好&lt;/h1&gt;`,</span><br><span class="line">                    data() &#123;</span><br><span class="line">                        return &#123;</span><br><span class="line">                            msg: &#x27;hello message&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    methods: &#123;</span><br><span class="line">                        fn() &#123;</span><br><span class="line">                            console.log(&quot;触发了事件11111&quot;)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            mounted() &#123;</span><br><span class="line">                console.log(this.$refs.pp)</span><br><span class="line">                this.$refs.pp.style.color = &#x27;red&#x27;;</span><br><span class="line"></span><br><span class="line">                console.log(this.$refs.ho.msg)</span><br><span class="line">                this.$refs.ho.fn()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h2 id="三、vue-router-路由"><a href="#三、vue-router-路由" class="headerlink" title="三、vue-router 路由"></a>三、vue-router 路由</h2><h3 id="路由基本使用"><a href="#路由基本使用" class="headerlink" title="路由基本使用"></a>路由基本使用</h3><ul>
<li>1.在当前文件夹下执行 npm init、npm init -y 初始化 package.json</li>
<li>2.然后执行 npm i -s vue、npm i -s vue-router 安装 vue 和 vue-router</li>
<li>3.在 node_modules 下找到 vue 和 vue-router 中的 js 并引入到项目中</li>
<li>4.创建组件</li>
<li>5.创建路由对象，并配置路由</li>
<li>6.在 Vue 实例中关联 router</li>
<li>7.路由入口</li>
<li>8.路由出口</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;!-- 6.路由入口 --&gt;</span><br><span class="line">        &lt;router-link to=&#x27;/home&#x27;&gt;首页&lt;/router-link&gt;</span><br><span class="line">        &lt;router-link to=&#x27;/me&#x27;&gt;我的&lt;/router-link&gt;</span><br><span class="line">        &lt;!-- 7.路由出口 --&gt;</span><br><span class="line">        &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script src=&quot;./node_modules/vue/dist/vue.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=&quot;./node_modules/vue-router/dist/vue-router.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        //首先先安装vue和vue-router</span><br><span class="line">        //1.在当前文件夹下执行npm init、npm init -y初始化package.json</span><br><span class="line">        //2.然后执行npm i -s vue、npm i -s vue-router安装vue和vue-router</span><br><span class="line">        //3.在node_modules下找到vue和vue-router中的js并引入到项目中</span><br><span class="line">        //4.先创建两个组件</span><br><span class="line">        const Home = Vue.component(&#x27;home&#x27;, &#123;</span><br><span class="line">            template: `&lt;h1&gt;我是Home组件&lt;/h1&gt;`</span><br><span class="line">        &#125;)</span><br><span class="line">        const Me = Vue.component(&#x27;me&#x27;, &#123;</span><br><span class="line">            template: `&lt;h1&gt;我是Me组件&lt;/h1&gt;`</span><br><span class="line">        &#125;)</span><br><span class="line">        //5.创建路由对象</span><br><span class="line">        const router = new VueRouter(&#123;</span><br><span class="line">            routes: [</span><br><span class="line">                &#123; path: &#x27;/home&#x27;, component: Home &#125;,</span><br><span class="line">                &#123; path: &#x27;/me&#x27;, component: Me &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;)</span><br><span class="line">        var vm = new Vue(&#123;</span><br><span class="line">            el: &#x27;#app&#x27;,</span><br><span class="line">            data: &#123;&#125;,</span><br><span class="line">            //将vue和router</span><br><span class="line">            router: router</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h3 id="重定向、高亮"><a href="#重定向、高亮" class="headerlink" title="重定向、高亮"></a>重定向、高亮</h3><blockquote>
<p>当第一次打开页面时，想要默认打开一个路由，就可以使用路由中的重定向；按钮的高亮样式不是我们喜欢的，可以使用 linkActiveClass 来自定义高亮元素的类名，然后再设置 css 样式就可以了；</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> //5.创建路由对象</span><br><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">    routes: [</span><br><span class="line">        //如果当前路径是&#x27;/&#x27;就redirect重定向 默认home组件</span><br><span class="line">        &#123; path: &#x27;/&#x27;, redirect: &#x27;/home&#x27; &#125;,</span><br><span class="line">        &#123; path: &#x27;/home&#x27;, component: Home &#125;,</span><br><span class="line">        &#123; path: &#x27;/me&#x27;, component: Me &#125;</span><br><span class="line">    ],</span><br><span class="line">    // 修改默认高亮的a标签的类名</span><br><span class="line">    // 如果是配合第三方组件库来实现菜单高亮，此时，只需要将类名设置为 第三方组件的类名即可</span><br><span class="line">    linkActiveClass: &#x27;now&#x27;</span><br><span class="line">&#125;)</span><br><span class="line"> &lt;style&gt;</span><br><span class="line">    /* .router-link-exact-active, */</span><br><span class="line">    /* .router-link-active &#123; */</span><br><span class="line">    .now &#123;</span><br><span class="line">        color: hotpink;</span><br><span class="line">        font-size: 30px;</span><br><span class="line">        text-decoration: none;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="路由传参方式"><a href="#路由传参方式" class="headerlink" title="路由传参方式"></a>路由传参方式</h3><blockquote>
<p>有时候多个路由都打开同一个组件，可以通过给组件传不同的参数展示不同的内容就可以了；通过路由打开不同组件传参也是一样的；<br><strong>导航分为两种</strong></p>
</blockquote>
<ul>
<li>1.声明式导航(router-link)</li>
<li>2.编程式导航($router.push)</li>
</ul>
<h3 id="声明式导航-router-link"><a href="#声明式导航-router-link" class="headerlink" title="声明式导航(router-link)"></a>声明式导航(router-link)</h3><ul>
<li>to 字符串：只能传递字符串</li>
<li>:to 对象：可以传递对象,可以通过 name、path 方式</li>
</ul>
<h3 id="编程式导航-router-push"><a href="#编程式导航-router-push" class="headerlink" title="编程式导航($router.push)"></a>编程式导航($router.push)</h3><ul>
<li><strong>this.router.push(name,params)</strong>;通过 name 跳转的状态栏里看不到参数类似 post;组件通过 route.params 获取参数;</li>
<li><strong>this.router.push(path,query)</strong>;通过 path 跳转的状态栏里可以看到参数类似 get;组件通过 route.query 获取参数;</li>
</ul>
<h3 id="监听路由变化"><a href="#监听路由变化" class="headerlink" title="监听路由变化"></a>监听路由变化</h3><blockquote>
<p>在组件中通过 watch 对象中监听路由的变化$route(to, from) {}，在这里可进行监听数据变化 进行网络请求等等；</p>
</blockquote>
<h4 id="详细使用方式请看下面代码"><a href="#详细使用方式请看下面代码" class="headerlink" title="详细使用方式请看下面代码"></a>详细使用方式请看下面代码</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;!-- 通过to字符串 --&gt;</span><br><span class="line">        &lt;router-link to=&quot;/home/1001&quot;&gt;1001号赛车&lt;/router-link&gt;</span><br><span class="line">        &lt;router-link to=&quot;/home/1002&quot;&gt;1002号赛车&lt;/router-link&gt;</span><br><span class="line">        &lt;!-- 通过$router.push&#123;&#125; --&gt;</span><br><span class="line">        &lt;a @click=&#x27;fn&#x27;&gt;1003号赛车&lt;/a&gt;</span><br><span class="line">        &lt;a @click=&#x27;fn1&#x27;&gt;1004号赛车&lt;/a&gt;</span><br><span class="line">        &lt;!-- 通过:to对象 --&gt;</span><br><span class="line">        &lt;router-link :to=&quot;&#123; name:&#x27;Home&#x27;,params:&#123;id:1005,title:&#x27;pjs&#x27;&#125;&#125;&quot;&gt;1005&lt;/router-link&gt;</span><br><span class="line">        &lt;router-link :to=&quot;&#123; path:&#x27;/home&#x27;,query:&#123;id:1006,title:&#x27;pjs&#x27;&#125;&#125;&quot;&gt;1006&lt;/router-link&gt;</span><br><span class="line"></span><br><span class="line">        &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        //导航分为两种：1.声明式导航(router-link)  2.编程式导航($router.push)</span><br><span class="line">        //1.通过to字符串</span><br><span class="line">        //2.$router.push&#123;&#125;</span><br><span class="line">        //3.通过:to对象</span><br><span class="line"></span><br><span class="line">        //通过name跳转的状态栏里看不到参数类似post，通过path跳转的状态栏里可以看到参数类似get</span><br><span class="line">        //通过$route.params或$route.query来获取参数</span><br><span class="line">        const Home = Vue.component(&#x27;home&#x27;, &#123;</span><br><span class="line">            template: `</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                    &lt;h1 v-if=&#x27;$route.params.id&#x27;&gt;欢迎来到主页面&#123;&#123; $route.params.id&#125;&#125;&lt;/h1&gt;</span><br><span class="line">                    &lt;h1 v-if=&#x27;$route.query.id&#x27;&gt;欢迎来到主页面&#123;&#123; $route.query.id&#125;&#125;&lt;/h1&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            `,</span><br><span class="line">            //监听路由变化，获取参数进行操作</span><br><span class="line">            watch: &#123;</span><br><span class="line">                 //只要路由发生的变化就会执行这个方法，to 跳转的目的地， from 从哪里来</span><br><span class="line">                $route(to, from) &#123;</span><br><span class="line">                    //在这里可进行监听数据变化 进行网络请求</span><br><span class="line">                    console.log(to)</span><br><span class="line">                    console.log(from)</span><br><span class="line">                    console.log(to.params.id)</span><br><span class="line">                    console.log(to.query.id)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        const router = new VueRouter(&#123;</span><br><span class="line">            routes: [</span><br><span class="line">                &#123; path: &#x27;/home/:id&#x27;, component: Home &#125;,</span><br><span class="line">                &#123; path: &#x27;/home&#x27;, name: &#x27;Home&#x27;, component: Home &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        var vm = new Vue(&#123;</span><br><span class="line">            el: &#x27;#app&#x27;,</span><br><span class="line">            router,</span><br><span class="line">            methods: &#123;</span><br><span class="line">                fn() &#123;</span><br><span class="line">                    this.$router.push(&#123;</span><br><span class="line">                        name: &#x27;Home&#x27;,//找到routes里匹配到name为Home</span><br><span class="line">                        params: &#123;</span><br><span class="line">                            id: 1003,</span><br><span class="line">                            title: &#x27;pjs&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;,</span><br><span class="line">                fn1() &#123;</span><br><span class="line">                    this.$router.push(&#123;</span><br><span class="line">                        path: &#x27;/home&#x27;,</span><br><span class="line">                        query: &#123;</span><br><span class="line">                            id: 1004,</span><br><span class="line">                            title: &#x27;pjs&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h3 id="路由嵌套-子路由"><a href="#路由嵌套-子路由" class="headerlink" title="路由嵌套-子路由"></a>路由嵌套-子路由</h3><ul>
<li>路由是可以嵌套的，即：路由中又包含子路由</li>
<li>规则：父组件中包含 router-view，在路由规则中使用 children 配置</li>
<li>使用 children 里配置子路由，子路由的 path 里不需要加&#x2F;符号了</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;router-link to=&#x27;/home&#x27;&gt;首页&lt;/router-link&gt;</span><br><span class="line">        &lt;router-link to=&#x27;/user&#x27;&gt;我的&lt;/router-link&gt;</span><br><span class="line">        &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script&gt;</span><br><span class="line"></span><br><span class="line">        //路由是可以嵌套的，即：路由中又包含子路由</span><br><span class="line">        //规则：父组件中包含 router-view，在路由规则中使用 children 配置</span><br><span class="line">        const Home = Vue.component(&#x27;home&#x27;, &#123;</span><br><span class="line">            template: `</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                    &lt;router-link to=&#x27;/home/cartA&#x27;&gt;买车&lt;/router-link&gt;</span><br><span class="line">                    &lt;router-link to=&#x27;/home/cartB&#x27;&gt;卖车&lt;/router-link&gt;</span><br><span class="line">                    &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            `</span><br><span class="line">        &#125;)</span><br><span class="line">        const CartA = &#123;</span><br><span class="line">            template: `&lt;h3&gt;买什么样的车？&lt;/h3&gt;`</span><br><span class="line">        &#125;</span><br><span class="line">        const CartB = &#123;</span><br><span class="line">            template: `&lt;h3&gt;卖什么样的车？&lt;/h3&gt;`</span><br><span class="line">        &#125;</span><br><span class="line">        const User = Vue.component(&#x27;user&#x27;, &#123;</span><br><span class="line">            template: `</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                    这里是个人信息</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            `</span><br><span class="line">        &#125;)</span><br><span class="line">        const router = new VueRouter(&#123;</span><br><span class="line">            routes: [</span><br><span class="line">                &#123;</span><br><span class="line">                    path: &#x27;/home&#x27;, component: Home,</span><br><span class="line">                    //使用children里配置子路由，子路由的path里不需要加/符号了</span><br><span class="line">                    children: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            path: &#x27;cartA&#x27;,</span><br><span class="line">                            component: CartA</span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            path:&#x27;cartB&#x27;,</span><br><span class="line">                            component:CartB</span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123; path: &#x27;/user&#x27;, component: User &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;)</span><br><span class="line">        var vm = new Vue(&#123;</span><br><span class="line">            el: &#x27;#app&#x27;,</span><br><span class="line">            router</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<h2 id="四、vuex"><a href="#四、vuex" class="headerlink" title="四、vuex"></a>四、vuex</h2><blockquote>
<p>Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。意思就是所有组件共同操作一份数据，都可以对它进行增删改查。</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">属性</th>
<th align="center">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="center">State</td>
<td align="center">共享数据都存在这里</td>
</tr>
<tr>
<td align="center">Mutation</td>
<td align="center">更改 State 中数据的唯一方法，同步操作</td>
</tr>
<tr>
<td align="center">Action</td>
<td align="center">异步操作 Mutation 来更改 State 中的数据</td>
</tr>
<tr>
<td align="center">Getter</td>
<td align="center">基于 state 的派生状态，可理解为组件中的计算属性</td>
</tr>
</tbody></table>
<h3 id="State"><a href="#State" class="headerlink" title="State"></a>State</h3><ul>
<li>1.安装 vuex npm i -s vuex</li>
<li>2.创建 store 对象</li>
<li>3.把 vue 和 store 进行关联</li>
<li>4.使用$store.state 中的数据</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;!-- 4.使用$store.state中的数据 --&gt;</span><br><span class="line">        &lt;h1&gt;&#123;&#123;this.$store.state.name&#125;&#125;&lt;/h1&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        //1.安装vuex npm i -s vuex</span><br><span class="line">        //2.创建store对象</span><br><span class="line">        let store = new Vuex.Store(&#123;</span><br><span class="line">            /**</span><br><span class="line">            *   state中可以存储任何类型的值</span><br><span class="line">            */</span><br><span class="line">            state: &#123;</span><br><span class="line">                name: &#x27;邓紫棋&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        let vm = new Vue(&#123;</span><br><span class="line">            el: &#x27;#app&#x27;,</span><br><span class="line">            data: &#123;&#125;,</span><br><span class="line">            //3.把vue和store进行关联</span><br><span class="line">            store,</span><br><span class="line">            mounted() &#123;</span><br><span class="line">                //可以获取store对象</span><br><span class="line">                console.log(this.$store)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/3735156-7bac355c4d38d857.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/517/format/webp" alt="image"></p>
<h3 id="Mutation"><a href="#Mutation" class="headerlink" title="Mutation"></a>Mutation</h3><blockquote>
<p>mutation 是更改 store 中状态的唯一方法,vuex 中规定只能通过提交 mutation 的方式去更改 store 中的状态,store.commit()方法更改数据。</p>
</blockquote>
<ul>
<li>无参数</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//调用方 只传一个方法名</span><br><span class="line">this.$store.commit(&#x27;changeName&#x27;)</span><br><span class="line">//接收方 默认第一个参数是state，无参接收</span><br><span class="line"> changeName(state) &#123;</span><br><span class="line">    state.name = &#x27;张韶涵&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>载荷提交，只能提交一个参数</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//调用方，第一个参数：方法名，第二个参数：参数</span><br><span class="line">this.$store.commit(&#x27;changeName&#x27;,this.msg)</span><br><span class="line">//接收方</span><br><span class="line"> changeName(state, name) &#123;</span><br><span class="line">    state.name = name ? name : &#x27;张韶涵&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>载荷对象提交</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//调用方，传递一个对象</span><br><span class="line">this.$store.commit(&#x27;changeName&#x27;,&#123;</span><br><span class="line">   name:this.msg</span><br><span class="line">&#125;)</span><br><span class="line">//接收方</span><br><span class="line">changeName(state, payload) &#123;</span><br><span class="line">    state.name = payload.name ;</span><br><span class="line">    state.sex = payload.sex//给state新增一个属性</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>纯对象风格提交 type 值是方法名</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//提交一个纯对象当做参数，type值为方法名</span><br><span class="line">this.$store.commit(&#123;</span><br><span class="line">    type: &#x27;changeName&#x27;,</span><br><span class="line">    name: this.msg,</span><br><span class="line">    sex: &#x27;男&#x27;</span><br><span class="line">&#125;)</span><br><span class="line">//接收方</span><br><span class="line">changeName(state, payload) &#123;</span><br><span class="line">    state.name = payload.name ;</span><br><span class="line">    state.sex = payload.sex//给state新增一个属性</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>案例</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;!-- 组件AAA和组件BBB共同操作$store.state中的数据 --&gt;</span><br><span class="line">        &lt;!-- 比我们之前学的组件之间通讯更加方便 --&gt;</span><br><span class="line">        &lt;AAA&gt;&lt;/AAA&gt;</span><br><span class="line">        &lt;BBB&gt;&lt;/BBB&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        /**</span><br><span class="line">        *  mutation是更改store中状态的唯一方法</span><br><span class="line">        *  vuex中规定只能通过提交mutation的方式去更改store中的状态</span><br><span class="line">        *  store.commit()更改数据</span><br><span class="line">        */</span><br><span class="line">        let store = new Vuex.Store(&#123;</span><br><span class="line">            state: &#123;</span><br><span class="line">                name: &#x27;邓紫棋&#x27;</span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line">            /**</span><br><span class="line">            *   mutations对象中自定义方法来操作state中的数据</span><br><span class="line">            *   并且每个方法会接受 state 作为第一个参数</span><br><span class="line">            *   注意：Store对象中写mutations；Mutation 必须是同步函数</span><br><span class="line">            */</span><br><span class="line">            mutations: &#123;</span><br><span class="line">                //不接收参数</span><br><span class="line">                changeName(state) &#123;</span><br><span class="line">                    state.name = &#x27;张韶涵&#x27;</span><br><span class="line">                &#125;,</span><br><span class="line">                //只接收一个参数</span><br><span class="line">                changeName(state, name) &#123;</span><br><span class="line">                    state.name = name ? name : &#x27;张韶涵&#x27;;</span><br><span class="line">                &#125;,</span><br><span class="line">                //接收参数对象</span><br><span class="line">                changeName(state, payload) &#123;</span><br><span class="line">                    state.name = payload.name ? payload.name : &#x27;张韶涵&#x27;;</span><br><span class="line">                    state.sex = payload.sex//给state新增一个属性</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        //创建两个组件</span><br><span class="line">        const AAA = Vue.component(&#x27;aaa&#x27;, &#123;</span><br><span class="line">            template: `</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                    &lt;!-- 4.使用$store.state中的数据 --&gt;</span><br><span class="line">                    &lt;h1&gt;&#123;&#123;this.$store.state.name&#125;&#125;&lt;/h1&gt;</span><br><span class="line">                    &lt;h2&gt;&#123;&#123;this.$store.state.sex&#125;&#125;&lt;/h2&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            `</span><br><span class="line">        &#125;)</span><br><span class="line">        const BBB = Vue.component(&#x27;bbb&#x27;, &#123;</span><br><span class="line">            template: `</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                    &lt;input type=&quot;text&quot; placeholder=&quot;请输入姓名&quot; v-model=&#x27;msg&#x27;&gt;</span><br><span class="line">                    &lt;input type=&quot;button&quot; value=&quot;确定&quot; @click=&#x27;change&#x27;&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            `,</span><br><span class="line">            data() &#123;</span><br><span class="line">                return &#123;</span><br><span class="line">                    msg: &#x27;&#x27;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            methods: &#123;</span><br><span class="line">                change() &#123;</span><br><span class="line">                    //1.无参数</span><br><span class="line">                    // this.$store.commit(&#x27;changeName&#x27;)</span><br><span class="line"></span><br><span class="line">                    //2.载荷提交，只能提交一个参数</span><br><span class="line">                    // this.$store.commit(&#x27;changeName&#x27;,this.msg)</span><br><span class="line"></span><br><span class="line">                    //3.载荷对象提交</span><br><span class="line">                    // this.$store.commit(&#x27;changeName&#x27;,&#123;</span><br><span class="line">                    //     name:this.msg</span><br><span class="line">                    // &#125;)</span><br><span class="line"></span><br><span class="line">                    //4.纯对象风格提交 type值是方法名</span><br><span class="line">                    this.$store.commit(&#123;</span><br><span class="line">                        type: &#x27;changeName&#x27;,</span><br><span class="line">                        name: this.msg,</span><br><span class="line">                        sex: &#x27;男&#x27;</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        let vm = new Vue(&#123;</span><br><span class="line">            el: &#x27;#app&#x27;,</span><br><span class="line">            //把vue和store进行关联</span><br><span class="line">            store</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/3735156-46e377f77e8f06bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/706/format/webp" alt="image"></p>
<h3 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h3><blockquote>
<p>mutation 中规则上是不允许异步操作的,于是 vuex 为我们提供了 action。actions 对象中自定义方法来操作 mutations,并且每个方法会接受 context 作为第一个参数,context 对象与 store 对象具有相同的方法和属性;action 与 mutation 除了使用了异步操作和调用 mutation，其它使用并无差别 ;</p>
</blockquote>
<ul>
<li>异步更新数据</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">//action事件的触发同样可以使用载荷和对象两种方式,其它方式就不写了和mutations方式一样</span><br><span class="line">this.$store.dispatch(&#123;</span><br><span class="line">    type:&#x27;changeNameAsync&#x27;,//Store.actions中的方法名</span><br><span class="line">    name: this.msg,</span><br><span class="line">    sex: &#x27;男&#x27;</span><br><span class="line">&#125;)</span><br><span class="line">actions: &#123;</span><br><span class="line">    //接收数据 延迟一秒提交数据</span><br><span class="line">    changeNameAsync(context, payload) &#123;</span><br><span class="line">    //异步操作</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">        context.commit(&#x27;changeName&#x27;,payload)</span><br><span class="line">    &#125;, 1000)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">mutations: &#123;</span><br><span class="line">    //接收参数对象</span><br><span class="line">    changeName(state, payload) &#123;</span><br><span class="line">    state.name = payload.name ;</span><br><span class="line">    state.sex = payload.sex//给state新增一个属性</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>案例</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;AAA&gt;&lt;/AAA&gt;</span><br><span class="line">        &lt;BBB&gt;&lt;/BBB&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        /**</span><br><span class="line">        *  action--异步更改状态</span><br><span class="line">        *  mutation中规则上是不允许异步操作的,于是vuex为我们提供了action。</span><br><span class="line">        *  store.dispatch() 方法触发</span><br><span class="line">        */</span><br><span class="line">        let store = new Vuex.Store(&#123;</span><br><span class="line">            state: &#123;</span><br><span class="line">                name: &#x27;邓紫棋&#x27;</span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line">            /**</span><br><span class="line">            *   mutations只能同步执行</span><br><span class="line">            */</span><br><span class="line">            mutations: &#123;</span><br><span class="line">                //接收参数对象</span><br><span class="line">                changeName(state, payload) &#123;</span><br><span class="line">                    state.name = payload.name ? payload.name : &#x27;张韶涵&#x27;;</span><br><span class="line">                    state.sex = payload.sex//给state新增一个属性</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            /**</span><br><span class="line">            *   actions对象中自定义方法来操作mutations,并且每个方法会接受 context 作为第一个参数;</span><br><span class="line">            *   context对象与store对象具有相同的方法和属性</span><br><span class="line">            *   action 与 mutation 除了使用了异步操作和调用mutation，其它使用并无差别</span><br><span class="line">            */</span><br><span class="line">            actions: &#123;</span><br><span class="line">                //接收数据</span><br><span class="line">                changeNameAsync(context, payload) &#123;</span><br><span class="line">                    //异步操作</span><br><span class="line">                    setTimeout(() =&gt; &#123;</span><br><span class="line">                        context.commit(&#123;</span><br><span class="line">                            type: &#x27;changeName&#x27;,</span><br><span class="line">                            name: payload.name,</span><br><span class="line">                            sex: &#x27;男&#x27;</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;, 1000)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        //创建两个组件</span><br><span class="line">        const AAA = Vue.component(&#x27;aaa&#x27;, &#123;</span><br><span class="line">            template: `</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                    &lt;!-- 4.使用$store.state中的数据 --&gt;</span><br><span class="line">                    &lt;h1&gt;&#123;&#123;this.$store.state.name&#125;&#125;&lt;/h1&gt;</span><br><span class="line">                    &lt;h2&gt;&#123;&#123;this.$store.state.sex&#125;&#125;&lt;/h2&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            `</span><br><span class="line">        &#125;)</span><br><span class="line">        const BBB = Vue.component(&#x27;bbb&#x27;, &#123;</span><br><span class="line">            template: `</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                    &lt;input type=&quot;text&quot; placeholder=&quot;请输入姓名&quot; v-model=&#x27;msg&#x27;&gt;</span><br><span class="line">                    &lt;input type=&quot;button&quot; value=&quot;确定&quot; @click=&#x27;change&#x27;&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            `,</span><br><span class="line">            data() &#123;</span><br><span class="line">                return &#123;</span><br><span class="line">                    msg: &#x27;&#x27;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            methods: &#123;</span><br><span class="line">                change() &#123;</span><br><span class="line">                    //action事件的触发同样可以使用载荷和对象两种方式,其它方式就不写了和mutations方式一样</span><br><span class="line">                    this.$store.dispatch(&#123;</span><br><span class="line">                        type:&#x27;changeNameAsync&#x27;,//Store.actions中的方法名</span><br><span class="line">                        name: this.msg</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        let vm = new Vue(&#123;</span><br><span class="line">            el: &#x27;#app&#x27;,</span><br><span class="line">            store</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/3735156-1bb9c077d8bc7f10.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/709/format/webp" alt="image"></p>
<h3 id="getter"><a href="#getter" class="headerlink" title="getter"></a>getter</h3><blockquote>
<p>getters 类似 Vue 实例中的计算属性，当绑定的属性发生变化后才会重新计算;每个方法都默认接收 state 参数。</p>
</blockquote>
<ul>
<li>getters 使用</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//在getters下创建一个getName方法，默认接收state，此方法和计算属性用法一样，当state中的name发生改变时会重新计算这个方法return结果</span><br><span class="line">getters:&#123;</span><br><span class="line">    getName(state)&#123;</span><br><span class="line">        let myName=&#x27;&#x27;;</span><br><span class="line">        if(state.name === &#x27;彭俊山&#x27;)&#123;</span><br><span class="line">            myName = &#x27;你是最帅的！&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        return state.name + myName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//在A组件中使用getters下的getName属性，当B组件修改了state中的name后A组件中h2数据也会变化</span><br><span class="line">&lt;h2&gt;&#123;&#123;this.$store.getters.getName&#125;&#125;&lt;/h2&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>案例</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;AAA&gt;&lt;/AAA&gt;</span><br><span class="line">        &lt;BBB&gt;&lt;/BBB&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        let store = new Vuex.Store(&#123;</span><br><span class="line">            state: &#123;</span><br><span class="line">                name: &#x27;邓紫棋&#x27;</span><br><span class="line">            &#125;,</span><br><span class="line">            mutations: &#123;</span><br><span class="line">                //接收参数对象</span><br><span class="line">                changeName(state, payload) &#123;</span><br><span class="line">                    state.name = payload.name ? payload.name : &#x27;张韶涵&#x27;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            /**</span><br><span class="line">            *   getters类似Vue实例中的计算属性，当绑定的属性发生变化后才会重新计算</span><br><span class="line">            *   每个方法都默认接收state参数</span><br><span class="line">            */</span><br><span class="line">            getters:&#123;</span><br><span class="line">                getName(state)&#123;</span><br><span class="line">                    let myName=&#x27;&#x27;;</span><br><span class="line">                    if(state.name === &#x27;彭俊山&#x27;)&#123;</span><br><span class="line">                        myName = &#x27;你是最帅的！&#x27;</span><br><span class="line">                    &#125;</span><br><span class="line">                    return state.name + myName;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        //创建两个组件</span><br><span class="line">        const AAA = Vue.component(&#x27;aaa&#x27;, &#123;</span><br><span class="line">            template: `</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                    &lt;!-- 使用$store.state中的数据 --&gt;</span><br><span class="line">                    &lt;h1&gt;&#123;&#123;this.$store.state.name&#125;&#125;&lt;/h1&gt;</span><br><span class="line">                    &lt;!-- 使用$store.getters中的属性 --&gt;</span><br><span class="line">                    &lt;h2&gt;&#123;&#123;this.$store.getters.getName&#125;&#125;&lt;/h2&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            `</span><br><span class="line">        &#125;)</span><br><span class="line">        const BBB = Vue.component(&#x27;bbb&#x27;, &#123;</span><br><span class="line">            template: `</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                    &lt;input type=&quot;text&quot; placeholder=&quot;请输入姓名&quot; v-model=&#x27;msg&#x27;&gt;</span><br><span class="line">                    &lt;input type=&quot;button&quot; value=&quot;确定&quot; @click=&#x27;change&#x27;&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            `,</span><br><span class="line">            data() &#123;</span><br><span class="line">                return &#123;</span><br><span class="line">                    msg: &#x27;&#x27;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            methods: &#123;</span><br><span class="line">                change() &#123;</span><br><span class="line">                    //纯对象风格提交 type值是方法名</span><br><span class="line">                    this.$store.commit(&#123;</span><br><span class="line">                        type: &#x27;changeName&#x27;,</span><br><span class="line">                        name: this.msg</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        let vm = new Vue(&#123;</span><br><span class="line">            el: &#x27;#app&#x27;,</span><br><span class="line">            store</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/3735156-ae75344b34e3a726.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/709/format/webp" alt="image"></p>
<h3 id="vuex-刷新页面-store-数据丢失"><a href="#vuex-刷新页面-store-数据丢失" class="headerlink" title="vuex 刷新页面 store 数据丢失"></a>vuex 刷新页面 store 数据丢失</h3><blockquote>
<p>当刷新页面后，store 中的数据都会丢失；将 store 的数据存储在 storage 里，由于 vue 多为单页面应用，且每次重新打开页面需要保持数据为空 所以这里我们不选用 localStorage，用 sessionStorage 会话机制;</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">created() &#123;</span><br><span class="line">    //在页面加载时读取sessionStorage里的状态信息</span><br><span class="line">    if (sessionStorage.getItem(&quot;store&quot;)) &#123;</span><br><span class="line">        this.$store.replaceState(Object.assign(&#123;&#125;, this.$store.state, JSON.parse(sessionStorage.getItem(&quot;store&quot;))))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //在页面刷新时将vuex里的信息保存到sessionStorage里</span><br><span class="line">    window.addEventListener(&quot;beforeunload&quot;, () =&gt; &#123;</span><br><span class="line">        sessionStorage.setItem(&quot;store&quot;, JSON.stringify(this.$store.state))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/16/Angular%E2%80%94%E2%80%94%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/portal.jpg">
      <meta itemprop="name" content="Bruce Chen">
      <meta itemprop="description" content="It's better to burn out than to fade away.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Chen's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/16/Angular%E2%80%94%E2%80%94%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/" class="post-title-link" itemprop="url">Angular——前端知识点总结</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-12-16 14:17:35 / 修改时间：14:19:21" itemprop="dateCreated datePublished" datetime="2022-12-16T14:17:35+08:00">2022-12-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E6%80%BB%E7%BB%93/" itemprop="url" rel="index"><span itemprop="name">前端框架总结</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="一、Angular-概述"><a href="#一、Angular-概述" class="headerlink" title="一、Angular 概述"></a>一、Angular 概述</h2><p>基于命令行的开发方式？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">①hot reload</span><br><span class="line">②编译工作</span><br><span class="line">③集成了webpack打包工具</span><br><span class="line">。。。。</span><br></pre></td></tr></table></figure>

<ul>
<li><a target="_blank" rel="noopener" href="http://angular.cn/">http://angular.cn</a> 中文</li>
<li><a target="_blank" rel="noopener" href="http://angular.io/">http://angular.io</a> 正式官网</li>
<li><a target="_blank" rel="noopener" href="http://angular.cn/guide/styleguide">http://angular.cn/guide/styleguide</a> 风格指南</li>
</ul>
<h3 id="1、what？"><a href="#1、what？" class="headerlink" title="1、what？"></a>1、what？</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">angular是一个Google推出的js框架，是以模块为基本单位，模块又可以包含组件、指令、过滤器。。</span><br><span class="line"></span><br><span class="line">1.1 版本问题</span><br><span class="line">    angular angular2.0以后所有的版本统称为angular</span><br><span class="line">    (当前学习ng4.0)</span><br><span class="line"></span><br><span class="line">    angular.js angular1.* 统称为angular.js</span><br><span class="line">    （http://www.runoob.com/angularjs/angularjs-tutorial.html）</span><br><span class="line"></span><br><span class="line">1.2 版本之间的区别</span><br><span class="line">    ①新版本是有组件的概念的</span><br><span class="line">    ②老版本是$scope和controller为主</span><br><span class="line">    ③angular引入了rxjs</span><br><span class="line">    ④angular采用ts（typescript是es6的超集，是由微软和谷歌） ts是一种强类型检查机制的语言</span><br><span class="line">    ⑤angular可读性、提高了代码的复用率、维护成本变低。。。</span><br></pre></td></tr></table></figure>

<h3 id="2、where"><a href="#2、where" class="headerlink" title="2、where"></a>2、where</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">可以使用支持angular的Ionic框架来实现移动端的开发，直接使用angular来实现pc端的开发</span><br><span class="line"></span><br><span class="line">实现操作比较频繁的SPA</span><br></pre></td></tr></table></figure>

<h3 id="3、why"><a href="#3、why" class="headerlink" title="3、why"></a>3、why</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">①遵循w3c所推出的webComponent标准（组件化）</span><br><span class="line">②代码具有更好的可读性和可维护性、</span><br><span class="line">③引入了更多的高效率的工具 ，比如rxjs\immutable.js。。。， 让代码的编译、部署更简单</span><br><span class="line">④ts --》 健壮</span><br></pre></td></tr></table></figure>

<h3 id="4、how"><a href="#4、how" class="headerlink" title="4、how"></a>4、how</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">angular的开发整体框架，是有8大组成部分构成</span><br><span class="line"></span><br><span class="line">搭建环境的方式：</span><br><span class="line">方式1：</span><br><span class="line">    ①下载quickstart-master.zip压缩包</span><br><span class="line">    https://github.com/angular/quickstart download</span><br><span class="line">    或者 直接拷贝老师提供的压缩包</span><br><span class="line">    ②解压缩 压缩包，进入对应的目录中</span><br><span class="line">    执行npm install 安装项目所需要用到的依赖</span><br><span class="line">    ③npm start 启动开发服务器</span><br><span class="line"></span><br><span class="line">方式2：</span><br><span class="line">    Angular CLI是一个命令行界面工具，它可以创建项目、</span><br><span class="line">    添加文件以及执行一大堆开发任务，比如测试、打包和发布。</span><br><span class="line">    //安装基于angular的命令工具</span><br><span class="line">    npm install -g @angular/cli</span><br><span class="line">    //创建一个有着ng模板的项目</span><br><span class="line">    ng new my-app</span><br><span class="line">    //进入当前目录下的my-app</span><br><span class="line">    cd my-app</span><br><span class="line">    //启动开发服务器</span><br><span class="line">    ng serve --open</span><br></pre></td></tr></table></figure>

<h2 id="二、Angular-模板项目的启动流程"><a href="#二、Angular-模板项目的启动流程" class="headerlink" title="二、Angular 模板项目的启动流程"></a>二、Angular 模板项目的启动流程</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">index.html</span><br><span class="line"></span><br><span class="line">main.js (main.ts)--&gt;启动一个模块 AppModule</span><br><span class="line"></span><br><span class="line">app/app.module.ts ---&gt; 启动一个组件 app/app.component.ts</span><br><span class="line"></span><br><span class="line">Hello Angular</span><br></pre></td></tr></table></figure>

<h2 id="三、完成组件的创建和使用"><a href="#三、完成组件的创建和使用" class="headerlink" title="三、完成组件的创建和使用"></a>三、完成组件的创建和使用</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">1、创建组件和使用组件</span><br><span class="line">    ①创建文件 app/test/test.component.ts</span><br><span class="line">    ②将类装饰成一个组件类</span><br><span class="line">        import &#123;Component&#125; from &#x27;@angular/core&#x27;</span><br><span class="line"></span><br><span class="line">        @Component(&#123;</span><br><span class="line">            selector:&#x27;test&#x27;,</span><br><span class="line">            template:`&lt;h1&gt;it is a test&lt;/h1&gt;`</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        export class Demo01Component&#123;</span><br><span class="line">        &#125;</span><br><span class="line">    ③使用组件</span><br><span class="line">        ①到模块中声明</span><br><span class="line">            app.module.ts中，</span><br><span class="line">            import &#123;TestComponent&#125; from &#x27;./test/test.component&#x27;</span><br><span class="line"></span><br><span class="line">            @NgModule(&#123;</span><br><span class="line">                declarations:[TestComponent]</span><br><span class="line">            &#125;)</span><br><span class="line">        ②&lt;test&gt;&lt;/test&gt;</span><br><span class="line"></span><br><span class="line">    练习：（16:50 - 17:00）</span><br><span class="line">        demo02/demo02.component.ts</span><br><span class="line">        组件中渲染一个无序列表（5个列表）</span><br><span class="line"></span><br><span class="line">        将组件渲染AppComponent</span><br></pre></td></tr></table></figure>

<h2 id="四、Angular-中常见的指令"><a href="#四、Angular-中常见的指令" class="headerlink" title="四、Angular 中常见的指令"></a>四、Angular 中常见的指令</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1、循环指令</span><br><span class="line">Vue :  &lt;any v-for=&quot;tmp in list&quot;&gt;&lt;/any&gt;</span><br><span class="line"></span><br><span class="line">Angular:</span><br><span class="line">        语法：</span><br><span class="line">   &lt;any *ngFor=&quot;let tmp of list&quot;&gt;&lt;/any&gt;</span><br><span class="line">   &lt;any *ngFor=&quot;let tmp of list;let myIndex=index&quot;&gt;&lt;/any&gt;</span><br><span class="line"></span><br><span class="line">2、选择指令</span><br><span class="line">Vue: &lt;any v-if=&quot;表达式&quot;&gt;&lt;/any&gt;</span><br><span class="line">angular:</span><br><span class="line">        &lt;any *ngIf=&quot;表达式&quot;&gt;&lt;/any&gt;</span><br></pre></td></tr></table></figure>

<h2 id="五、常见指令"><a href="#五、常见指令" class="headerlink" title="五、常见指令"></a>五、常见指令</h2><p>指令和组件的关系：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">组件就是一个带有模板的指令！！！</span><br></pre></td></tr></table></figure>

<h3 id="1、多重分支判断"><a href="#1、多重分支判断" class="headerlink" title="1、多重分支判断"></a>1、多重分支判断</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vue</span><br><span class="line">    v-if</span><br><span class="line">    v-else-if</span><br><span class="line">    v-else</span><br><span class="line"></span><br><span class="line">&lt;div [ngSwitch]=&quot;answer&quot;&gt;</span><br><span class="line">    &lt;p *ngSwitchCase=&quot;&#x27;a&#x27;&quot;&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p *ngSwitchDefault&gt;&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2、属性绑定"><a href="#2、属性绑定" class="headerlink" title="2、属性绑定"></a>2、属性绑定</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Vue:</span><br><span class="line">    &lt;img v-bind:src=&quot;imgUrl&quot;/&gt;</span><br><span class="line">    &lt;img :src=&quot;imgUrl&quot;/&gt;</span><br><span class="line">    &lt;button :class=&quot;&#123;myHightlight:true&#125;&quot;&gt;&lt;/button&gt;</span><br><span class="line">    &lt;h1 :style=&quot;&#123;backgroundColor:myBG&#125;&quot;&gt;&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">Angular:</span><br><span class="line">    &lt;img [src]=&quot;imgUrl&quot;/&gt;</span><br><span class="line">    &lt;button [ngClass]=&quot;&#123;myHightlight:true&#125;&quot;&gt;&lt;/button&gt;</span><br><span class="line">    &lt;h1 [ngStyle]=&quot;&#123;backgroundColor:myBG&#125;&quot;&gt;</span><br><span class="line">    &lt;/h1&gt;</span><br></pre></td></tr></table></figure>

<h3 id="3、事件绑定"><a href="#3、事件绑定" class="headerlink" title="3、事件绑定"></a>3、事件绑定</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Vue</span><br><span class="line">    &lt;button v-on:click=&quot;handleClick&quot;&gt;&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;handleClick&quot;&gt;&lt;/button&gt;</span><br><span class="line">Angular</span><br><span class="line">    语法：</span><br><span class="line">    &lt;any (eventName)=&quot;eventHandler()&quot;&gt;&lt;/any&gt;</span><br><span class="line">    举例：</span><br><span class="line">    &lt;button (click)=&quot;handleClick()&quot;&gt;&lt;/button&gt;</span><br></pre></td></tr></table></figure>

<h3 id="4、双向数据绑定"><a href="#4、双向数据绑定" class="headerlink" title="4、双向数据绑定"></a>4、双向数据绑定</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Vue:</span><br><span class="line">    &lt;input v-model=&quot;addr&quot;/&gt;</span><br><span class="line">Angular:</span><br><span class="line">    &lt;input [(ngModel)]=&quot;addr&quot;/&gt;</span><br><span class="line"></span><br><span class="line">依赖注入：</span><br><span class="line">    将依赖的东西注入到指定的地方，让依赖可被使用</span><br><span class="line">    举例：AppModule依赖于FormsModule,</span><br><span class="line">    只需要在AppModule的imports数组写上FormsModule名称</span><br><span class="line">    就可以使用FormsModule所提供的东西。</span><br><span class="line">    好处：解耦，降低了耦合度</span><br><span class="line"></span><br><span class="line">Angular中如果想要监听双向数据绑定数据的变化，提供一个事件 ngModelChange</span><br><span class="line"></span><br><span class="line">注意事项：</span><br><span class="line">①Angular中如果要想使用双向数据绑定，就必须指定模块依赖于FormsModule</span><br><span class="line">②使用ngModelChange事件时，通过$event去传递用户当前所输入的信息</span><br><span class="line">    （ngModelChange）=&quot;handleChange($event)&quot;</span><br></pre></td></tr></table></figure>

<p><strong>内置的指令：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">*ngFor</span><br><span class="line">*ngIf</span><br><span class="line">*ngSwitchCase</span><br><span class="line">*ngSwitchDefault</span><br><span class="line">ngSwitch</span><br><span class="line">[]</span><br><span class="line">()</span><br><span class="line">[(ngModel)]</span><br><span class="line">&#123;&#123;&#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5、自定义指令"><a href="#5、自定义指令" class="headerlink" title="5、自定义指令"></a>5、自定义指令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">Vue中自定义指令：</span><br><span class="line">    Vue.directive(&#x27;change&#x27;,&#123;</span><br><span class="line">        bind:function(el,binding)&#123;&#125;,</span><br><span class="line">        update:function()&#123;&#125;,</span><br><span class="line">        unbind:function()&#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    v-change</span><br><span class="line">Angular中指令创建和使用</span><br><span class="line"></span><br><span class="line">5.1 创建</span><br><span class="line">    import &#123;Directive&#125;    from &#x27;@angular/core&#x27;</span><br><span class="line"></span><br><span class="line">    @Directive(&#123;</span><br><span class="line">        selector:&#x27;[test]&#x27;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    export class TestDirective&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">5.2 使用</span><br><span class="line">    ①到模块中声明</span><br><span class="line">        app.module.ts</span><br><span class="line">            import &#123;TestDirective&#125; from &#x27;***&#x27;</span><br><span class="line">            @NgModule(&#123;</span><br><span class="line">                declarations:[TestDirective]</span><br><span class="line">            &#125;)</span><br><span class="line">    ②作为标签的属性</span><br><span class="line">        &lt;h1 test&gt;&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">5.3 得到调用指令的元素</span><br><span class="line">    ①import &#123;ElementRef&#125; from &#x27;@angular/core&#x27;</span><br><span class="line">    ②实例化</span><br><span class="line">        constructor(private el:ElementRef)&#123;&#125;</span><br><span class="line">    ③读取元素</span><br><span class="line">        this.el.nativeElement</span><br><span class="line"></span><br><span class="line">5.4 指令调用时传参？？</span><br><span class="line">    ①&lt;h1 test=&quot;123&quot;&gt;&lt;/h1&gt;</span><br><span class="line">    ②在指令类的内部</span><br><span class="line">        import &#123;Input&#125; from &#x27;@angular/core&#x27;</span><br><span class="line"></span><br><span class="line">        @Input() test=&quot;&quot;;</span><br><span class="line"></span><br><span class="line">        this.test</span><br><span class="line"></span><br><span class="line">补充：使用生命周期的处理函数？</span><br><span class="line">    ①引入</span><br><span class="line">        import &#123;OnDestroy&#125; from &#x27;@angular/core&#x27;</span><br><span class="line">    ②在定义类的时候 实现接口类</span><br><span class="line">        export class Test implements OnDestroy&#123;</span><br><span class="line">            ngOnDestroy()&#123;&#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h2 id="六、组件之间通信"><a href="#六、组件之间通信" class="headerlink" title="六、组件之间通信"></a>六、组件之间通信</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Vue中组件通信的方式？</span><br><span class="line">    ①props down</span><br><span class="line">        步骤1：发送</span><br><span class="line">            &lt;son myName=&quot;zhangsan&quot;&gt;&lt;/son&gt;</span><br><span class="line">        步骤2：接收</span><br><span class="line">            Vue.component(&#x27;son&#x27;,&#123;</span><br><span class="line">                props:[&#x27;myName&#x27;]</span><br><span class="line">            &#125;)</span><br><span class="line">    ②events up（子-》父）</span><br><span class="line">        步骤1: 事件的绑定</span><br><span class="line">            methods:&#123;</span><br><span class="line">                rcvMsg:function(msg)&#123;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">            &lt;son @customEvent=&quot;rcvMsg&quot;&gt;&lt;/son&gt;</span><br><span class="line">        步骤2：事件的触发（儿子）</span><br><span class="line">            this.$emit(&#x27;customEvent&#x27;,123);</span><br><span class="line">    ③$refs $parent</span><br><span class="line">    ④bus</span><br><span class="line">Angular中组件通信？</span><br><span class="line">    1、props down</span><br><span class="line">        步骤1：发送</span><br><span class="line">        &lt;son uName=&quot;zhangsan&quot;&gt;&lt;/son&gt;</span><br><span class="line">        步骤2：接收</span><br><span class="line">            import &#123;Input&#125; from &#x27;@angular/core&#x27;</span><br><span class="line">            @Input() uName=&quot;&quot;;</span><br><span class="line">            this.uName</span><br><span class="line">    2、events up</span><br><span class="line">        步骤1：事件和处理函数的绑定</span><br><span class="line">            定义一个方法</span><br><span class="line">                rcvMsg(msg)&#123;&#125;</span><br><span class="line">            &lt;son (toFatherEvent)=&quot;rcvMsg($event)&quot;&gt;</span><br><span class="line">            &lt;/son&gt;</span><br><span class="line">        步骤2：触发事件</span><br><span class="line">            子组件触发</span><br><span class="line">                import &#123;Output,EventEmitter&#125; from &#x27;@angular/core&#x27;</span><br><span class="line"></span><br><span class="line">                @Output() toFatherEvent = new EventEmitter();</span><br><span class="line"></span><br><span class="line">                this.toFatherEvent.emit(&#x27;123&#x27;);</span><br></pre></td></tr></table></figure>

<p>我们是这样写 Angular 应用的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">用 Angular 扩展语法编写 HTML 模板，</span><br><span class="line">用组件类管理这些模板，</span><br><span class="line">用服务添加应用逻辑，</span><br><span class="line">用模块打包发布组件与服务。</span><br></pre></td></tr></table></figure>

<h2 id="七、管道（pipe）"><a href="#七、管道（pipe）" class="headerlink" title="七、管道（pipe）"></a>七、管道（pipe）</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">管道是用来对数据进行筛选、过滤、格式化</span><br><span class="line"></span><br><span class="line">Vue中过滤器：</span><br><span class="line">    &lt;any&gt;&#123;&#123;expression | filter(1,2) | filter2 &#125;&#125;&lt;/any&gt;</span><br><span class="line"></span><br><span class="line">    Vue.filter(&#x27;changeSex&#x27;,function(arg,arg1,arg2)&#123;</span><br><span class="line">        return 处理后的结果</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">angular中管道：</span><br><span class="line"></span><br><span class="line">过滤器的本质就是一个有参数有返回值的方法</span><br><span class="line"></span><br><span class="line">    语法:</span><br><span class="line">            &lt;any&gt;</span><br><span class="line">            &#123;&#123;expression | pipe1:&#x27;12&#x27;:34 | pipe2&#125;&#125;</span><br><span class="line">            &lt;/any&gt;</span><br><span class="line"></span><br><span class="line">    1、内置管道</span><br><span class="line"></span><br><span class="line">        常见内置管道：</span><br><span class="line">            uppercase/lowercase/date/number/slice</span><br><span class="line"></span><br><span class="line">    2、自定义管道</span><br><span class="line">        创建一个自定义管道：</span><br><span class="line">            import &#123;Pipe,PipeTransform&#125; from &#x27;@angular/core&#x27;</span><br><span class="line"></span><br><span class="line">            @Pipe(&#123;</span><br><span class="line">                name:&#x27;testNG&#x27;</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">            export class TestPipe implements PipeTransform &#123;</span><br><span class="line">                    //value是竖杠前表达式执行的结果</span><br><span class="line">                    //args通过调用管道时，冒号后边跟的参数</span><br><span class="line">                 transfrom(value:any,...args:[]):any&#123;</span><br><span class="line">                    return ‘处理后的结果’</span><br><span class="line">                 &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        调用：</span><br><span class="line">            ①声明</span><br><span class="line">                到模块中先引入再声明</span><br><span class="line">            ②调用</span><br><span class="line">                和内置管道的用法是一样的,同样支持传参、多重过滤</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="八、服务-依赖注入"><a href="#八、服务-依赖注入" class="headerlink" title="八、服务 (依赖注入)"></a>八、服务 (依赖注入)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">服务 service:服务的本质是一个类，在服务类中封装的是经常用到的数据和方法。</span><br><span class="line"></span><br><span class="line">常见的服务：日志类服务、心跳服务、网络请求服务。。。</span><br><span class="line"></span><br><span class="line">1、服务的创建和使用</span><br><span class="line">    创建：</span><br><span class="line">        import &#123;Injectable&#125; from &#x27;@angular/core&#x27;</span><br><span class="line"></span><br><span class="line">        @Injectable()</span><br><span class="line">        export class UserService &#123;</span><br><span class="line">            constructor()&#123;&#125;</span><br><span class="line"></span><br><span class="line">            checkUserLogin()&#123;return true&#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    使用：</span><br><span class="line">        ①需要给服务指定provider</span><br><span class="line">            在组件中或者模块中指定providers:[UserService]</span><br><span class="line">        ②调用</span><br><span class="line">            import &#123;UserService&#125; from &#x27;./***&#x27;</span><br><span class="line"></span><br><span class="line">            constructor(private myService:UserService)&#123;&#125;</span><br><span class="line"></span><br><span class="line">            this.myService.checkUserLogin()</span><br><span class="line"></span><br><span class="line">2、如何封装一个网络请求的服务</span><br><span class="line"></span><br><span class="line">    ①创建服务的文件</span><br><span class="line">    ②在服务中封装一个方法</span><br><span class="line">        sendRequest(myUrl:string)&#123;</span><br><span class="line">            return  this.http.get(myUrl).map((response)=&gt;</span><br><span class="line">                response.json()</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    ③调用之前 首先指定providers</span><br><span class="line">    ④到组件中，先引入，再实例化，再调用</span><br><span class="line">        this.myHS.sendRequest().subscribe((result)=&gt;&#123;</span><br><span class="line">            //result就是服务器端返回的结果！</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    与服务器端通信如果涉及的session，angular需要这么处理：</span><br><span class="line">        客户端</span><br><span class="line">            ①发起请求 withCredentials:true</span><br><span class="line">                this.http.get(</span><br><span class="line">        myUrl,</span><br><span class="line">        &#123;withCredentials:true&#125;</span><br><span class="line">        )</span><br><span class="line">        服务器端：</span><br><span class="line">            ①跨域header(&#x27;Access-Control-Allow-Origin:http://localhost:3000&#x27;);</span><br><span class="line">            ②服务器允许接收凭证</span><br><span class="line">            header(&#x27;Access-Control-Allow-Credentials:true&#x27;);</span><br><span class="line"></span><br><span class="line">服务创建和使用：</span><br><span class="line">    1、创建一个文件 test.service.ts</span><br><span class="line">    2、在文件中编写代码，装饰一个服务</span><br><span class="line">        @Injectable()</span><br><span class="line">        export class TestService&#123;</span><br><span class="line">            showAlert(msg)&#123;</span><br><span class="line">                alert(msg);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    3、    给模块或者组件,在providers属性对应的数组中 [TestService]</span><br><span class="line"></span><br><span class="line">    4、组件中要想使用服务中的方法</span><br><span class="line">        import &#123;TestService&#125; from &#x27;***&#x27;</span><br><span class="line"></span><br><span class="line">        constructor(private myService:TestService)&#123;&#125;</span><br><span class="line"></span><br><span class="line">        this.myService.showAlert()</span><br></pre></td></tr></table></figure>

<p><strong>Angular 中开发模式：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">我们是这样写 Angular 应用的：</span><br><span class="line">用 Angular 扩展语法编写 HTML 模板，</span><br><span class="line">用组件类管理这些模板，</span><br><span class="line">用服务添加应用逻辑，</span><br><span class="line">用模块打包发布组件与服务。</span><br><span class="line"></span><br><span class="line">然后，我们通过引导根模块来启动该应用。</span><br><span class="line">Angular 在浏览器中接管、展现应用的内容，并根据我们提供的操作指令响应用户的交互。</span><br></pre></td></tr></table></figure>

<p><strong>在 Angular 开发时，八大组成部分：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1、模块</span><br><span class="line">2、组件</span><br><span class="line">3、模板 自带的html标签+指令、绑定相关的ng的语法</span><br><span class="line">4、元数据 告诉 Angular 如何处理一个类。</span><br><span class="line">5、数据绑定</span><br><span class="line">    &#123;&#123;&#125;&#125; () [] [(ngModel)]</span><br><span class="line">6、指令</span><br><span class="line">        三大类：组件、结构型、属性型</span><br><span class="line">7、服务</span><br><span class="line">    封装一些数据和方法</span><br><span class="line">8、依赖注入</span><br><span class="line">    就是将依赖的服务、模块注入到指定组件、模块中使用，提供了一种新的实例化的方式（解耦）</span><br></pre></td></tr></table></figure>

<h2 id="九、路由模块"><a href="#九、路由模块" class="headerlink" title="九、路由模块"></a>九、路由模块</h2><p>路由模块：建立起 url 和页面之间的映射关系</p>
<h3 id="1、实现-SPA-的基本步骤"><a href="#1、实现-SPA-的基本步骤" class="headerlink" title="1、实现 SPA 的基本步骤"></a>1、实现 SPA 的基本步骤</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">Vue：</span><br><span class="line">实现一个SPA基本思路：</span><br><span class="line">①指定一个容器</span><br><span class="line">    &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">②创建代码片段</span><br><span class="line">    创建组件</span><br><span class="line">    var Login = Vue.component(&#x27;login-component&#x27;,&#123;</span><br><span class="line">        template:`&lt;h1&gt;登录页面&lt;/h1&gt;`</span><br><span class="line">    &#125;)</span><br><span class="line">③配置路由词典</span><br><span class="line">    new Vue(&#123;</span><br><span class="line">        router:new VueRouter(&#123;</span><br><span class="line">            routes:[</span><br><span class="line">                &#123;path:&#x27;/myLogin&#x27;,component:Login&#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">④测试</span><br><span class="line">    测试路由词典中 路由地址能否按照需求 正确加载所需要用到的页面</span><br><span class="line"></span><br><span class="line">Angular：</span><br><span class="line">①指定容器</span><br><span class="line">    &lt;router-outlet&gt;&lt;/router-outlet&gt;</span><br><span class="line">②创建组件 （声明）</span><br><span class="line">    @Component(&#123;&#125;) export class **</span><br><span class="line">③配置路由词典</span><br><span class="line">    //a-module-routing</span><br><span class="line">    import &#123;Routes,RouterModule&#125; from &#x27;@angular/router&#x27;</span><br><span class="line">    import &#123;LoginComponent&#125; from &#x27;./demo15_spa/login.component&#x27;</span><br><span class="line"></span><br><span class="line">    const routes:Routes = [</span><br><span class="line">        &#123;path:&#x27;&#x27;,component:LoginComponent&#125;</span><br><span class="line">        .....</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    @NgModule(&#123;</span><br><span class="line">        import:[RouterModule.forRoot(routes)],</span><br><span class="line">        exports:[RouterModule]</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    export class AppRoutingModule&#123;&#125;</span><br><span class="line"></span><br><span class="line">    找到根模块：</span><br><span class="line">        import &#123;AppRoutingModule&#125; from &#x27;./app.router&#x27;</span><br><span class="line"></span><br><span class="line">        @NgModule(&#123;</span><br><span class="line">            imports:[AppRoutingModule]</span><br><span class="line">        &#125;)</span><br><span class="line">④测试</span><br></pre></td></tr></table></figure>

<h3 id="2、在-Angular-实现组件间的导航的方式"><a href="#2、在-Angular-实现组件间的导航的方式" class="headerlink" title="2、在 Angular 实现组件间的导航的方式"></a>2、在 Angular 实现组件间的导航的方式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Vue写法：</span><br><span class="line">        ①可以直接修改地址栏（内部测试）</span><br><span class="line">        ②可以通过js</span><br><span class="line">         this.$router.push(&#x27;目的地的路由地址&#x27;)</span><br><span class="line">        ③routerLink</span><br><span class="line">         &lt;router-link to=&quot;目的地的路由地址&quot;&gt;&lt;/router-link&gt;</span><br><span class="line">Angular：</span><br><span class="line">①直接修改地址栏</span><br><span class="line">②js</span><br><span class="line">    import &#123;Router&#125; from &#x27;@angular/router&#x27;</span><br><span class="line">    constructor(private myRouter:Router)&#123;&#125;</span><br><span class="line">    this.myRouter.navigateByUrl(&#x27;url&#x27;);</span><br><span class="line">③ &lt;a routerLink=&quot;地址&quot;&gt;&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">补充：实现前进和后退</span><br><span class="line">    import &#123;Location&#125; from &#x27;@angular/common&#x27;</span><br><span class="line"></span><br><span class="line">    constructor(private myLocation:Location)&#123;&#125;</span><br><span class="line"></span><br><span class="line">    this.myLocation.back();                this.myLocation.forward();</span><br></pre></td></tr></table></figure>

<h3 id="3、参数的传递"><a href="#3、参数的传递" class="headerlink" title="3、参数的传递"></a>3、参数的传递</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Angular:</span><br><span class="line">    3.1 发送</span><br><span class="line">        this.myRouter.navigateByUrl(&#x27;myOC/123&#x27;);</span><br><span class="line"></span><br><span class="line">    3.2 接收</span><br><span class="line">        ① 配置接收方的路由地址</span><br><span class="line">            &#123;path:&#x27;myOC&#x27;&#125; ==&gt; &#123;path:&#x27;myOC/:price&#x27;&#125;</span><br><span class="line">        ② 接收参数</span><br><span class="line">                import &#123;ActivatedRoute&#125; from &#x27;@angular/router&#x27;</span><br><span class="line"></span><br><span class="line">                constructor(private myAR:ActivatedRoute)&#123;&#125;</span><br><span class="line"></span><br><span class="line">                this.myAR.params.subscribe((result)=&gt;&#123;</span><br><span class="line">                    //result.price</span><br><span class="line">                &#125;)</span><br><span class="line"></span><br><span class="line">    在Angular中 实现数据传输的方式：</span><br><span class="line">        ①组件间通信</span><br><span class="line">        ②跳转时指定参数</span><br><span class="line">        ③与远程服务器端通信</span><br></pre></td></tr></table></figure>

<h3 id="4、路由嵌套"><a href="#4、路由嵌套" class="headerlink" title="4、路由嵌套"></a>4、路由嵌套</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">可以在SPA中某个组件中，根据url嵌套其它的组件</span><br><span class="line">    Vue中实现方式：</span><br><span class="line">        ①在准备嵌套其它组件的，指定一个容器 &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">        ②配置路由词典</span><br><span class="line">            &#123;</span><br><span class="line">                path:&#x27;&#x27;,</span><br><span class="line">                component:MailComponent,</span><br><span class="line">                children:[</span><br><span class="line">                    &#123;path:&#x27;inbox&#x27;,component:***&#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">    Angular中实现方式：</span><br><span class="line">        ①指定容器</span><br><span class="line">            router-outlet</span><br><span class="line">        ②配置子路由</span><br><span class="line">            &#123;</span><br><span class="line">                path:&#x27;mail&#x27;,</span><br><span class="line">                children:[</span><br><span class="line">                    ...</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        总结：在Angular中实现一个支持路由嵌套的SPA，</span><br><span class="line">        导航到对应的子路由对应的页面时，必须在携带父组件的地址</span><br><span class="line">            localhost:3000/mail/outbox</span><br><span class="line">            localhost:3000/mail/inbox</span><br><span class="line"></span><br><span class="line">        demo18_embed</span><br><span class="line">            mylogin.component.ts  MyLoginComponent</span><br><span class="line">            mail.component.ts MailComponent</span><br><span class="line">            inbox.component.ts InboxComponent</span><br><span class="line">            outbox.component.ts OutboxComponent</span><br><span class="line">        ①完成组件的创建和声明</span><br><span class="line"></span><br><span class="line">        ②路由模块</span><br></pre></td></tr></table></figure>

<h3 id="5、路由守卫"><a href="#5、路由守卫" class="headerlink" title="5、路由守卫"></a>5、路由守卫</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">路由守卫 RouteGuard，控制是否能够访问某一个url中所对应的组件！</span><br><span class="line">    鉴权的组件</span><br><span class="line">    用户登录的页面</span><br><span class="line">    。。。</span><br><span class="line"></span><br><span class="line">如何使用路由守卫：</span><br><span class="line">    ①创建一个服务</span><br><span class="line">        import &#123;Injectable&#125; from &#x27;@angular/core&#x27;</span><br><span class="line">        import &#123;CanActivate&#125; from &#x27;@angular/router&#x27;</span><br><span class="line"></span><br><span class="line">        @Injectable()</span><br><span class="line">        export class MailGuard implments CanActivate&#123;</span><br><span class="line"></span><br><span class="line">            canActivate()&#123;</span><br><span class="line">                return true/false</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ②给服务指定提供商</span><br><span class="line">         providers:[MailGuard]</span><br><span class="line">    ③给路由词典中想要保护的路由指定canActivate</span><br><span class="line">            &#123;</span><br><span class="line">                path:&#x27;mail&#x27;,</span><br><span class="line">                canActivate:[MailGuard]</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">    Vue中如果也想实现路由守卫：</span><br><span class="line">        const router = new VueRouter(&#123; ... &#125;)</span><br><span class="line"></span><br><span class="line">        router.beforeEach((to, from, next) =&gt; &#123;</span><br><span class="line">            // ...</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        https://router.vuejs.org/zh-cn/advanced/navigation-guards.html</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/16/React%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86Redux%E3%80%81Redux-Thunk%E3%80%81Redux-Sagas%E3%80%81React-Redux%E5%B0%8F%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/portal.jpg">
      <meta itemprop="name" content="Bruce Chen">
      <meta itemprop="description" content="It's better to burn out than to fade away.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Chen's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/16/React%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86Redux%E3%80%81Redux-Thunk%E3%80%81Redux-Sagas%E3%80%81React-Redux%E5%B0%8F%E7%BB%93/" class="post-title-link" itemprop="url">React状态管理Redux、Redux-Thunk、Redux-Sagas、React-Redux小结</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-12-16 14:17:28 / 修改时间：14:22:35" itemprop="dateCreated datePublished" datetime="2022-12-16T14:17:28+08:00">2022-12-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E6%80%BB%E7%BB%93/" itemprop="url" rel="index"><span itemprop="name">前端框架总结</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、React-环境配置"><a href="#一、React-环境配置" class="headerlink" title="一、React 环境配置"></a>一、React 环境配置</h1><p><strong>安装脚手架工具</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g create-react-app</span><br></pre></td></tr></table></figure>

<p><strong>创建项目工程</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// demo是项目名称，不能有大写字母</span><br><span class="line">$ create-react-app demo</span><br></pre></td></tr></table></figure>

<p><strong>安装浏览器调试工具</strong></p>
<ul>
<li>在 FireFox 中安装 React Developer Tools 和 Redux DevTools</li>
<li>React Developer Tools 能够在工具栏中很方便的看到页面的布局</li>
<li>Redux DevTools 能够追踪页面 state、action 等的变化</li>
</ul>
<h1 id="二、Redux"><a href="#二、Redux" class="headerlink" title="二、Redux"></a>二、Redux</h1><h2 id="Redux-作用"><a href="#Redux-作用" class="headerlink" title="Redux 作用"></a>Redux 作用</h2><p>当项目越来越复杂时，组件越来越多的时候，组件之间数据的共享就成为了一个问题，那么 Redux 就是用来解决各个组件之间数据共享的问题的。</p>
<h2 id="在项目中安装-Redux"><a href="#在项目中安装-Redux" class="headerlink" title="在项目中安装 Redux"></a>在项目中安装 Redux</h2><p>redux 的 GitHub 地址：<a target="_blank" rel="noopener" href="https://github.com/reduxjs/redux">https://github.com/reduxjs/redux</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 两种安装方法</span><br><span class="line">$ npm install --save redux</span><br><span class="line">$ yarn add redux</span><br></pre></td></tr></table></figure>

<h2 id="理解-Redux-工作流程"><a href="#理解-Redux-工作流程" class="headerlink" title="理解 Redux 工作流程"></a>理解 Redux 工作流程</h2><p><img src="https://img-blog.csdnimg.cn/20190725211305715.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzU1MzY5NA==,size_16,color_FFFFFF,t_70" alt="image"></p>
<ol>
<li>Store 就是项目中的数据仓库，但是数据是交给 Reducer 管理的</li>
<li>Store 向组件提供数据，组件订阅数据后，会根据状态的变化自动更新数据</li>
<li>组件要修改 Store 中的数据，需要创建一个 action 利用 dispatch 函数通知 Store</li>
<li>Store 把 action 和数据交给 Reducer，Reducer 根据 action 的类型来处理数据</li>
<li>Reducer 把处理好的数据返回给 Store</li>
</ol>
<h2 id="从-Store-中读取数据：派发-action-改变-Store-中的数据"><a href="#从-Store-中读取数据：派发-action-改变-Store-中的数据" class="headerlink" title="从 Store 中读取数据：派发 action 改变 Store 中的数据"></a>从 Store 中读取数据：派发 action 改变 Store 中的数据</h2><p>action 是一个字符串，在 App 组件、reducer 文件中都使用了，容易引起难以调试的 Bug，也不利于后期维护。<br>所以使用一个 actionType 和 actionCreator 来管理 action 的类型和 action 的创建。<br>代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">// App组件</span><br><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;;</span><br><span class="line">import store from &#x27;./store&#x27;;</span><br><span class="line">import &#123; changeInputValue &#125; from &#x27;./store/actionCreators&#x27;;</span><br><span class="line"></span><br><span class="line">class App extends Component &#123;</span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">        super(props);</span><br><span class="line">        this.state = store.getState();</span><br><span class="line">        this.handleChangeInput = this.handleChangeInput.bind(this);</span><br><span class="line">        this.handleStoreChange = this.handleStoreChange.bind(this);</span><br><span class="line">        store.subscribe(this.handleStoreChange);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;input</span><br><span class="line">                    placeholder=&quot;请输入信息&quot;</span><br><span class="line">                    style=&#123;&#123;width: &quot;200px&quot;, height: &#x27;40px&#x27;, border: &#x27;1px solid red&#x27;&#125;&#125;</span><br><span class="line">                    value=&#123;this.state.inputValue&#125;</span><br><span class="line">                    onChange=&#123;this.handleChangeInput&#125;</span><br><span class="line">                /&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleChangeInput (e) &#123;</span><br><span class="line">        store.dispatch(changeInputValue(e.target.value));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleStoreChange () &#123;</span><br><span class="line">        this.setState(store.getState());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br><span class="line">------------------------------</span><br><span class="line"></span><br><span class="line">// actionTypes.js 管理action类型</span><br><span class="line">export const CHANGE_INPUT_VALUE = &#x27;change_input_value&#x27;;</span><br><span class="line"></span><br><span class="line">------------------------------</span><br><span class="line"></span><br><span class="line">// actionCreators.js 管理action的创建</span><br><span class="line"></span><br><span class="line">import &#123; CHANGE_INPUT_VALUE &#125; from &#x27;./actionTypes&#x27;;</span><br><span class="line"></span><br><span class="line">export const changeInputValue = (value) =&gt; (&#123;</span><br><span class="line">    type: CHANGE_INPUT_VALUE,</span><br><span class="line">    value: value</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">------------------------------</span><br><span class="line"></span><br><span class="line">// reducer.js</span><br><span class="line"></span><br><span class="line">import &#123; CHANGE_INPUT_VALUE &#125; from &#x27;./actionTypes&#x27;;</span><br><span class="line"></span><br><span class="line">const defaultState = &#123;</span><br><span class="line">    inputValue: &#x27;zhangsan&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default (state = defaultState, action) =&gt; &#123;</span><br><span class="line">    if (action.type === CHANGE_INPUT_VALUE) &#123;</span><br><span class="line">        const newState = JSON.parse(JSON.stringify(state));</span><br><span class="line">        newState.inputValue = action.value;</span><br><span class="line">        return newState;</span><br><span class="line">    &#125;</span><br><span class="line">    return state;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">------------------------------</span><br><span class="line"></span><br><span class="line">// store/index.js</span><br><span class="line"></span><br><span class="line">import &#123; createStore &#125; from &#x27;redux&#x27;;</span><br><span class="line">import reducer from &#x27;./reducer&#x27;;</span><br><span class="line"></span><br><span class="line">const store = createStore(</span><br><span class="line">    reducer,</span><br><span class="line">    window.__REDUX_DEVTOOLS_EXTENSION__ &amp;&amp; window.__REDUX_DEVTOOLS_EXTENSION__()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">export default store;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="三、Redux-Thunk"><a href="#三、Redux-Thunk" class="headerlink" title="三、Redux-Thunk"></a>三、Redux-Thunk</h1><h2 id="Redux-Thunk-的作用"><a href="#Redux-Thunk-的作用" class="headerlink" title="Redux-Thunk 的作用"></a>Redux-Thunk 的作用</h2><p>Redux-Thunk<strong>是 Redux</strong>的中间件(<strong>并不是 React 的中间件</strong>)，用来将组件异步获取数据的操作封装到 action 中去，以此来减少组件中复杂的异步操作。<br>使用 Redux-Thunk 之后 action 可以返回一个函数(Redux 的 action 默认只能返回对象)。</p>
<h2 id="安装以及配置"><a href="#安装以及配置" class="headerlink" title="安装以及配置"></a>安装以及配置</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ yarn add redux-thunk</span><br><span class="line">$ npm install --save redux-thunk</span><br></pre></td></tr></table></figure>

<h2 id="使用-Redux-Thunk-之后的数据流程"><a href="#使用-Redux-Thunk-之后的数据流程" class="headerlink" title="使用 Redux-Thunk 之后的数据流程"></a>使用 Redux-Thunk 之后的数据流程</h2><p><img src="https://img-blog.csdnimg.cn/20190725212421249.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzU1MzY5NA==,size_16,color_FFFFFF,t_70" alt="image"></p>
<p>实际上变化就在 Dispatch 中，使用 Redux-Thunk 之后 action 不仅可以返回对象，还可以返回函数，然后将异步操作代码放在 action 中了。</p>
<h2 id="代码演示"><a href="#代码演示" class="headerlink" title="代码演示"></a>代码演示</h2><p>这里采用从服务端获取数据展示一个 ul 列表</p>
<p>使用 Redux-Thunk 之后的代码以及配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">// App.js</span><br><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;;</span><br><span class="line">import store from &#x27;./store&#x27;;</span><br><span class="line">import &#123; getListDataAction &#125; from &#x27;./store/actionCreators&#x27;;</span><br><span class="line"></span><br><span class="line">class App extends Component &#123;</span><br><span class="line"></span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">        super(props);</span><br><span class="line">        this.state = store.getState();</span><br><span class="line">        this.handleStoreChange = this.handleStoreChange.bind(this);</span><br><span class="line">        store.subscribe(this.handleStoreChange);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;ul&gt;</span><br><span class="line">                    &#123;this.state.list.map((item, index) =&gt; &#123;</span><br><span class="line">                        return &lt;li key=&#123;index&#125;&gt;&#123;item&#125;&lt;/li&gt;</span><br><span class="line">                    &#125;)&#125;</span><br><span class="line">                &lt;/ul&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">        // 着重变化的代码</span><br><span class="line">        store.dispatch(getListDataAction())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleStoreChange () &#123;</span><br><span class="line">        this.setState(store.getState());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br><span class="line">-----------------------</span><br><span class="line"></span><br><span class="line">// actionCreators.js</span><br><span class="line">import &#123; GET_LIST_DATA &#125; from &#x27;./actionTypes&#x27;;</span><br><span class="line">import axios from &#x27;axios&#x27;;</span><br><span class="line"></span><br><span class="line">export const getListData = (data) =&gt; (&#123;</span><br><span class="line">    type: GET_LIST_DATA,</span><br><span class="line">    value: data</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// action 返回一个函数，异步操作在这里进行</span><br><span class="line">export const getListDataAction = () =&gt; &#123;</span><br><span class="line">    return (dispatch) =&gt; &#123;</span><br><span class="line">        axios.get(&#x27;/list.json&#x27;).then((res) =&gt; &#123;</span><br><span class="line">            if (res.data) &#123;</span><br><span class="line">                dispatch(getListData(res.data));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).catch((e) =&gt; &#123;</span><br><span class="line">            console.log(e);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-----------------------</span><br><span class="line"></span><br><span class="line">// store.js</span><br><span class="line">import &#123; createStore, applyMiddleware, compose &#125; from &#x27;redux&#x27;;</span><br><span class="line">import thunk from &#x27;redux-thunk&#x27;;</span><br><span class="line">import reducer from &#x27;./reducer&#x27;;</span><br><span class="line"></span><br><span class="line">const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__(&#123;&#125;) : compose;</span><br><span class="line"></span><br><span class="line">const enhancer = composeEnhancers(</span><br><span class="line">    applyMiddleware(thunk)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const store = createStore(</span><br><span class="line">    reducer,</span><br><span class="line">    enhancer</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">export default store;</span><br><span class="line"></span><br><span class="line">-----------------------</span><br><span class="line"></span><br><span class="line">// reducer.js无变化</span><br><span class="line">import &#123; GET_LIST_DATA &#125; from &#x27;./actionTypes&#x27;;</span><br><span class="line">const defaultState = &#123;</span><br><span class="line">    list: []</span><br><span class="line">&#125;</span><br><span class="line">export default (state = defaultState, action) =&gt; &#123;</span><br><span class="line">    if (action.type === GET_LIST_DATA) &#123;</span><br><span class="line">        const newState = JSON.parse(JSON.stringify(state));</span><br><span class="line">        newState.list = action.value;</span><br><span class="line">        console.log(action);</span><br><span class="line">        return newState;</span><br><span class="line">    &#125;</span><br><span class="line">    return state;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>结果：</p>
<p><img src="https://img-blog.csdnimg.cn/20190725213027838.png" alt="image"></p>
<h1 id="四、Redux-saga"><a href="#四、Redux-saga" class="headerlink" title="四、Redux-saga"></a>四、Redux-saga</h1><h2 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h2><p>redux-saga 同样是用来拆分组件异步代码的中间件，它和 Redux-Thunk 的区别就是将异步代码的操作放到一个单独的文件中去管理。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save redux-saga</span><br><span class="line">$ yarn add redux-saga</span><br></pre></td></tr></table></figure>

<h2 id="代码演示-1"><a href="#代码演示-1" class="headerlink" title="代码演示"></a>代码演示</h2><p>这里采用上面的例子，同样从服务器获取数据展示在 ul 列表中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">// App.js</span><br><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;;</span><br><span class="line">import store from &#x27;./store&#x27;;</span><br><span class="line">import &#123; getListDataSagas &#125; from &#x27;./store/actionCreators&#x27;;</span><br><span class="line"></span><br><span class="line">class App extends Component &#123;</span><br><span class="line"></span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">        super(props);</span><br><span class="line">        this.state = store.getState();</span><br><span class="line">        this.handleStoreChange = this.handleStoreChange.bind(this);</span><br><span class="line">        store.subscribe(this.handleStoreChange);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;ul&gt;</span><br><span class="line">                    &#123;this.state.list.map((item, index) =&gt; &#123;</span><br><span class="line">                        return &lt;li key=&#123;index&#125;&gt;&#123;item&#125;&lt;/li&gt;</span><br><span class="line">                    &#125;)&#125;</span><br><span class="line">                &lt;/ul&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">        store.dispatch(getListDataSagas());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleStoreChange () &#123;</span><br><span class="line">        this.setState(store.getState());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br><span class="line"></span><br><span class="line">------------------------</span><br><span class="line"></span><br><span class="line">// actionTypes.js</span><br><span class="line">export const GET_LIST_DATA = &#x27;get_list_data&#x27;;</span><br><span class="line">export const GET_LIST_DATA_SAGAS = &#x27;get_list_data_sagas&#x27;;</span><br><span class="line"></span><br><span class="line">------------------------</span><br><span class="line"></span><br><span class="line">// actionCreators.js</span><br><span class="line">import &#123; GET_LIST_DATA, GET_LIST_DATA_SAGAS &#125; from &#x27;./actionTypes&#x27;;</span><br><span class="line"></span><br><span class="line">export const getListData = (data) =&gt; (&#123;</span><br><span class="line">    type: GET_LIST_DATA,</span><br><span class="line">    value: data</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 这里创建了一个sagas中需要的action</span><br><span class="line">export const getListDataSagas = () =&gt; (&#123;</span><br><span class="line">    type: GET_LIST_DATA_SAGAS,</span><br><span class="line">&#125;)</span><br><span class="line">------------------------</span><br><span class="line"></span><br><span class="line">// reducer.js</span><br><span class="line">import &#123; GET_LIST_DATA &#125; from &#x27;./actionTypes&#x27;;</span><br><span class="line"></span><br><span class="line">const defaultState = &#123;</span><br><span class="line">    list: []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default (state = defaultState, action) =&gt; &#123;</span><br><span class="line">    if (action.type === GET_LIST_DATA) &#123;</span><br><span class="line">        const newState = JSON.parse(JSON.stringify(state));</span><br><span class="line">        newState.list = action.value;</span><br><span class="line">        console.log(action);</span><br><span class="line">        return newState;</span><br><span class="line">    &#125;</span><br><span class="line">    return state;</span><br><span class="line">&#125;</span><br><span class="line">------------------------</span><br><span class="line"></span><br><span class="line">// store.js</span><br><span class="line">import &#123; createStore, applyMiddleware, compose &#125; from &#x27;redux&#x27;;</span><br><span class="line">import reducer from &#x27;./reducer&#x27;;</span><br><span class="line">import createSagaMiddleware from &#x27;redux-saga&#x27;;</span><br><span class="line">// 新创建的sagas.js文件用来管理异步操作的代码</span><br><span class="line">import sagas from &#x27;./sagas&#x27;;</span><br><span class="line"></span><br><span class="line">const sagaMiddleware = createSagaMiddleware();</span><br><span class="line">const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__(&#123;&#125;) : compose;</span><br><span class="line">const enhancer = composeEnhancers(</span><br><span class="line">    applyMiddleware(sagaMiddleware)</span><br><span class="line">);</span><br><span class="line">const store = createStore(</span><br><span class="line">    reducer,</span><br><span class="line">    enhancer</span><br><span class="line">);</span><br><span class="line">sagaMiddleware.run(sagas);</span><br><span class="line">export default store;</span><br><span class="line"></span><br><span class="line">------------------------</span><br><span class="line">// sagas.js  单独管理异步操作的文件</span><br><span class="line">import &#123; put, takeEvery &#125; from &#x27;redux-saga/effects&#x27;;</span><br><span class="line">import &#123; GET_LIST_DATA_SAGAS &#125; from &#x27;./actionTypes&#x27;;</span><br><span class="line">import axios from &#x27;axios&#x27;;</span><br><span class="line">import &#123; getListData &#125; from  &#x27;./actionCreators&#x27;;</span><br><span class="line"></span><br><span class="line">function* mySaga() &#123;</span><br><span class="line">    // 这句代码意思是：当接收到一个名叫GET_LIST_DATA_SAGAS的action的时候</span><br><span class="line">    //会去调用getDataFromServer方法</span><br><span class="line">    yield takeEvery(GET_LIST_DATA_SAGAS, getDataFromServer);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 获取数据的异步操作</span><br><span class="line">function* getDataFromServer() &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        const res = yield axios.get(&#x27;/list.json&#x27;);</span><br><span class="line">        yield put(getListData(res.data));</span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">        console.log(&#x27;请求错误&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">export default mySaga;</span><br></pre></td></tr></table></figure>

<h1 id="五、React-Redux"><a href="#五、React-Redux" class="headerlink" title="五、React-Redux"></a>五、React-Redux</h1><h2 id="作用-1"><a href="#作用-1" class="headerlink" title="作用"></a>作用</h2><p>React-Redux 的作用是为了在项目中使用 Redux 更加方便。</p>
<h2 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save react-redux</span><br><span class="line">$ yarn add react-redux</span><br></pre></td></tr></table></figure>

<h2 id="代码演示-2"><a href="#代码演示-2" class="headerlink" title="代码演示"></a>代码演示</h2><p>代码演示的例子是改变 input 输入框中的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">// index.js 项目的入口文件</span><br><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import ReactDOM from &#x27;react-dom&#x27;;</span><br><span class="line">import App from &#x27;./App&#x27;;</span><br><span class="line">import &#123; Provider &#125; from  &#x27;react-redux&#x27;;</span><br><span class="line">import store from  &#x27;./store&#x27;;</span><br><span class="line"></span><br><span class="line">const AppRoot = (</span><br><span class="line">    // 重点把store提供给每一个组件</span><br><span class="line">  &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">      &lt;App&gt;&lt;/App&gt;</span><br><span class="line">  &lt;/Provider&gt;</span><br><span class="line">);</span><br><span class="line">ReactDOM.render(AppRoot, document.getElementById(&#x27;root&#x27;));</span><br><span class="line"></span><br><span class="line">------------------------</span><br><span class="line">// actionTypes.js</span><br><span class="line">export const INPUT_CHANGE = &#x27;input_change&#x27;;</span><br><span class="line"></span><br><span class="line">------------------------</span><br><span class="line">// actionCreators.js</span><br><span class="line">import &#123; INPUT_CHANGE &#125; from &#x27;./actionTypes&#x27;;</span><br><span class="line"></span><br><span class="line">export const inputChange = (data) =&gt; (&#123;</span><br><span class="line">    type: INPUT_CHANGE,</span><br><span class="line">    value: data</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">------------------------</span><br><span class="line">// reducer.js</span><br><span class="line">import &#123; INPUT_CHANGE &#125; from &#x27;./actionTypes&#x27;;</span><br><span class="line">const defaultState = &#123;</span><br><span class="line">    inputValue: &#x27;&#x27;</span><br><span class="line">&#125;</span><br><span class="line">export default (state = defaultState, action) =&gt; &#123;</span><br><span class="line">    if (action.type === INPUT_CHANGE) &#123;</span><br><span class="line">        const newState = JSON.parse(JSON.stringify(state));</span><br><span class="line">        newState.inputValue = action.value;</span><br><span class="line">        return newState;</span><br><span class="line">    &#125;</span><br><span class="line">    return state;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">------------------------</span><br><span class="line">// App.js</span><br><span class="line">import React, &#123; Component &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123; inputChange &#125; from &#x27;./store/actionCreators&#x27;;</span><br><span class="line">import &#123; connect &#125; from &#x27;react-redux&#x27;;</span><br><span class="line"></span><br><span class="line">class App extends Component &#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;input</span><br><span class="line">                    placeholder=&quot;请输入信息&quot;</span><br><span class="line">                    style=&#123;&#123;width: &quot;200px&quot;, height: &#x27;40px&#x27;, border: &#x27;1px solid red&#x27;&#125;&#125;</span><br><span class="line">                    value=&#123;this.props.inputValue&#125;</span><br><span class="line">                    onChange=&#123;this.props.handleChangeInput&#125;</span><br><span class="line">                /&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 将store中存储的数据映射到当前组件的props中</span><br><span class="line">const mapStateToProps = (state) =&gt; &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        inputValue: state.inputValue</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const mapDispatchToProps = (dispatch) =&gt; &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        handleChangeInput (e) &#123;</span><br><span class="line">            dispatch(inputChange(e.target.value));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// 利用connect将组件和store连接(连接规则mapStateToProps、mapDispatchToProps)</span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(App);</span><br></pre></td></tr></table></figure>

<h2 id="react-推崇的是组件化开发"><a href="#react-推崇的是组件化开发" class="headerlink" title="react 推崇的是组件化开发"></a>react 推崇的是组件化开发</h2><p>下面就是一个有两个组件的 demo 演示基本骨架的搭建。</p>
<p><img src="https://img-blog.csdnimg.cn/20190725213849116.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzU1MzY5NA==,size_16,color_FFFFFF,t_70" alt="image"></p>
<h1 id="六、总结"><a href="#六、总结" class="headerlink" title="六、总结"></a>六、总结</h1><ul>
<li>Redux: 就是用来管理项目中状态或者数据的</li>
<li>Redux-Thunk: Redux 的中间件，用来将异步操作的代码拆分到 action 中去的</li>
<li>Redux-Sagas: Redux 的中间件，用来将异步操作的代码拆分到单独的文件中管理</li>
<li>React-Redux: 更能方便的管理和使用 Redux</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/16/React16%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/portal.jpg">
      <meta itemprop="name" content="Bruce Chen">
      <meta itemprop="description" content="It's better to burn out than to fade away.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bruce Chen's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/16/React16%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7/" class="post-title-link" itemprop="url">React16的新特性</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-12-16 14:17:19 / 修改时间：14:22:18" itemprop="dateCreated datePublished" datetime="2022-12-16T14:17:19+08:00">2022-12-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E6%80%BB%E7%BB%93/" itemprop="url" rel="index"><span itemprop="name">前端框架总结</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、新的组件生命周期钩子"><a href="#一、新的组件生命周期钩子" class="headerlink" title="一、新的组件生命周期钩子"></a>一、新的组件生命周期钩子</h1><p><img src="https://upload-images.jianshu.io/upload_images/12185313-85b3010f0b8b7d16.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="image"></p>
<p>React 的生命周期钩子允许开发者在组件实例化、完成渲染、属性、更新、销毁等不同阶段操作组件。这给我们的开发带来更多的灵活性；</p>
<p>但是，如果开发者对各个生命周期的理解错误，很容易造成对它的滥用，就会造成性能上的浪费等问题。</p>
<p>比如：componentWillMount 对组件进行 setState、dom 操作、添加事件监听、获取数据等。这些都是不安全的操作。</p>
<p>react16 对组件的生命周期做了优化，”移除”容易被大家误解的钩子，添加更加容易理解、安全的钩子。</p>
<p>“删除”了以下钩子（17 版本中将真的删除）：</p>
<p><code>componentWillMount()</code></p>
<p><code>componentWillReceiveProps(nextProps, nextState)</code></p>
<p><code>componentWillUpdate()</code></p>
<p>新增了以下钩子：</p>
<p><code>static getDerivedStateFromProps(nextProps, prevState)</code></p>
<p><code>getSnapshotBeforeUpdate(prevProps, prevState)</code></p>
<p><code>componentDidCatch(error, info)</code></p>
<h2 id="a-如何理解-static-getDerivedStateFromProps-nextProps-prevState-？"><a href="#a-如何理解-static-getDerivedStateFromProps-nextProps-prevState-？" class="headerlink" title="a. 如何理解 static getDerivedStateFromProps(nextProps, prevState)？"></a>a. 如何理解 static getDerivedStateFromProps(nextProps, prevState)？</h2><blockquote>
<p>首先，需要对静态方法做一个理解。static 静态方法，在 es5 中怎么实现呢？<br>function Person() {}<br>Person.getCount &#x3D; function () {}<br>以上就是 static 静态方法的原理。由于“this”只能获取属性是根据原型链，而静态方法不在原型链上，所以，在组件实例内无法通过 this 调用 static 方法，static 方法也无法根据”this”调用实例的其他方法。<br>就防止在 getDerivedStateFromProps 对组件实例的错误操作。<br>再次，getDerivedStateFromProps 用来做什么用呢？<br>当组件实例化、接收到新的 props 时，会调用该方法。方法返回一个对象，这个对象会被更新到组件的 state 上。如果返回空，那么不对 state 做更新。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// 以下代码实现，更新name属性到state上；</span><br><span class="line">static getDerivedStateFromProps (nextProps, prevState) &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        name: nextProps.name</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 上面的代码在以前版本中</span><br><span class="line">// 你可能会用以下这样做，虽然这样做看起来也没问题，用上面的方法更加安全，不会对this做误操作</span><br><span class="line">componentWillReceiveProps (nextProps) &#123;</span><br><span class="line">    if (this.state.name !== nextProps.name) &#123;</span><br><span class="line">        this.setState(&#123;</span><br><span class="line">            name: nextProps.name</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>这个生命周期函数是为了替代 componentWillReceiveProps 存在的，所以在你需要使用 componentWillReceiveProps 的时候，就可以考虑使用 getDerivedStateFromProps 来进行替代了。</p>
<p>两者的参数是不相同的，而 getDerivedStateFromProps 是一个静态函数，也就是这个函数不能通过 this 访问到 class 的属性，也并不推荐直接访问属性。而是应该通过参数提供的 nextProps 以及 prevState 来进行判断，根据新传入的 props 来映射到 state。</p>
<p>需要注意的是，如果 props 传入的内容不需要影响到你的 state，那么就需要返回一个 null，这个返回值是必须的，所以尽量将其写到函数的末尾。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">static getDerivedStateFromProps(nextProps, prevState) &#123;</span><br><span class="line">    const &#123;type&#125; = nextProps;</span><br><span class="line">    // 当传入的type发生变化的时候，更新state</span><br><span class="line">    if (type !== prevState.type) &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            type,</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    // 否则，对于state不进行任何操作</span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="b-如何理解-getSnapshotBeforeUpdate-prevProps-prevState-？"><a href="#b-如何理解-getSnapshotBeforeUpdate-prevProps-prevState-？" class="headerlink" title="b. 如何理解 getSnapshotBeforeUpdate(prevProps, prevState)？"></a>b. 如何理解 getSnapshotBeforeUpdate(prevProps, prevState)？</h2><blockquote>
<p>首先，从字面来理解“snapshot”是快照的意思。在 dom 更新之前调用。返回的值将被传给 componentDidUpdate(prevProps, prevState, snaphot)。<br>这个会比较少用到，但对于处理比如数据更新后的滚动条的差异滚动，对用户体验，很有帮助。</p>
</blockquote>
<h2 id="c-如何理解-componentDidCatch-error-info-？"><a href="#c-如何理解-componentDidCatch-error-info-？" class="headerlink" title="c. 如何理解 componentDidCatch(error, info)？"></a>c. 如何理解 componentDidCatch(error, info)？</h2><blockquote>
<p>以往，当组件发生错误（可以用 throw new Error 模拟）时，会导致整个 react 程序死掉，这对于程序的稳定性来说非常不好。<br>componentDidCatch 可以捕获子组件中任何一个错误，捕获到错误后可以对错误进行处理。<br>如果发生错误的组件的父组件没有设置 componentDidCatch 错误捕获，将继续递归父组件的父组件中的 componentDidCatch，找到则停止。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 简单的错误捕获</span><br><span class="line">componentDidCatch (error, info) &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">        error: true</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">render () &#123;</span><br><span class="line">    if (this.state.error) &#123;</span><br><span class="line">        return &lt;div&gt;子组件发生异常了&lt;/div&gt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 其他代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="二、优化了哪些语法"><a href="#二、优化了哪些语法" class="headerlink" title="二、优化了哪些语法"></a>二、优化了哪些语法</h1><h2 id="1-ref-优化"><a href="#1-ref-优化" class="headerlink" title="1. ref 优化"></a>1. ref 优化</h2><p>ref 有很多作用，通过 ref 父组件可以调用子组件内的方法，配合<code>ReactDOM.findDOMNode(ref)</code> 可以获取到组件对应的 dom。ref 与 key 一样无法通过 this.props.ref 获取；</p>
<p>以前版本的 react，给子组件添加 ref&#x3D;“inputName”，就可以通过 this.refs[‘inputName’]获取子组件实例。然后可以进行一些操作。</p>
<p>React16 中有两种创建 Ref 的方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">constructor () &#123;</span><br><span class="line">    this.inputNameRef = React.createRef();</span><br><span class="line">    this.switchRef = React.createRef();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">render () &#123;</span><br><span class="line">    // 通过this.inputNameRef.current 可以获取到input实例</span><br><span class="line">    return (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">             &lt;input ref=&#123;this.inputNameRef&#125; /&gt;</span><br><span class="line">             &lt;Switch ref=&#123;this.switchRef&#125; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">render () &#123;</span><br><span class="line">    // 通过回调ref的方式实现</span><br><span class="line">    // 通过this.inputNameRef 可以获取到input实例</span><br><span class="line">    // this.switchRef可以获取Switch的实例</span><br><span class="line">    return (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">             &lt;input ref=&#123;(ref) =&gt; this.inputNameRef = ref&#125; /&gt;</span><br><span class="line">             &lt;Switch ref=&#123;(ref) =&gt; this.switchRef = ref&#125; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么，既然 ref 和 key 可以一样不能用 this.props 获取，有没有办法传给子组件呢？这样就可以实现在组件中调用子子组件（比如子组件中的 input）了。</p>
<p>答案是肯定的。</p>
<p>也有两种方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">render () &#123;</span><br><span class="line">    // 假设this.switchRef已经在constructor里创建了，那么可以通过其他属性传递。</span><br><span class="line">    // 在子组件中可以通过this.props.forRef。</span><br><span class="line">    // 注：forRef 为随便名只要不是react内置的名称就行</span><br><span class="line">    return (</span><br><span class="line">        &lt;Switch forRef=&#123;this.switchRef&#125; /&gt;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 通过React.forwardRef 传递</span><br><span class="line">export default React.forwardRef((props, ref) =&gt; &#123;</span><br><span class="line">    return (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;OtherChild /&gt;</span><br><span class="line">            &lt;Switch ref=&#123;ref&#125; /&gt;</span><br><span class="line">            &lt;OtherChild2 /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="2-将组件实例化到其他-dom-下，可以优化吗？"><a href="#2-将组件实例化到其他-dom-下，可以优化吗？" class="headerlink" title="2. 将组件实例化到其他 dom 下，可以优化吗？"></a>2. 将组件实例化到其他 dom 下，可以优化吗？</h2><p>React 渲染时，默认是将节点渲染到父组件中，这样能满足我们大部分的需求，but，有这样的组件，比如 Dialog，在组件渲染时，需要能定义组件弹出的 dom 位置，如 Dialog 中的 appendToBody 为 true 时，渲染到 body 节点下。</p>
<p>以前我们的做法是，通过 ref 和 ReactDOM.findDomNode 获取 dom 在 dialog open 时通过 document.body.appendChild(dom)，将 append 到 body 下，在 componentWillUnmount 时，document.body.removeChild(dom)，移除没用的 dom。</p>
<p>这样来做就有点麻烦，需要 ref、ReactDOM 等。</p>
<p>React16 提供了一种优雅的方式 createPortal，Portals 提供了一种很好的将子节点渲染到父组件以外的 DOM 节点的方式。</p>
<p>createPortal，渲染子节点到目标节点，并返回元素。</p>
<p>我们知道 ReactDOM.render 也可以将子节点渲染到目标节点，区别是 ReactDOM.render 并没有元素，因此不作为 render 方法的 return</p>
<p>我直接贴 react 的 Demo。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">const modalRoot = document.body;</span><br><span class="line"></span><br><span class="line">class Modal extends React.Component &#123;</span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">        super(props);</span><br><span class="line">        this.el = document.createElement(&#x27;div&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">        modalRoot.appendChild(this.el);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentWillUnmount() &#123;</span><br><span class="line">        modalRoot.removeChild(this.el);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        return ReactDOM.createPortal(</span><br><span class="line">            this.props.children,</span><br><span class="line">            this.el,</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-需要传递的多层的-props，可以优化吗？"><a href="#3-需要传递的多层的-props，可以优化吗？" class="headerlink" title="3. 需要传递的多层的 props，可以优化吗？"></a>3. 需要传递的多层的 props，可以优化吗？</h2><p>在实际开发中，我们经常会碰到，一个值需要被传递到多层的子组件中，我们不得不通过 props 一层一层的传递。</p>
<p>react16 同样提供了优雅的方式。</p>
<p>React.createContext</p>
<h1 id="三、性能方面的优化"><a href="#三、性能方面的优化" class="headerlink" title="三、性能方面的优化"></a>三、性能方面的优化</h1><h2 id="1-React-Fragment"><a href="#1-React-Fragment" class="headerlink" title="1. React.Fragment"></a>1. React.Fragment</h2><p>React 渲染时，要求 JSX 元素是 tree 结构，因为 JSX 原理还是调用 <code>React.createElement(Component, attrs, [...children])</code>，这样好理解。但这样在组件开发过程中，就有所限制，比如：Table Tr 组件，需要渲染同时多个 Tr，在以前我们就需要包一层<code>&lt;div&gt;</code>，造成了浪费。</p>
<p>react16 提供了<code>Fragment</code>，可以让我们渲染一个子元素列表，并且不在 DOM 中增加额外节点。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">render () &#123;</span><br><span class="line">    return (</span><br><span class="line">        &lt;&gt;   // 也可以用 &lt;React.Fragment&gt;</span><br><span class="line">            &lt;tr&gt;&lt;td&gt;1&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;&lt;td&gt;1&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">        &lt;/&gt;   // 也可以用 &lt;/React.Fragment&gt;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-React-memo"><a href="#2-React-memo" class="headerlink" title="2. React.memo"></a>2. React.memo</h2><p>用在函数组件的性能优化上，会对函数组件实现和 PureComponent 一样的功能，对 props 和 prevProps 做一次 shallowEqual 浅比较。</p>
<p>用法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">React.memo((props) =&gt; &#123;</span><br><span class="line">   // codes</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="3-React-lazy-amp-React-Suspense"><a href="#3-React-lazy-amp-React-Suspense" class="headerlink" title="3.React.lazy &amp; React.Suspense"></a>3.React.lazy &amp; React.Suspense</h2><p>实现 React 的 Code Spliting 对 React 代码进行拆包，有效的减少一次性加载太多代码的问题。</p>
<p>用法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const IconDemo = lazy(() =&gt; import(&#x27;./icon&#x27;));</span><br><span class="line"></span><br><span class="line">&lt;Suspense fallback=&#123;&lt;div className=&quot;loading&quot;&gt;Loading...&lt;/div&gt;&#125;&gt;</span><br><span class="line">    &lt;Route path=&quot;/&quot; component=&#123;Home&#125; exact /&gt;</span><br><span class="line">    &lt;Route path=&quot;/icon&quot; component=&#123;IconDemo&#125; /&gt;</span><br><span class="line">&lt;/Suspense&gt;</span><br></pre></td></tr></table></figure>

<h1 id="四、hooks"><a href="#四、hooks" class="headerlink" title="四、hooks"></a>四、hooks</h1><p><img src="https://pic1.zhimg.com/80/v2-1a9c7f5ce089376d9371238930a0173c_720w.jpg" alt="image"></p>
<p>我们知道，React 创建组件有 3 中方式【extends React.Component &#x2F; PureComponent】、【React.createClass】，纯函数(无副作用，只接受参数，不对参数做任何处理)。</p>
<p>extends React.Component、React.createClass 创建的组件，拥有完成 react 声明周期、状态，可以开发较为复杂的组件。</p>
<p>而，纯函数组件，只能做渲染，绑定的属性都是通过 props 决定的。没有声明周期、状态的概念。如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function UserInfo (props) &#123;</span><br><span class="line">   // 这里可以写一些操作</span><br><span class="line">   return (</span><br><span class="line">       &lt;div&gt;&#123;this.props.name&#125;&lt;/div&gt;</span><br><span class="line">   )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>React v16.7.0-alpha 对函数组件做了以下扩展。</p>
<h2 id="a-针对没有-state-做的扩展"><a href="#a-针对没有-state-做的扩展" class="headerlink" title="a. 针对没有 state 做的扩展"></a>a. 针对没有 state 做的扩展</h2><p>useState，可以将 state 添加到函数组件中，允许函数组件操作 state。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import &#123;useState&#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">function UserInfo(props) &#123;</span><br><span class="line">    // useState 接收一个参数（当做初始的state)</span><br><span class="line">    // 返回一个初始state值，和修改state的方法</span><br><span class="line">    // 允许多次使用，因此传给useState的参数应该尽可能是简单的数字、字符串等。</span><br><span class="line">    let [count, setCount] = useState(0);</span><br><span class="line">    let [checked, setChecked] = useState(props.checked || false);</span><br><span class="line"></span><br><span class="line">    return (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;p onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt;Clicked &#123;count&#125; times&lt;/p&gt;</span><br><span class="line">            &lt;Switch onClick=&#123;() =&gt; setChecked(!checked)&#125;&gt;&#123; checked ?  &#x27;开&#x27; : &#x27;关&#x27; &#125;&lt;/Switch&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="b-针对没有生命周期钩子的扩展"><a href="#b-针对没有生命周期钩子的扩展" class="headerlink" title="b. 针对没有生命周期钩子的扩展"></a>b. 针对没有生命周期钩子的扩展</h2><p>useEffect，可以将 componentDidMount、componentDidUpdate、componentWillUnmount 钩子添加到函数组件中。</p>
<p>注意：区分有返回值，和没有返回值的情况</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import &#123;useState, useEffect&#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">function UserInfo(props) &#123;</span><br><span class="line">    let [count, setCount] = useState(0);</span><br><span class="line">    let [checked, setChecked] = useState(props.checked || false);</span><br><span class="line"></span><br><span class="line">    function handleStatusChange(checked) &#123;</span><br><span class="line">        setChecked(checked);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 返回值的情况</span><br><span class="line">    useEffect(() =&gt; &#123;</span><br><span class="line">        // 组件Mount是添加监听，componentDidMount</span><br><span class="line">        // subscribe原理是，callbacks.push(handleStatusChange)</span><br><span class="line">        // 当值status值变化是，对遍历callbacks数组，调用内方法</span><br><span class="line">        // callbacks.map((fn) =&gt; &#123; fn(status) &#125;);</span><br><span class="line">        ChatAPI.subscribeToFriendStatus(props.id, handleStatusChange);</span><br><span class="line"></span><br><span class="line">        // 组件销毁是移除监听(componentWillUnmount，时执行return的内方法)</span><br><span class="line">        // unsubscribe的原理是</span><br><span class="line">        // let index = callbacks.indexOf(fn);</span><br><span class="line">        // callbacks.splice(index, 1);</span><br><span class="line">        return function cleanup() &#123;</span><br><span class="line">            ChatAPI.unsubscribeFromFriendStatus(props.id, handleStatusChange);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // 没有返回值的情况</span><br><span class="line">    useEffect(() =&gt; &#123;</span><br><span class="line">        // 组件Mount是调用，componentDidMount、componentDidUpdate1</span><br><span class="line">        document.title = `Clicked $&#123;count&#125;`;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    return (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;p onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt;Clicked &#123;count&#125; times&lt;/p&gt;</span><br><span class="line">            &lt;Switch onClick=&#123;() =&gt; setChecked(!checked)&#125;&gt;&#123; checked ?  &#x27;开&#x27; : &#x27;关&#x27; &#125;&lt;/Switch&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="c-one-more-thing"><a href="#c-one-more-thing" class="headerlink" title="c. one more thing"></a>c. one more thing</h2><p>出于不至于滥用的目的，react 指定了一些 hooks 的使用规则。如命名、代码位置等。当然还很友好的除了代码检测 eslint 插件（<a href="https://link.zhihu.com/?target=https://www.npmjs.com/package/eslint-plugin-react-hooks">eslint-plugin-react-hooks</a>），可以检测开发者写的 hooks 是否合法。</p>
<p>规则如下：</p>
<ul>
<li>在函数组件的顶层使用 hooks，不要在函数组件内的 for、if、匿名函数内使用 useState、useEffect，这将会报错。</li>
<li>关于 hooks 组件的使用，你可以在 react 组件内使用，也可以在 custom Hooks 内使用。<br>什么是自定义 hook（custom Hooks）呢？就是对 hook 的一个封装，我们可以封装特定功能的 hook，比如：用户状态的 hook、在线人数的 hook，这样在其他地方也可以使用。建议以 useXxxxx 的规范命名。</li>
</ul>
<p>如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">function useSetState (initial) &#123;</span><br><span class="line">    const [state, set] = useState(initial);</span><br><span class="line">    const setState = (patch) =&gt; &#123;</span><br><span class="line">        if (patch instanceof Function) &#123;</span><br><span class="line">            set((prevState) =&gt; &#123;</span><br><span class="line">                return Object.assign(state, patch(prevState));</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            Object.assign(state, patch);</span><br><span class="line">            set(state);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    return [state, setState];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 调用</span><br><span class="line">const Demo = () =&gt; &#123;</span><br><span class="line">    const [state, setState] = useSetState(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">    return (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;div&gt;&#123; JSON.stringify(state, null, 2) &#125;&lt;/div&gt;</span><br><span class="line">            &lt;button onClick=&#123;() =&gt; setState(&#123;foo: &#x27;bar&#x27;&#125;)&#125;&gt;foo&lt;/button&gt;</span><br><span class="line">            &lt;button</span><br><span class="line">                onClick=&#123;() =&gt; &#123;</span><br><span class="line">                    setState((prevState) =&gt; (&#123;</span><br><span class="line">                        count: (prevState.count || 0) + 1,</span><br><span class="line">                    &#125;));</span><br><span class="line">                &#125;&#125;</span><br><span class="line">            &gt;</span><br><span class="line">                count</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Bruce Chen"
      src="/images/portal.jpg">
  <p class="site-author-name" itemprop="name">Bruce Chen</p>
  <div class="site-description" itemprop="description">It's better to burn out than to fade away.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">83</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1440429303&auto=1&height=66"></iframe>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/jschentt" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jschentt" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:jschentt@gmail.com" title="E-Mail → mailto:jschentt@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/BruceCh56742806" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;BruceCh56742806" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/jinsheng.chen.5439" title="Facebook → https:&#x2F;&#x2F;www.facebook.com&#x2F;jinsheng.chen.5439" rel="noopener" target="_blank"><i class="fab fa-facebook fa-fw"></i>Facebook</a>
      </span>
  </div>





      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bruce Chen</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
